
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelos autorregresivos integrados de media móvil &#8212; Análisis y Predicción de Series de Tiempo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'arima_model';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bibliografía" href="biblio.html" />
    <link rel="prev" title="Métodos de Suavización Exponencial" href="exponential_smoothing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo-uninorte.png" class="logo__image only-light" alt="Análisis y Predicción de Series de Tiempo - Home"/>
    <script>document.write(`<img src="_static/logo-uninorte.png" class="logo__image only-dark" alt="Análisis y Predicción de Series de Tiempo - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Análisis y Predicción de Series de Tiempo
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="statistical_background.html">Introducción a las Series de Tiempo</a></li>

<li class="toctree-l1"><a class="reference internal" href="exponential_smoothing.html">Métodos de Suavización Exponencial</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Modelos autorregresivos integrados de media móvil</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">Bibliografía</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Farima_model.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/arima_model.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelos autorregresivos integrados de media móvil</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis">Análisis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-lineales-para-series-de-tiempo-estacionarias">Modelos lineales para series de tiempo estacionarias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionariedad">Estacionariedad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-de-media-movil-finito-ma-q">Proceso de media movil finito <span class="math notranslate nohighlight">\(MA(q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-proceso-de-media-movil-de-primer-orden-ma-1">El Proceso de Media Móvil de Primer Orden, <span class="math notranslate nohighlight">\(MA(1)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-proceso-de-media-movil-de-segundo-orden-ma-2">El Proceso de Media Móvil de Segundo Orden, <span class="math notranslate nohighlight">\(MA(2)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-autorregresivos-de-orden-finito">Procesos autorregresivos de orden finito</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-autorregresivo-de-primer-orden-ar-1">Proceso autorregresivo de primer orden, <span class="math notranslate nohighlight">\(AR(1)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-autorregresivo-de-segundo-orden-ar-2">Proceso autorregresivo de segundo orden, <span class="math notranslate nohighlight">\(AR(2)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-autorregresivo-general-ar-p">Proceso autorregresivo general, <span class="math notranslate nohighlight">\(AR(p)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-autocorrelacion-parcial-pacf">Función de Autocorrelación Parcial, <span class="math notranslate nohighlight">\(PACF\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-mixtos-autorregresivos-media-movil">Procesos Mixtos Autorregresivos-Media Movil</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionariedad-del-proceso-arma-p-q">Estacionariedad del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invertibilidad-del-proceso-arma-p-q">Invertibilidad del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-de-autocorrelacion-acf-y-autocorrelacion-parcial-pacf-del-proceso-arma-p-q">Funciones de autocorrelación (<span class="math notranslate nohighlight">\(ACF\)</span>) y autocorrelación parcial (<span class="math notranslate nohighlight">\(PACF\)</span>) del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-no-estacionarios">Procesos No Estacionarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-de-modelos-de-series-temporales">Construcción de Modelos de Series Temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identificacion-de-modelos">Identificación de modelos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-de-parametros">Estimación de parámetros</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostico-checking">Diagnostico Checking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-con-proceso-arima">Pronóstico con proceso ARIMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion">Implementación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-media-movil">Modelos de media móvil</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creacion-de-conjuntos-de-datos-con-arima">Creación de conjuntos de datos con ARIMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arima">ARIMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intervalo-de-confianza">Intervalo de confianza</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelos-autorregresivos-integrados-de-media-movil">
<h1>Modelos autorregresivos integrados de media móvil<a class="headerlink" href="#modelos-autorregresivos-integrados-de-media-movil" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>El capítulo anterior cubrió técnicas de <em><strong>predicción basadas en suavizado exponencial</strong></em>, suponiendo que las series temporales tienen <em><strong>componentes deterministas y estocásticos</strong></em>. Sin embargo, estas técnicas <em><strong>pueden ser insuficientes cuando la suposición de ruido aleatorio completamente aleatorio no se cumple</strong></em>.</p></li>
<li><p>En tales casos, los <em><strong>modelos autorregresivos</strong></em> pueden ser útiles, ya que <em><strong>aprovechan la correlación entre observaciones pasadas para ajustarse inmediatamente</strong></em>. Estos modelos incluyen términos <em><strong>autorregresivos</strong></em> y de <em><strong>media móvil</strong></em>, y pueden ser utilizados en diferentes enfoques de predicción, como <em><strong>ARMA</strong></em> y <em><strong>ARIMA</strong></em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>La presente sección se centra en el <strong>modelo autorregresivo</strong> y cubrirá los siguientes temas:
<br/></p>
<ul>
<li><p><strong>Media móvil (MA)</strong></p></li>
<li><p><strong>Autorregresivo (AR)</strong></p></li>
<li><p><strong>Media móvil autorregresiva (ARMA)</strong></p></li>
<li><p><strong>Media móvil integrada autorregresiva (ARIMA)</strong></p></li>
</ul>
</li>
</ul>
<section id="analisis">
<h2>Análisis<a class="headerlink" href="#analisis" title="Link to this heading">#</a></h2>
</section>
<section id="modelos-lineales-para-series-de-tiempo-estacionarias">
<h2>Modelos lineales para series de tiempo estacionarias<a class="headerlink" href="#modelos-lineales-para-series-de-tiempo-estacionarias" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>En el ámbito del modelado estadístico, a menudo nos esforzamos por descubrir la genuina conexión entre entradas específicas y la variable de salida. <em>Nuestros esfuerzos suelen dar como resultado modelos que simplemente aproximan la “verdadera” relación</em>.</p></li>
<li><p>Este resultado comúnmente se origina en las decisiones estratégicas del analista para facilitar el proceso de modelado. Una suposición fundamental que a menudo simplifica los esfuerzos de modelado es la <em><strong>suposición de linealidad</strong></em>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Filtro lineal</p>
<ul>
<li><p>Un <strong>filtro lineal</strong> constituye una transformación lineal de una serie temporal, <span class="math notranslate nohighlight">\(x_{t}\)</span> a otra serie de tiempo <span class="math notranslate nohighlight">\(y_{t}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-linear-filter-yt">
<span class="eqno">(31)<a class="headerlink" href="#equation-linear-filter-yt" title="Link to this equation">#</a></span>\[
  y_{t}=L(x_{t})=\sum_{i=-\infty}^{+\infty}\psi_{i}x_{t-i},~\text{con}~t=,\dots,-1,0,1,\dots,
  \]</div>
</li>
</ul>
</div>
<ul class="simple">
<li><p>En ese sentido, el <strong>filtro lineal</strong> puede verse como un “proceso” que convierte la entrada, <span class="math notranslate nohighlight">\(x_{t}\)</span>, en una salida, <span class="math notranslate nohighlight">\(y_{t}\)</span>, y esa conversión no es instantánea, sino que involucra todos (<em><strong>presente, pasado y futuro</strong></em>) los valores de la entrada en forma de suma con diferentes “pesos”, <span class="math notranslate nohighlight">\(\psi_{i}\)</span>, en cada <span class="math notranslate nohighlight">\(x_{t-i}\)</span>.</p></li>
<li><p>Además, el filtro lineal en la Ecuación <a class="reference internal" href="#equation-linear-filter-yt">(31)</a> se dice que tiene las siguientes propiedades:</p>
<ol class="arabic simple">
<li><p><strong>Invariante en el tiempo</strong>, ya que los coeficientes <span class="math notranslate nohighlight">\(\psi_{i}\)</span> no dependen del tiempo.</p></li>
<li><p><strong>Físicamente realizable</strong> si <span class="math notranslate nohighlight">\(\psi_{i}=0\)</span> para <span class="math notranslate nohighlight">\(i&lt;0\)</span>; esto es, el output <span class="math notranslate nohighlight">\(y_{t}\)</span> es una función lineal de los actuales y pasados valores del input: <span class="math notranslate nohighlight">\(y_{t}=\psi_{0}x_{t}+\psi_{1}x_{t-1}+\cdots\)</span></p></li>
<li><p><strong>Estable</strong> si <span class="math notranslate nohighlight">\(\sum_{i=-\infty}^{+\infty}|\psi_{i}|&lt;\infty\)</span>.</p></li>
</ol>
</li>
</ul>
<ul class="simple">
<li><p>En los filtros lineales, ciertas condiciones hacen que ciertas características, como la <em>estacionariedad de la serie temporal de entrada, también se manifiesten en la de salida</em>. En el capítulo previo, exploramos el concepto de <strong>estacionariedad</strong> mencionado anteriormente.</p></li>
</ul>
</section>
<section id="estacionariedad">
<h2>Estacionariedad<a class="headerlink" href="#estacionariedad" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La <strong>estacionariedad</strong> de una serie temporal está relacionada con sus <em>propiedades estadísticas en el tiempo</em>. Es decir, en un sentido más estricto, <em><strong>una serie temporal estacionaria exhibe un comportamiento estadístico similar en el tiempo</strong></em>, lo que a menudo se caracteriza como una distribución de probabilidad constante en el tiempo.</p></li>
<li><p>Sin embargo, por lo general, es satisfactorio considerar los dos primeros momentos de la serie temporal y definir la <strong>estacionariedad</strong> (o <em>estacionariedad débil</em>) de la siguiente manera:</p></li>
<li><ol class="arabic simple">
<li><p>El <em>valor esperado de la serie temporal no depende del tiempo</em></p></li>
<li><p><em>La función de autocovarianza</em> definida como <span class="math notranslate nohighlight">\(\text{Cov}(y_{t} , y_{t+k})\)</span> para cualquier rezago, <span class="math notranslate nohighlight">\(k\)</span> <em><strong>es solo una función de</strong></em> <span class="math notranslate nohighlight">\(k\)</span> <em>y no del tiempo</em>; es decir, <span class="math notranslate nohighlight">\(\gamma_{y}(k) = \text{Cov}(y_{t}, y_{t+k})\)</span>.</p></li>
</ol>
</li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>La <strong>estacionariedad</strong> de una serie temporal se puede evaluar aproximadamente mediante la observación de su comportamiento en diferentes momentos. Si muestra un <em><strong>comportamiento similar en distintos instantes, se puede asumir estacionariedad y continuar con el modelado</strong></em>.</p></li>
<li><p>Además, pruebas preliminares, como el análisis de la <em><strong>función de autocorrelación</strong></em>, pueden <em><strong>proporcionar indicios sobre la estacionariedad</strong></em>. Un <em>decaimiento lento en la autocorrelación sugiere desviaciones de la estacionariedad</em>. También existen pruebas metodológicas más rigurosas para evaluar la estacionariedad, que se discutirán posteriormente en este capítulo.</p></li>
</ul>
</div>
<div class="admonition-teorema admonition">
<p class="admonition-title">Teorema</p>
<ul>
<li><p>Dado un <em><strong>filtro lineal invariante en el tiempo y estable</strong></em> y una serie de tiempo con <em><strong>input</strong></em> <span class="math notranslate nohighlight">\(x_{t}\)</span> <em><strong>estacionario</strong></em>, con <span class="math notranslate nohighlight">\(\mu_{x}=\text{E}(x_{t})\)</span> y <span class="math notranslate nohighlight">\(\gamma_{x}(k)=\text{Cov}(x_{t}, x_{t+k})\)</span>, la serie de tiempo</p>
<div class="math notranslate nohighlight" id="equation-linear-invariant-process">
<span class="eqno">(32)<a class="headerlink" href="#equation-linear-invariant-process" title="Link to this equation">#</a></span>\[
    y_{t}=L(x_{t})=\sum_{i=-\infty}^{\infty}\psi_{i}x_{t-i},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(t=,\dots,-1,0,1,\dots,\)</span> <em><strong>es también estacionaria</strong></em>.</p>
</li>
<li><p>El siguiente proceso lineal estable con <em><strong>ruido blanco</strong></em> <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> <em><strong>es también estacionario</strong></em></p>
<div class="math notranslate nohighlight" id="equation-linear-filter-white-noise">
<span class="eqno">(33)<a class="headerlink" href="#equation-linear-filter-white-noise" title="Link to this equation">#</a></span>\[
    y_{t}=\mu+\sum_{i=-\infty}^{\infty}\psi_{i}\varepsilon_{t-i},
    \]</div>
<p>y además puede reescribirse como sigue, en términos del <em><strong>operado backshift</strong></em> <span class="math notranslate nohighlight">\(B\)</span> como</p>
<div class="math notranslate nohighlight" id="equation-moving-average-backshift">
<span class="eqno">(34)<a class="headerlink" href="#equation-moving-average-backshift" title="Link to this equation">#</a></span>\[
    y_{t}=\mu+\left(\sum_{i=0}^{\infty}\psi_{i}B^{i}\right)\varepsilon_{t}=\mu+\Psi(B)\varepsilon_{t}.
    \]</div>
</li>
</ul>
</div>
<p><em><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></em></p>
<ul class="simple">
<li><p>Calculemos <em><strong>valor esperado</strong></em> para la serie <span class="math notranslate nohighlight">\(y_{t}\)</span> dada en la Ecuación <a class="reference internal" href="#equation-linear-invariant-process">(32)</a>. Nótese que es constante respecto a <span class="math notranslate nohighlight">\(t\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\begin{align*}
\text{E}(y_{t})=\text{E}\left(\sum_{i=-\infty}^{\infty}\psi_{i}\text{E}(x_{t-i})\right)=\sum_{i=-\infty}^{\infty}\psi_{i}\text{E}(x_{t-i})=\sum_{i=-\infty}^{\infty}\psi_{i}\mu_{x}
\end{align*}
\]</div>
<ul class="simple">
<li><p>Evaluemos ahora la <a class="reference external" href="https://en.wikipedia.org/wiki/Covariance">autocovarianza</a>. Nótese que esta es función de <span class="math notranslate nohighlight">\(k\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{Cov}(y_{t}, y_{t+k})&amp;=\text{Cov}\left(\sum_{i=-\infty}^{\infty}\psi_{i}x_{t-i}, \sum_{j=-\infty}^{\infty}\psi_{j}x_{t+k-j}\right)\\
&amp;=\sum_{i=-\infty}^{\infty}\sum_{j=-\infty}^{\infty}\psi_{i}\psi_{j}\text{Cov}(x_{t-i}, x_{t+k-j})\\
&amp;=\sum_{i=-\infty}^{\infty}\sum_{j=-\infty}^{\infty}\psi_{i}\psi_{j}\gamma_{x}(k+i-j).
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Por lo tanto, la serie de tiempo definida como en la Ecuación <a class="reference internal" href="#equation-linear-invariant-process">(32)</a> es estacionaria. Consideremos ahora la serie de la Ecuación <a class="reference internal" href="#equation-linear-filter-white-noise">(33)</a> y verifiquemos que es estacionaría</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}(y_{t})=\text{E}\left(\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i}\right)=\mu+\sum_{i=0}^{\infty}\psi_{i}\cancelto{0}{\text{E}(\varepsilon_{t-i})}=\mu.
\]</div>
<ul class="simple">
<li><p>Dado que <span class="math notranslate nohighlight">\(\gamma_{c}(k)=\text{Cov}(c,c)=\text{Var}(c)=0,~\forall c\in\mathbb{R}\)</span>, la autocovarianza de la Ecuación <a class="reference internal" href="#equation-linear-filter-white-noise">(33)</a> está dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{Cov}(y_{t}, y_{t+k})&amp;=\text{Cov}\left(\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i}, \mu+\sum_{j=0}^{\infty}\psi_{j}\varepsilon_{t+k-j}\right)\\
&amp;=\text{Cov}\left(\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i}, \sum_{j=0}^{\infty}\psi_{j}\varepsilon_{t+k-j}\right)\\
&amp;=\sum_{i=0}^{\infty}\sum_{j=0}^{\infty}\psi_{i}\psi_{j}\text{Cov}(\varepsilon_{t-i}, \varepsilon_{t+k-j})\\
&amp;=\sum_{i=0}^{\infty}\sum_{j=0}^{\infty}\psi_{i}\psi_{j}\gamma_{\varepsilon}(k+i-j),~\text{donde}~\gamma_{\varepsilon}(h)=\begin{cases}\sigma^{2}, &amp; h=0\\0, &amp; h\neq0\end{cases}\\
&amp;=\sigma^{2}\sum_{i=0}^{\infty}\psi_{i}\psi_{i+k}.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Nótese que la última igualdad es independiente de <span class="math notranslate nohighlight">\(t\)</span>. Además, se usó el hecho de que: <span class="math notranslate nohighlight">\(h=k+i-j=0\)</span> entonces <span class="math notranslate nohighlight">\(\gamma_{\varepsilon}(h)=\sigma^{2}\)</span>.</p></li>
<li><p>La Ecuación <a class="reference internal" href="#equation-linear-filter-white-noise">(33)</a> puede reescribirse como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
y_{t}=\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i}&amp;=\mu+\psi_{0}\varepsilon_{t}+\psi_{1}\varepsilon_{t-1}+\psi_{2}\varepsilon_{t-2}+\cdots\\
&amp;=\mu+\psi_{0}B^{0}\varepsilon_{t}+\psi_{1}B^{1}\varepsilon_{t}+\psi_{2}B^{2}\varepsilon_{t}+\cdots\\
&amp;=\mu+\sum_{i=0}^{\infty}\psi_{i}B^{i}\varepsilon_{t}\\
&amp;=\mu+\left(\sum_{i=0}^{\infty}\psi_{i}B^{i}\right)\varepsilon_{t}=\mu+\Psi(B)\varepsilon_{t}.
\end{align*}
\end{split}\]</div>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>La Ecuación <a class="reference internal" href="#equation-moving-average-backshift">(34)</a> se le conoce como el <em><strong>promedio móvil infinito</strong></em> y sirve como una clase general de <em><strong>modelos para cualquier serie temporal estacionaria</strong></em> <span id="id1">[<a class="reference internal" href="biblio.html#id10" title="Herman Wold. A study in the analysis of stationary time series. PhD thesis, Almqvist &amp; Wiksell, 1938.">Wold, 1938</a>]</span>.</p></li>
<li><p>Básicamente, establece que <em><strong>cualquier serie temporal</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>no determinística y estacionaria débil puede ser representada como en la Ecuación</strong></em> <a class="reference internal" href="#equation-linear-filter-white-noise">(33)</a>, donde <span class="math notranslate nohighlight">\(\{\psi_{i}\}\)</span> satisfacen <span class="math notranslate nohighlight">\(\sum_{i=0}^{\infty}\psi_{i}^{2}&lt;\infty\)</span>.</p></li>
<li><p>Una interpretación más intuitiva de este teorema es que <em><strong>una serie temporal estacionaria puede ser vista como la suma ponderada de las “perturbaciones” aleatorias presentes y pasadas</strong></em> <span id="id2">[<a class="reference internal" href="biblio.html#id11" title="George Udny Yule. On a method of investigating periodicities in disturbed series with special reference to wolfer’s sunspot numbers. Statistical Papers of George Udny Yule, pages 389–420, 1971.">Yule, 1971</a>, <a class="reference internal" href="biblio.html#id12" title="Søren Bisgaard and Murat Kulahci. Time series analysis and forecasting by example. John Wiley &amp; Sons, 2011.">Bisgaard and Kulahci, 2011</a>]</span>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>El <em><strong>Teorema de Wold</strong></em> requiere que los choques aleatorios en una <em><strong>media móvil infinita</strong></em> sean ruido blanco, que definimos como <em><strong>choques aleatorios no correlacionados con varianza constante</strong></em>. Es importante tener en cuenta que hay una diferencia entre correlación e independencia.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Indpendencia vs No Correlación</p>
<ul class="simple">
<li><p>Las <em><strong>variables aleatorias independientes también son no correlacionadas, pero lo contrario no siempre es cierto</strong></em>. La <em><strong>independencia</strong></em> entre dos variables aleatorias se refiere a que su <em><strong>función de distribución de probabilidad conjunta es igual al producto de las distribuciones marginales</strong></em>. Es decir, dos variables aleatorias <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> se dicen independientes si</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
f(X, Y)=f_{X}(X)f_{Y}(Y).
\]</div>
<ul class="simple">
<li><p>Esto puede interpretarse de manera general como que si <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> son <em><strong>independientes, conocer el valor de</strong></em> <span class="math notranslate nohighlight">\(X\)</span>, por ejemplo, <em><strong>no proporciona información sobre cuál podría ser el valor de</strong></em> <span class="math notranslate nohighlight">\(Y\)</span>. Para dos variables aleatorias no correlacionadas <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span>, tenemos que su correlación y su covarianza son iguales a cero. Es decir,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{Cov}(X, Y)=\text{E}[(X-\mu_{X})(Y-\mu_{Y})]=\text{E}[XY]-\text{E}[X]\text{E}[Y]=0.
\]</div>
<ul class="simple">
<li><p>Esto implica que <em><strong>si</strong></em> <span class="math notranslate nohighlight">\(X\)</span> <em><strong>y</strong></em> <span class="math notranslate nohighlight">\(Y\)</span> <em><strong>son no correlacionados</strong></em>, <span class="math notranslate nohighlight">\(\text{E}[XY]=\text{E}[X]\text{E}[Y]\)</span></p></li>
<li><p>Claramente, si <strong>dos variables son independientes, estas son no correlacionadas</strong>, ya que bajo independencia se tiene que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{E}[XY]&amp;=\int\int xyf(x, y)dxdy\\
&amp;=\int\int xyf(x)f(y)dxdy\\
&amp;=\left\{\int xf(x)dx\right\}\left\{\int yf(y)dy\right\}\\[2mm]
&amp;=\text{E}[X]\text{E}[Y].
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Lo contrario no siempre es cierto. Para ilustrarlo con un ejemplo, consideremos <span class="math notranslate nohighlight">\(X\)</span>, una <em><strong>variable aleatoria con una función de densidad de probabilidad simétrica alrededor de 0</strong></em>, es decir, <span class="math notranslate nohighlight">\(\text{E}[X] = 0\)</span>. Supongamos que la segunda variable <span class="math notranslate nohighlight">\(Y\)</span> es igual a <span class="math notranslate nohighlight">\(|X|\)</span>.</p></li>
<li><p>Dado que conocer el valor de <span class="math notranslate nohighlight">\(X\)</span> <strong>también determina el valor de</strong> <span class="math notranslate nohighlight">\(Y\)</span>, <strong>estas dos variables claramente no son independientes</strong>. Sin embargo, se puede demostrar que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}[Y]=2\int_{0}^{\infty}xf(x)dx~\text{y}~\text{E}[XY]=\int_{0}^{\infty}x^{2}f(x)dx-\int_{-\infty}^{0}x^{2}f(x)dx=0.
\]</div>
<ul class="simple">
<li><p>Entonces <span class="math notranslate nohighlight">\(\text{E}[XY]=\text{E}[X]\text{E}[Y]\)</span>. Esto muestra que <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> <strong>no están correlacionadas, pero no son independientes</strong>.</p></li>
</ul>
</div>
</section>
<section id="proceso-de-media-movil-finito-ma-q">
<h2>Proceso de media movil finito <span class="math notranslate nohighlight">\(MA(q)\)</span><a class="headerlink" href="#proceso-de-media-movil-finito-ma-q" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Proceso de media móvil de orden <span class="math notranslate nohighlight">\(q\)</span> (<span class="math notranslate nohighlight">\(MA(q)\)</span>)</p>
<ul>
<li><p>En los <em><strong>modelos de media móvil de orden finito</strong></em> o <span class="math notranslate nohighlight">\(MA\)</span>, convencionalmente <span class="math notranslate nohighlight">\(\psi_{0}\)</span> se establece en 1 y los pesos que no se establecen en 0 se representan con la letra griega <span class="math notranslate nohighlight">\(\theta\)</span> con signo negativo delante. Por lo tanto, un <em><strong>proceso de media móvil de orden</strong></em> <span class="math notranslate nohighlight">\(q\)</span> (<span class="math notranslate nohighlight">\(MA(q)\)</span>) se expresa como</p>
<div class="math notranslate nohighlight" id="equation-finite-moving-average-orderq">
<span class="eqno">(35)<a class="headerlink" href="#equation-finite-moving-average-orderq" title="Link to this equation">#</a></span>\[
    y_{t}=\mu+\varepsilon_{t}-\theta_{1}\varepsilon_{t-1}-\cdots-\theta_{q}\varepsilon_{q}
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\{\varepsilon_{t}\}\)</span> es <em><strong>ruido blanco</strong></em>.</p>
</li>
</ul>
</div>
<ul class="simple">
<li><p>Suponga que está modelando el <em><strong>número de ventas diarias en una tienda</strong></em>. En un modelo de <em>media móvil</em>, podría tener en cuenta el <em><strong>efecto de los errores pasados en las ventas actuales</strong></em>. Supongamos que <em><strong>ayer hubo un error positivo en las ventas</strong></em>, es decir, se <em>vendió más de lo esperado</em>. En ese caso, se esperaría que las <em><strong>ventas de hoy sean menores para compensar ese exceso de ventas de ayer</strong></em>. Por lo tanto, el <em><strong>coeficiente asociado con el error de ayer sería negativo</strong></em> en el modelo de promedio móvil.</p></li>
</ul>
<div class="admonition-teorema admonition">
<p class="admonition-title">Teorema</p>
<ul>
<li><p>Dado que la Ecuación <a class="reference internal" href="#equation-finite-moving-average-orderq">(35)</a> es un caso especial de la Ecuación <a class="reference internal" href="#equation-moving-average-backshift">(34)</a> con solo pesos finitos, <em><strong>un proceso</strong></em> <span class="math notranslate nohighlight">\(MA(q)\)</span> <em><strong>siempre es estacionario independientemente de los valores de los pesos</strong></em>. En términos del operador backshift, el proceso <span class="math notranslate nohighlight">\(MA(q)\)</span> está dado por</p>
<div class="math notranslate nohighlight">
\[
    y_{t}=\mu+\Phi(B)\varepsilon_{t},~\text{donde}~\Phi(B)=1-\sum_{i=1}^{q}\theta_{i}B^{i}.
    \]</div>
</li>
<li><p>Además, dado que <span class="math notranslate nohighlight">\(\{\varepsilon_{t}\}\)</span> es ruido blanco, <em><strong>el valor esperado del proceso</strong></em> <span class="math notranslate nohighlight">\(MA(q)\)</span> es simplemente <span class="math notranslate nohighlight">\(\text{E}(y_{t})=\mu\)</span> y <em><strong>su varianza es</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-variance-finite-moving-averageq">
<span class="eqno">(36)<a class="headerlink" href="#equation-variance-finite-moving-averageq" title="Link to this equation">#</a></span>\[
\text{Var}(y_{t})=\gamma_{y}(0)=\sigma^{2}(1+\theta_{1}^{2}+\theta_{2}^{2}+\cdots+\theta_{q}^{2})
\]</div>
<ul class="simple">
<li><p>Similarmente, la <em><strong>autocovarianza en el lag</strong></em> <span class="math notranslate nohighlight">\(k\)</span> puede ser calculada como</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-autocovariance-atlagk-finite-moving-averageq">
<span class="eqno">(37)<a class="headerlink" href="#equation-autocovariance-atlagk-finite-moving-averageq" title="Link to this equation">#</a></span>\[\begin{split}
\gamma_{y}(k)=\begin{cases}
\sigma^{2}(-\theta_{k}+\theta_{1}\theta_{k+1}+\cdots+\theta_{q-k}\theta_{q}), &amp; k=1,2,\dots, q\\
0, &amp; k&gt;q.
\end{cases}
\end{split}\]</div>
<ul class="simple">
<li><p>A partir de las Ecuaciones <a class="reference internal" href="#equation-variance-finite-moving-averageq">(36)</a>, <a class="reference internal" href="#equation-autocovariance-atlagk-finite-moving-averageq">(37)</a>, la <em><strong>función de autocorrelación del proceso</strong></em> <span class="math notranslate nohighlight">\(MA(q)\)</span> es</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\rho_{y}(k)=\frac{\gamma_{y}(k)}{\gamma_{y}(0)}=
\begin{cases}
\displaystyle{\frac{-\theta_{k}+\theta_{1}\theta_{k+1}+\cdots+\theta_{q-k}\theta_{q}}{1+\theta_{1}^{2}+\cdots+\theta_{q}^{2}}}, &amp; k=1,2,\dots,q\\
0, &amp; k&gt;q.
\end{cases}
\end{split}\]</div>
</div>
<p><em><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></em></p>
<ul>
<li><p>Nótese que utilizando el operador backshift el proceso <span class="math notranslate nohighlight">\(MA(q)\)</span> se escribe como</p>
<div class="math notranslate nohighlight">
\[
  y_{t}=\mu+(B^{0}-\theta_{1}B^{1}-\theta_{2}B^{2}-\cdots-\theta_{q}B^{q})\varepsilon_{t}=\mu+\left(1-\sum_{i=1}^{q}\theta_{i}B^{i}\right)\varepsilon_{t}=\mu+\Phi(B)\varepsilon_{t}
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Dado que <span class="math notranslate nohighlight">\(\{\varepsilon_{t}\}\)</span> es un proceso <em><strong>white noise</strong></em>, su <em><strong>valor esperado</strong></em> está dado por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{E}(y_{t})&amp;=\text{E}(\mu+\varepsilon_{t}-\theta_{1}\varepsilon_{t-1}-\cdots-\theta_{q}\varepsilon_{t-q})\\
&amp;=\mu+\cancelto{0}{\text{E}(\varepsilon_{t})}-\theta_{1}\cancelto{0}{\text{E}(\varepsilon_{t-1})}-\cdots-\theta_{q}\cancelto{0}{\text{E}(\varepsilon_{t-q})}=\mu
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Además, su <em><strong>varianza</strong></em> está dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{Var}(y_{t})&amp;=\text{Var}(\mu+\varepsilon_{t}-\theta_{1}\varepsilon_{t-1}-\cdots-\theta_{q}\varepsilon_{t-q})\\
&amp;=\text{Var}(\mu)+\text{Var}(\varepsilon_{t})+\theta_{1}^{2}\text{Var}(\varepsilon_{t-1})+\cdots+\theta_{q}^{2}\text{Var}(\varepsilon_{t-q})\\
&amp;=\sigma^{2}+\theta_{1}^{2}\sigma^{2}+\theta_{2}^{2}\sigma^{2}+\cdots+\theta_{q}^{2}\sigma^{2}\\
&amp;=\sigma^{2}(1+\theta_{1}^{2}+\theta_{2}^{2}+\cdots+\theta_{q}^{2})=\gamma_{y}(0).
\end{align*}
\end{split}\]</div>
<ul>
<li><p>Análogamente, la autocovarianza en el lag <span class="math notranslate nohighlight">\(k\)</span> está dada por</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \gamma_{y}(k)&amp;=\text{Cov}(y_{t}, y_{t+k})\\
&amp;=\text{E}((\mu+\epsilon_{t}-\theta_{1}\varepsilon_{t-1}-\cdots-\theta_{q}\varepsilon_{t-q}-\mu)(\mu+\varepsilon_{t+k}-\theta_{1}\varepsilon_{t+k-1}-\cdots-\theta_{q}\varepsilon_{t+k-q}-\mu))\\
  &amp;=\text{E}((\epsilon_{t}-\theta_{1}\varepsilon_{t-1}-\cdots-\theta_{q}\varepsilon_{t-q})(\varepsilon_{t+k}-\theta_{1}\varepsilon_{t+k-1}-\cdots-\theta_{q}\varepsilon_{t+k-q}))
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>Recuerde que: <span class="math notranslate nohighlight">\(\text{E}(\varepsilon_{t})=0,~\text{Var}(\varepsilon_{t})=\text{E}(\varepsilon_{t}^{2})=\sigma^{2}\)</span> y <span class="math notranslate nohighlight">\(\text{Cov}(\varepsilon_{t}, \varepsilon_{t-k})=\text{E}(\varepsilon_{t}\varepsilon_{t-k})=0,~k\neq0\)</span>. Nótese además que para <span class="math notranslate nohighlight">\(k=1\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{E}((\varepsilon_{t}-\theta_{1}\varepsilon_{t-1}-\cdots&amp;-\theta_{q}\varepsilon_{t-q})(\varepsilon_{t+1}-\theta_{1}\varepsilon_{t}-\cdots-\theta_{q}\varepsilon_{t+1-q}))\\
&amp;=\text{E}\textcolor{red}{(}\varepsilon_{t}\varepsilon_{t+1}-\theta_{1}\varepsilon_{t}^{2}-\theta_{2}\varepsilon_{t}\varepsilon_{t-1}-\cdots-\theta_{q}\varepsilon_{t}\varepsilon_{t+1-q}\\
&amp;-\theta_{1}\varepsilon_{t-1}\varepsilon_{t+1}+\theta_{1}^{2}\varepsilon_{t-1}\varepsilon_{t}+\theta_{1}\theta_{2}\varepsilon_{t-1}^{2}+\cdots+\theta_{1}\theta_{q}\varepsilon_{t-1}\varepsilon_{t+1-q}\\
&amp;-\theta_{2}\varepsilon_{t-2}\varepsilon_{t+1}\theta_{2}\theta_{1}\varepsilon_{t-2}\varepsilon_{t}+\theta_{2}^{2}\varepsilon_{t-2}\varepsilon_{t-1}+\theta_{2}\theta_{3}\varepsilon_{t-2}^{2}+\cdots+\theta_{2}\theta_{q}\varepsilon_{t-2}\varepsilon_{t+1-q}\\
&amp;\cdots\\
&amp;-\theta_{q}\varepsilon_{t-q}\varepsilon_{t+1}+\theta_{q}\theta_{1}\varepsilon_{t-q}\varepsilon_{t}+\cdots+\theta_{q}\theta_{1-q}\varepsilon_{t-q}^{2}+\theta_{q}^{2}\varepsilon_{t-q}\varepsilon_{t+1-q}\textcolor{red}{)}\\
&amp;=-\theta_{1}\sigma^{2}+\theta_{1}\theta_{2}\sigma^{2}+\theta_{2}\theta_{3}\sigma^{2}+\cdots+\theta_{q}\theta_{1-q}\sigma^{2}\\
&amp;=\sigma^{2}(-\theta_{1}+\theta_{1}\theta_{2}+\theta_{2}\theta_{3}+\cdots+\theta_{1-q}\theta_{q}).
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Análogamente, para <span class="math notranslate nohighlight">\(k=2\)</span> se tiene que (<em><strong>verifíquelo</strong></em>): <span class="math notranslate nohighlight">\(\gamma_{y}(2)=\sigma^{2}(-\theta_{2}+\theta_{1}\theta_{3}+\theta_{2}\theta_{4}+\cdots+\theta_{2-q}\theta_{q})\)</span>. Por lo tanto,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\gamma_{y}(k)=
\begin{cases}
\sigma^{2}(-\theta_{k}+\theta_{1}\theta_{k+1}+\theta_{2}\theta_{k+2}+\cdots+\theta_{k-q}\theta_{q}), &amp; k=1,2,\dots,q\\
0, &amp; \text{otro caso}.
\end{cases}
\end{split}\]</div>
<ul class="simple">
<li><p>Entonces la <em><strong>función de autocorrelación</strong></em> de <span class="math notranslate nohighlight">\(MA(q)\)</span>, para <span class="math notranslate nohighlight">\(k=1,2,\dots,q\)</span> está dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\rho_{y}(k)=\frac{\gamma_{y}(k)}{\gamma_{y}(0)}&amp;=\frac{\sigma^{2}(-\theta_{k}+\theta_{1}\theta_{k+1}+\theta_{2}\theta_{k+2}+\cdots+\theta_{k-q}\theta_{q})}{\sigma^{2}(1+\theta_{1}^{2}+\theta_{2}^{2}+\cdots+\theta_{q}^{2})}\\
&amp;=\frac{-\theta_{k}+\theta_{1}\theta_{k+1}+\theta_{2}\theta_{k+2}+\cdots+\theta_{k-q}\theta_{q}}{1+\theta_{1}^{2}+\theta_{2}^{2}+\cdots+\theta_{q}^{2}},~\text{si}~k&gt;q,~\rho_{y}(k)=0.
\end{align*}
\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul>
<li><p>Esta característica de la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> es muy <em><strong>útil para identificar el modelo <code class="docutils literal notranslate"><span class="pre">MA</span></code> y su orden adecuado, ya que <em>“se corta”</em> después del rezago</strong></em> <span class="math notranslate nohighlight">\(q\)</span>. Sin embargo, en aplicaciones de la vida real, la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> muestral, <span class="math notranslate nohighlight">\(r(k)\)</span>, no necesariamente será igual a cero después del rezago <span class="math notranslate nohighlight">\(q\)</span>. <em><strong>Se espera que se vuelva muy pequeña en valor absoluto después del rezago</strong></em> <span class="math notranslate nohighlight">\(q\)</span>.</p></li>
<li><p>Para un conjunto de datos de <span class="math notranslate nohighlight">\(N\)</span> observaciones, esto a menudo se prueba contra límites de <span class="math notranslate nohighlight">\(\pm 2/\sqrt{N}\)</span>, donde <span class="math notranslate nohighlight">\(1/\sqrt{N}\)</span> es el <em><strong>valor aproximado para la desviación estándar de la</strong></em> <code class="docutils literal notranslate"><span class="pre">ACF</span></code> <em><strong>para cualquier rezago</strong></em> bajo la suposición de que <span class="math notranslate nohighlight">\(\rho(k)=0\)</span> para todos los <span class="math notranslate nohighlight">\(k\)</span>.</p></li>
<li><p><span id="id3">[<a class="reference internal" href="biblio.html#id3" title="Maurice S Bartlett. On the theoretical specification and sampling properties of autocorrelated time-series. Supplement to the Journal of the Royal Statistical Society, 8(1):27–41, 1946.">Bartlett, 1946</a>]</span> <span id="id4">[<a class="reference internal" href="biblio.html#id30" title="P.J. Brockwell and R.A. Davis. Time Series: Theory and Methods: Theory and Methods. Springer Series in Statistics. Springer New York, 1991. ISBN 9780387974293. URL: https://books.google.com.co/books?id=ZW_ThhYQiXIC.">Brockwell and Davis, 1991</a>]</span> Tenga en cuenta que una fórmula más precisa para el <em><strong>error estándar del coeficiente de autocorrelación muestral <span class="math notranslate nohighlight">\(k\)</span></strong></em> es proporcionada por (<em><strong><code class="docutils literal notranslate"><span class="pre">bonus</span></code></strong></em>)</p>
<div class="math notranslate nohighlight">
\[
    \text{s.e.}~(r(k))=N^{-1/2}\left(1+2\sum_{j=1}^{k-1}r(j)^{\star 2}\right)^{1/2}
    \]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    r(j)^{\star}=\begin{cases}r(j) &amp; \text{para}~\rho(j)\neq 0\\0 &amp; \text{para}~\rho(j)=0.\end{cases}
    \end{split}\]</div>
</li>
</ul>
</div>
<ul class="simple">
<li><p>Un caso especial sería datos de <em><strong>ruido blanco, para los cuales</strong></em> <span class="math notranslate nohighlight">\(\rho(j) = 0\)</span> <em><strong>para todos los valores de</strong></em> <span class="math notranslate nohighlight">\(j\)</span>. Por lo tanto, para un proceso de <em><strong>ruido blanco (es decir, sin autocorrelación)</strong></em>, un intervalo razonable para los coeficientes de autocorrelación muestral sería <span class="math notranslate nohighlight">\(\pm 2/N\)</span> y <em><strong>cualquier indicación contraria puede considerarse como evidencia de dependencia serial en el proceso</strong></em>.</p></li>
</ul>
</section>
<section id="el-proceso-de-media-movil-de-primer-orden-ma-1">
<h2>El Proceso de Media Móvil de Primer Orden, <span class="math notranslate nohighlight">\(MA(1)\)</span><a class="headerlink" href="#el-proceso-de-media-movil-de-primer-orden-ma-1" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Media Móvil de Primer Orden <span class="math notranslate nohighlight">\(MA(1)\)</span></p>
<ul class="simple">
<li><p>El modelo <span class="math notranslate nohighlight">\(MA\)</span> de orden finito más simple se obtiene cuando <span class="math notranslate nohighlight">\(q = 1\)</span> en la Ecuación <a class="reference internal" href="#equation-finite-moving-average-orderq">(35)</a></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_{t}=\mu+\varepsilon_{t}-\theta_{1}\varepsilon_{t-1}.
\]</div>
<ul class="simple">
<li><p>Para el modelo de <em><strong>media móvil de primer orden</strong></em> o <span class="math notranslate nohighlight">\(MA(1)\)</span>, tenemos la <em><strong>función de autocovarianza</strong></em> como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\gamma_{y}(0) &amp;=\sigma^{2}(1+\theta_{1}^{2})\\
\gamma_{y}(1) &amp;=-\theta_{1}\sigma^{2}\\
\gamma_{y}(k) &amp;=0,~k&gt;1.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>De manera similar, tenemos la función de <em><strong>autocorrelación</strong></em> como</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-acf-maq1">
<span class="eqno">(38)<a class="headerlink" href="#equation-acf-maq1" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\rho_{y}(1) &amp;=\frac{-\theta_{1}}{1+\theta_{1}^{2}}\\
\rho_{y}(k) &amp;=0,~k&gt;1.
\end{align*}
\end{split}\]</div>
<ul>
<li><p>De la Ecuación <a class="reference internal" href="#equation-acf-maq1">(38)</a>, podemos ver que la autocorrelación del primer rezago en <span class="math notranslate nohighlight">\(MA(1)\)</span> está limitada a</p>
<div class="math notranslate nohighlight">
\[
    |\rho_{y}(1)|=\frac{|\theta_{1}|}{1+\theta_{1}^{2}}\leq\frac{1}{2}
    \]</div>
<p>y la función de <em><strong>autocorrelación se reduce a cero después del primer rezago</strong></em>.</p>
</li>
</ul>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span> 
<span class="kn">import</span> <span class="nn">statsmodels.tsa.api</span> <span class="k">as</span> <span class="nn">smtsa</span>
<span class="kn">import</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="k">as</span> <span class="nn">arima_model</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plotds</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">nlag</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">)):</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
         <span class="n">xt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="n">ax_xt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_acf</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">ax_pacf</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    
    <span class="n">xt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_xt</span><span class="p">)</span>
    <span class="n">ax_xt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Series&#39;</span><span class="p">)</span>
    <span class="n">plot_acf</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_acf</span><span class="p">)</span>
    <span class="n">plot_pacf</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_pacf</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</details>
</div>
<ul class="simple">
<li><p>El siguiente gráfico corresponden al proceso <span class="math notranslate nohighlight">\(MA(1)\)</span>: <span class="math notranslate nohighlight">\(y_{t}=40+\varepsilon_{t}+0.8\varepsilon_{t-1}\)</span>. En este ejemplo se ha utilizado la librería <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.arima_process.arma_generate_sample.html#statsmodels.tsa.arima_process.arma_generate_sample">arma_generate_sample</a>. Debe instalarla previamente usando <code class="docutils literal notranslate"><span class="pre">pip</span></code></p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/ad668d375dab9e83493f5704a8198a0d42cbd7cba8b548730d230be763d03c8a.png" src="_images/ad668d375dab9e83493f5704a8198a0d42cbd7cba8b548730d230be763d03c8a.png" />
</div>
</div>
<ul class="simple">
<li><p>Analogamente, el siguiente gráfico corresponden al proceso <span class="math notranslate nohighlight">\(MA(1)\)</span>: <span class="math notranslate nohighlight">\(y_{t}=40+\varepsilon_{t}-0.8\varepsilon_{t-1}\)</span>. Podemos observar que las observaciones <em><strong>tienden a oscilar sucesivamente</strong></em>. Esto sugiere una <em><strong>autocorrelación negativa</strong></em>, como lo confirma el gráfico de la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> de la muestra.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.8</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span>  <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/b36135e7d03018f49da01ca2b56222fe7f695bfb7b9182358b64a567eb0adcd2.png" src="_images/b36135e7d03018f49da01ca2b56222fe7f695bfb7b9182358b64a567eb0adcd2.png" />
</div>
</div>
</section>
<section id="el-proceso-de-media-movil-de-segundo-orden-ma-2">
<h2>El Proceso de Media Móvil de Segundo Orden, <span class="math notranslate nohighlight">\(MA(2)\)</span><a class="headerlink" href="#el-proceso-de-media-movil-de-segundo-orden-ma-2" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Media Móvil de Segundo Orden <span class="math notranslate nohighlight">\(MA(2)\)</span></p>
<ul class="simple">
<li><p>Otro <em><strong>proceso de media móvil de orden finito</strong></em> útil es <span class="math notranslate nohighlight">\(MA(2)\)</span>, dado como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\begin{align*}
y_{t}=\mu+\varepsilon_{t}-\theta_{1}\varepsilon_{t-1}-\theta_{2}\varepsilon_{t-2}=\mu+(1-\theta_{1}B-\theta_{2}B^{2})\varepsilon_{t}
\end{align*}
\]</div>
<ul class="simple">
<li><p>Las funciones de <em><strong>autocovarianza y autocorrelación</strong></em> para el modelo <span class="math notranslate nohighlight">\(MA(2)\)</span> se expresan como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\gamma_{y}(0) &amp;= \sigma^{2}(1+\theta_{1}^{2}+\theta_{2}^{2})\\
\gamma_{y}(1) &amp;= \sigma^{2}(-\theta_{1}+\theta_{1}\theta_{2})\\
\gamma_{y}(2) &amp;= \sigma^{2}(-\theta_{2})\\
\gamma_{y}(k) &amp;= 0,~k&gt;2,\\
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Además, la <em><strong>función de autocorrelación</strong></em> está dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\rho_{y}(1) &amp;= \frac{-\theta_{1}+\theta_{1}\theta_{2}}{1+\theta_{1}^{2}+\theta_{2}^{2}}\\
\rho_{y}(2) &amp;= \frac{-\theta_{2}}{1+\theta_{1}^{2}+\theta_{2}^{2}}\\
\rho_{y}(k) &amp;= 0,~k&gt;2.
\end{align*}
\end{split}\]</div>
</div>
<ul class="simple">
<li><p>El siguiente gráfico muestra la serie temporal y la <em><strong>función de autocorrelación</strong></em> para la realización del modelo <span class="math notranslate nohighlight">\(MA(2)\)</span>: <span class="math notranslate nohighlight">\(y_{t}=40+\varepsilon_{t}+0.7\varepsilon_{t-1}-0.28\varepsilon_{t-2}\)</span></p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/436627913f6f4ab7ad2e2bcb2f3fc47912bef3d772cd3e4314d561ae9161833f.png" src="_images/436627913f6f4ab7ad2e2bcb2f3fc47912bef3d772cd3e4314d561ae9161833f.png" />
</div>
</div>
<ul class="simple">
<li><p>Observe que la <em><strong>función de autocorrelación muestral se anula después del rezago 2</strong></em>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>El <em><strong>teorema de descomposición de Wold</strong></em>, es poderoso, pero no ayuda mucho en nuestros esfuerzos de modelado y pronóstico, ya que requiere implícitamente la estimación de infinitos pesos, <span class="math notranslate nohighlight">\(\psi_{i}\)</span>. Discutiremos un caso especial de esta descomposición, <em><strong>asumiendo que el proceso de series temporales puede ser adecuadamente modelado al estimar solo un número finito de pesos y establecer el resto en cero</strong></em>.</p></li>
<li><p>Otra interpretación de los procesos <code class="docutils literal notranslate"><span class="pre">MA</span></code> de orden finito es que, <em><strong>en cualquier momento, solo un número finito de perturbaciones pasadas “contribuyen” al valor actual de la serie temporal</strong></em>, y que <em><strong>la ventana temporal de los contribuyentes “se mueve”, haciendo que la perturbación “más antigua” sea obsoleta para la siguiente observación</strong></em>.</p></li>
</ul>
</div>
</section>
<section id="procesos-autorregresivos-de-orden-finito">
<h2>Procesos autorregresivos de orden finito<a class="headerlink" href="#procesos-autorregresivos-de-orden-finito" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Algunos procesos pueden tener las dinámicas intrínsecas mencionadas en la anterior observación, pero para otros, es posible que necesitemos <strong><strong>considerar las contribuciones “persistentes” de las perturbaciones que ocurrieron en el pasado</strong></strong>. Una solución a este problema son los <strong><strong>modelos autorregresivos, en los cuales se asume que los infinitos pesos siguen un patrón distintivo</strong></strong> y pueden ser <strong><strong>representados con éxito con solo unos pocos parámetros</strong></strong>. Ahora consideraremos algunos casos especiales de procesos autorregresivos.</p></li>
</ul>
</section>
<section id="proceso-autorregresivo-de-primer-orden-ar-1">
<h2>Proceso autorregresivo de primer orden, <span class="math notranslate nohighlight">\(AR(1)\)</span><a class="headerlink" href="#proceso-autorregresivo-de-primer-orden-ar-1" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Teorema</p>
<ul>
<li><p>Considere el <em><strong>siguiente proceso lineal estable</strong></em>, con serie de tiempo <span class="math notranslate nohighlight">\({\varepsilon}_{t}\)</span>, ruido blanco,</p>
<div class="math notranslate nohighlight">
\[
    y_{t}=\mu+\sum_{i=0}^{\infty}\Psi_{i}\varepsilon_{t-i}.
    \]</div>
</li>
<li><p>Además, para <em><strong>garantizar decrecimiento exponencial</strong></em>, fije <span class="math notranslate nohighlight">\(\psi_{i}=\phi^{i}\)</span>, donde <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span>.</p></li>
<li><p>Demuestre que el <em><strong>proceso autorregresivo de primer orden</strong></em>, está dado por</p>
<div class="math notranslate nohighlight" id="equation-ar1-process-formula">
<span class="eqno">(39)<a class="headerlink" href="#equation-ar1-process-formula" title="Link to this equation">#</a></span>\[
    y_{t}=\delta+\phi y_{t-1}+\varepsilon_{t}.
    \]</div>
</li>
<li><p>Además, demuestre que si <span class="math notranslate nohighlight">\(|\phi|&gt;1\)</span>, existe una <em><strong>solución estacionaria para el proceso</strong></em> <span class="math notranslate nohighlight">\(AR(1)\)</span>; <em><strong>sin embargo, esta solución es no-causal</strong></em> o no-convergente (<em>requiere conocimiento sobre el futuro para hacer pronósticos sobre él</em>).</p></li>
<li><p>Pruebe que, para el proceso <span class="math notranslate nohighlight">\(AR(1)\)</span>, el <em><strong>valor esperado, covarianza y autocorrelación</strong></em>, están dados por</p>
<div class="math notranslate nohighlight" id="equation-ar1-mean-covariance-acf">
<span class="eqno">(40)<a class="headerlink" href="#equation-ar1-mean-covariance-acf" title="Link to this equation">#</a></span>\[\begin{split}
    \begin{align*}
    \text{E}(y_{t}) &amp;= \frac{\delta}{1-\phi}\\
    \gamma(k) &amp;= \sigma^{2}\phi^{k}\frac{1}{1-\phi^{2}},~\text{para}~k=0,1,2,\dots\\
    \rho(k) &amp;= \phi^{k},~\text{para}~k=0,1,2,\dots
    \end{align*}
    \end{split}\]</div>
</li>
</ul>
</div>
<p><em><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></em></p>
<ul>
<li><p>Primero, volvamos a considerar la serie temporal dada en la Ecuación <a class="reference internal" href="#equation-linear-filter-white-noise">(33)</a> asociada con el proceso lineal estable</p>
<div class="math notranslate nohighlight">
\[
  y_{t}=\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i}=\mu+\sum_{i=0}^{\infty}\psi_{i}B^{i}\varepsilon_{t}=\mu+\Psi(B)\varepsilon_{t},
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\Psi(B)=\sum_{i=0}^{\infty}\Psi_{i}B^{i}\)</span>.</p>
</li>
</ul>
<ul class="simple">
<li><p>Una manera de modelar esta serie temporal es <em><strong>asumir que las contribuciones de las perturbaciones que ocurrieron hace mucho tiempo deberían ser pequeñas en comparación con las perturbaciones más recientes experimentadas por el proceso</strong></em>. Dado que las perturbaciones son variables aleatorias independientes e idénticamente distribuidas, podemos simplemente <em><strong>asumir un conjunto de infinitas ponderaciones en magnitudes descendentes que reflejen la disminución en las contribuciones de las perturbaciones pasadas</strong></em>.</p></li>
<li><p>Un conjunto simple e intuitivo de <em><strong>estas ponderaciones pueden seguir un patrón de decaimiento exponencial</strong></em>. Para ello, estableceremos <span class="math notranslate nohighlight">\(\psi_{i}=\phi^{i}\)</span>, donde <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span> para <em><strong>garantizar el “decaimiento” exponencial</strong></em>. Con esta notación, las ponderaciones en las perturbaciones, comenzando desde la perturbación actual y retrocediendo en el tiempo, serán <span class="math notranslate nohighlight">\(1, \phi, \phi^{2}, \phi^{3},\dots\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>Por lo tanto, la Ecuación <a class="reference internal" href="#equation-linear-filter-white-noise">(33)</a> puede escribirse como:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-phii-epsilon-linearcombiantion">
<span class="eqno">(41)<a class="headerlink" href="#equation-phii-epsilon-linearcombiantion" title="Link to this equation">#</a></span>\[
y_{t}=\mu+\varepsilon_{t}+\phi\varepsilon_{t-1}+\phi^{2}\varepsilon_{t-2}+\cdots=\mu+\sum_{i=0}^{\infty}\phi^{i}\varepsilon_{t-i}.
\]</div>
<ul>
<li><p>De la Ecuación <a class="reference internal" href="#equation-phii-epsilon-linearcombiantion">(41)</a> obtenemos</p>
<div class="math notranslate nohighlight" id="equation-phii-epsilon-linearcombiantion-lag1">
<span class="eqno">(42)<a class="headerlink" href="#equation-phii-epsilon-linearcombiantion-lag1" title="Link to this equation">#</a></span>\[
  y_{t-1}=\mu+\varepsilon_{t-1}+\phi\varepsilon_{t-2}+\phi^{2}\varepsilon_{t-3}+\cdots
  \]</div>
</li>
</ul>
<ul>
<li><p>Usando Ecuación <a class="reference internal" href="#equation-phii-epsilon-linearcombiantion">(41)</a> y Ecuación <a class="reference internal" href="#equation-phii-epsilon-linearcombiantion-lag1">(42)</a></p>
<div class="math notranslate nohighlight" id="equation-first-ar-model-proof">
<span class="eqno">(43)<a class="headerlink" href="#equation-first-ar-model-proof" title="Link to this equation">#</a></span>\[\begin{split}
  \begin{align*}
  y_{t} &amp;= \mu+\varepsilon_{t}+\phi\varepsilon_{t-1}+\phi^{2}\varepsilon_{t-2}+\cdots\\
  &amp;= \mu+\varepsilon_{t}+\phi(\varepsilon_{t-1}+\phi\varepsilon_{t-2}+\cdots)\\
  &amp;= \mu+\varepsilon_{t}+\phi(y_{t-1}-\mu)\\
  &amp;= \textcolor{red}{\mu-\phi\mu}+\phi y_{t-1}+\varepsilon_{t}\\
  &amp;= \textcolor{red}{\delta}+\phi y_{t-1}+\varepsilon_{t},
  \end{align*}
  \end{split}\]</div>
<p>donde <span class="math notranslate nohighlight">\(\delta=(1-\phi)\mu\)</span>.</p>
</li>
</ul>
<ul class="simple">
<li><p>El proceso de la Ecuación <a class="reference internal" href="#equation-first-ar-model-proof">(43)</a> es llamado <em><strong>proceso autorregresivo de primer orden</strong></em>, <span class="math notranslate nohighlight">\(AR(1)\)</span>, dado que Ecuación <a class="reference internal" href="#equation-first-ar-model-proof">(43)</a> puede verse como una regresión de <span class="math notranslate nohighlight">\(y_{t}\)</span> sobre <span class="math notranslate nohighlight">\(y_{t-1}\)</span>, es por esto que se usa el término autorregresivo.</p></li>
</ul>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>El supuesto de <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span> <em><strong>conduce a ponderaciones que decaen exponencialmente en el tiempo y también garantiza que</strong></em> <span class="math notranslate nohighlight">\(\sum_{i=0}^{\infty}|\psi_{i}|&lt;\infty\)</span>. Esto significa que un proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> <em><strong>es estacionario si</strong></em> <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span>. Para <span class="math notranslate nohighlight">\(|\phi|&gt;1\)</span>, las perturbaciones pasadas obtendrán <em><strong>ponderaciones exponencialmente crecientes</strong></em> a medida que pasa el tiempo y la <em><strong>serie temporal resultante será explosiva</strong></em>. Este tipo de procesos son de <em><strong>poco interés práctico y, por lo tanto, solo consideran casos donde</strong></em> <span class="math notranslate nohighlight">\(|\phi|=1\)</span> y <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span>.</p></li>
</ul>
</div>
<ul>
<li><p>La solución en Ecuación <a class="reference internal" href="#equation-phii-epsilon-linearcombiantion">(41)</a> de hecho no converge para <span class="math notranslate nohighlight">\(|\phi|&gt;1\)</span>. Sin embargo, podemos reescribir el proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> para <span class="math notranslate nohighlight">\(y_{t+1}\)</span> como <span class="math notranslate nohighlight">\(y_{t+1}=\delta+\phi y_{t}+\varepsilon_{t+1}\)</span>. Entonces, por medio de operaciones de despeje en esta última igualdad, obtenemos</p>
<div class="math notranslate nohighlight" id="equation-noncasual-ar1-proof">
<span class="eqno">(44)<a class="headerlink" href="#equation-noncasual-ar1-proof" title="Link to this equation">#</a></span>\[\begin{split}
  \begin{align*}
  y_{t} &amp;= -\phi^{-1}\delta+\phi^{-1}y_{t+1}-\phi^{-1}\varepsilon_{t+1}\\
  &amp;=-\phi^{-1}\delta+\phi^{-1}(-\phi^{-1}\delta+\phi^{-1}y_{t+2}-\phi^{-1}\varepsilon_{t+2})-\phi^{-1}\varepsilon_{t+1}\\
  &amp;= -\phi^{-1}\delta-\phi^{-2}\delta+\phi^{-2}y_{t+2}-\phi^{-2}\varepsilon_{t+2}-\phi^{-1}\varepsilon_{t+1}\\
  &amp;= -(\phi^{-1}+\phi^{-2})\delta+\phi^{-2}y_{t+2}-\phi^{-1}\varepsilon_{t+1}-\phi^{-2}\varepsilon_{t+2}\\
  &amp;\hspace{2mm}\vdots\\
  &amp;=-\delta\sum_{i=1}^{\infty}\phi^{-i}-\sum_{i=1}^{\infty}\phi^{-i}\varepsilon_{t+i}.
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>Nótese que para <span class="math notranslate nohighlight">\(|\phi|&gt;1\)</span> se tiene que <span class="math notranslate nohighlight">\(|\phi^{-i}|&lt;1\)</span>. Por lo tanto, la solución vía <span class="math notranslate nohighlight">\(AR(1)\)</span> es estacionaria para <span class="math notranslate nohighlight">\(|\phi|&gt;1\)</span>. Sin embargo, <em><strong>la solución dada por la Ecuación</strong></em> <a class="reference internal" href="#equation-noncasual-ar1-proof">(44)</a> <em><strong>involucra futuras perturbaciones</strong></em>, las cuales deseamos predecir, lo cual no es <em>impráctico</em>. Este tipo de modelos son conocidas como, <em><strong>modelos no-causales</strong></em>.</p></li>
</ul>
<ul>
<li><p>Calculemos ahora, la media del <em><strong>proceso estacionario</strong></em> <span class="math notranslate nohighlight">\(AR(1)\)</span>. Nótese que</p>
<div class="math notranslate nohighlight" id="equation-exp-value-ar1-calculus">
<span class="eqno">(45)<a class="headerlink" href="#equation-exp-value-ar1-calculus" title="Link to this equation">#</a></span>\[
  \text{E}(y_{t})=\text{E}(\delta+\phi y_{t-1}+\varepsilon_{t})=\delta+\phi\text{E}(y_{t-1})+\text{E}(\varepsilon_{t})=\delta+\phi\text{E}(y_{t-1})
  \]</div>
</li>
</ul>
<ul>
<li><p>Dado que el proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> es estacionario <span class="math notranslate nohighlight">\(\text{E}(y_{t})=\text{E}(y_{t-1})\)</span>. Entonces, despejando en la Ecuación <a class="reference internal" href="#equation-exp-value-ar1-calculus">(45)</a>, obtenemos que la media del proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> está dada por</p>
<div class="math notranslate nohighlight">
\[
  \text{E}(y_{t})=\frac{\delta}{1-\phi}.
  \]</div>
</li>
</ul>
<ul>
<li><p>Por otro lado, para calcular <em><strong>autocovarianza del proceso</strong></em> <span class="math notranslate nohighlight">\(AR(1)\)</span>, nótese que, gracias a su estacionariedad se tiene que</p>
<div class="math notranslate nohighlight">
\[
  \gamma(0)=\text{Var}(y_{t})=\text{Var}(\delta+\phi y_{t-1}+\varepsilon_{t})=\phi^{2}\text{Var}(y_{t-1})+\sigma^{2}=\phi^{2}\gamma(0)+\sigma^{2}
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Por lo tanto, <span class="math notranslate nohighlight">\(\gamma(0)=\sigma^{2}/(1-\phi^{2})\)</span>. Analicemos la covarianza <span class="math notranslate nohighlight">\(\gamma(k)\)</span>, para algunos pocos valores de rezagos, usando sus propiedades (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Covariance">Covariance</a>), para realizar un razonamiento por inducción. Nótese que para <span class="math notranslate nohighlight">\(k=1, 2,\dots,k\)</span>, dado que el <em><strong>ruido blanco</strong></em> <span class="math notranslate nohighlight">\(\varepsilon_{t+1}\)</span> <em><strong>iid es independiente de</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span>, se tiene que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\gamma(1) &amp;= \text{Cov}(y_{t}, y_{t+1})\\[3mm]
&amp;= \text{Cov}(y_{t}, \delta+\phi y_{t}+\varepsilon_{t+1})\\[3mm]
&amp;= \text{Cov}(y_{t}, \phi y_{t}+\varepsilon_{t+1})\\[3mm]
&amp;= \phi\text{Cov}(y_{t}, y_{t})+\text{Cov}(y_{t}, \varepsilon_{t+1})\\[3mm]
&amp;= \phi\text{Var}(y_{t})\\
&amp;= \phi\frac{\sigma^{2}}{(1-\phi^{2})},\\
\gamma(2) &amp;= \text{Cov}(y_{t}, y_{t+2})\\[3mm]
&amp;= \text{Cov}(y_{t}, \delta+\phi y_{t+1}+\varepsilon_{t+2})\\[3mm]
&amp;= \text{Cov}(y_{t}, \delta+\phi(\delta+\phi y_{t}+\varepsilon_{t+1})+\varepsilon_{t+2})\\[3mm]
&amp;= \text{Cov}(y_{t}, \delta+\phi\delta+\phi^{2}y_{t}+\phi\varepsilon_{t+1}+\varepsilon_{t+2})\\[3mm]
&amp;= \phi^{2}\text{Var}(y_{t})\\
&amp;=\phi^{2}\frac{\sigma^{2}}{(1-\phi^{2})},\\
&amp;\hspace{3mm}\vdots\\
\gamma(k)&amp;=\phi^{k}\frac{\sigma^{2}}{(1-\phi^{2})}.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Además, la <em><strong>función de autocorrelación</strong></em> para el proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> está dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\rho(k)=\frac{\gamma(k)}{\gamma(0)}=\frac{\displaystyle{\phi^{k}\sigma^{2}/(1-\phi^{2})}}{\displaystyle{\sigma^{2}/(1-\phi^{2})}}=\phi^{k},\quad k=0,1,2,\dots
\]</div>
<ul>
<li><p>Por lo tanto, la función de autocorrelación para un proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> <em><strong>tiene forma de decaimiento exponencial</strong></em>. Una realización del siguiente modelo <span class="math notranslate nohighlight">\(AR(1)\)</span>,</p>
<div class="math notranslate nohighlight">
\[
  y_{t}=8+0.8y_{t-1}+\varepsilon_{t}
  \]</div>
<p>se muestra en la siguiente figura:</p>
</li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/37d342b6b3e6d73f7fb8690a804f492c435cb00343dddda7ae1edc21c4a62f8c.png" src="_images/37d342b6b3e6d73f7fb8690a804f492c435cb00343dddda7ae1edc21c4a62f8c.png" />
</div>
</div>
<ul class="simple">
<li><p>Al igual que en el modelo <span class="math notranslate nohighlight">\(MA(1)\)</span> con <span class="math notranslate nohighlight">\(\theta = −0.8\)</span>, podemos observar algunos <em><strong>cortos períodos durante los cuales las observaciones tienden a moverse en dirección ascendente o descendente</strong></em>. A diferencia del modelo <span class="math notranslate nohighlight">\(MA(1)\)</span>, <em><strong>sin embargo, la duración de estos períodos tiende a ser más larga y la tendencia tiende a persistir</strong></em>. Esto también puede observarse en el gráfico de la <em><strong>función de autocorrelación</strong></em> (<code class="docutils literal notranslate"><span class="pre">ACF</span></code>) de la muestra.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.8</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/b3eea8d517d1934c7de652ff0ad8744216e34fedff3aebd9e90ad93eb2ba0db4.png" src="_images/b3eea8d517d1934c7de652ff0ad8744216e34fedff3aebd9e90ad93eb2ba0db4.png" />
</div>
</div>
<ul class="simple">
<li><p>La figura anterior muestra una realización del modelo <span class="math notranslate nohighlight">\(AR(1)\)</span> <span class="math notranslate nohighlight">\(y_{t} = 8 − 0.8y_{t-1} + \varepsilon_{t}\)</span>. Observamos que <em><strong>en lugar de secuencias persistentes, las observaciones exhiben movimientos volatiles hacia arriba/abajo debido al valor negativo de</strong></em> <span class="math notranslate nohighlight">\(\Phi\)</span>.</p></li>
</ul>
</section>
<section id="proceso-autorregresivo-de-segundo-orden-ar-2">
<h2>Proceso autorregresivo de segundo orden, <span class="math notranslate nohighlight">\(AR(2)\)</span><a class="headerlink" href="#proceso-autorregresivo-de-segundo-orden-ar-2" title="Link to this heading">#</a></h2>
<div class="admonition-teorema admonition">
<p class="admonition-title">Teorema</p>
<ul class="simple">
<li><p>La clara extensión de la Ecuación <a class="reference internal" href="#equation-ar1-process-formula">(39)</a> incluye la observación <span class="math notranslate nohighlight">\(y_{t-2}\)</span> y define el <em><strong>proceso autorregresivo de segundo orden</strong></em> <span class="math notranslate nohighlight">\(AR(2)\)</span> como</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-ar2-process-formula">
<span class="eqno">(46)<a class="headerlink" href="#equation-ar2-process-formula" title="Link to this equation">#</a></span>\[
y_{t}=\delta+\phi y_{t-1}+\phi_{2}y_{t-2}+\varepsilon_{t}.
\]</div>
<ul class="simple">
<li><p>Demuestre que el proceso <span class="math notranslate nohighlight">\(AR(2)\)</span> <em><strong>es estacionario si los parámetros</strong></em> <span class="math notranslate nohighlight">\(\phi_{1}, \phi_{2}\)</span> <em><strong>satisfacen</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-stationarity-conditions-ar2">
<span class="eqno">(47)<a class="headerlink" href="#equation-stationarity-conditions-ar2" title="Link to this equation">#</a></span>\[
\phi_{1}+\phi_{2}&lt;1,~\phi_{2}-\phi_{1}&lt;1,~|\phi_{2}|&lt;1.
\]</div>
<ul class="simple">
<li><p>Además,</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-mean-autocovariance-autocorrelation">
<span class="eqno">(48)<a class="headerlink" href="#equation-mean-autocovariance-autocorrelation" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\text{E}(y_{t}) &amp;= \frac{\delta}{1-\phi_{1}-\phi_{2}}\\
\gamma(k) &amp;=\phi_{1}\gamma(k-1)+\phi_{2}\gamma(k-2)+\begin{cases} \sigma^{2} &amp; k=0\\ 0 &amp; k&gt;0\end{cases},~\textsf{Yule-Walker}\\
\rho(k) &amp;= \phi_{1}\rho(k-1)+\phi_{2}\rho(k-2),~k=1,2,\dots,
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Más aún, las raíces de las <em><strong>ecuaciones de Yule-Walker muestran combinación de dos términos: decaimiento exponencial y forma sinusoidal amortiguada</strong></em>.</p></li>
</ul>
</div>
<p><em><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></em></p>
<ul>
<li><p>Nótese que la Ecuación <a class="reference internal" href="#equation-ar2-process-formula">(46)</a> puede reescribirse como</p>
<div class="math notranslate nohighlight">
\[
  y_{t}=\delta+\phi_{1}By_{t}+\phi_{2}B^{2}y_{t}+\varepsilon_{t}\Rightarrow(1-\phi_{1}B-\phi_{2}B^{2})y_{t}=\delta+\varepsilon_{t}\Rightarrow\Phi(B)y_{t}=\delta+\varepsilon_{t}.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Aplicando el operador inverso <span class="math notranslate nohighlight">\(\Phi(B)^{-1}\)</span> en ambos mienbros de la igualdad se tiene</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_{t}=\textcolor{red}{\Phi(B)^{-1}\delta}+\textcolor{red}{\Phi(B)^{-1}}\varepsilon_{t}=\mu+\Psi(B)\varepsilon_{t}=\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i}=\mu+\sum_{i=0}^{\infty}\psi_{i}B^{i}\varepsilon_{t}.
\]</div>
<ul>
<li><p>Dado que <span class="math notranslate nohighlight">\(\Psi(B)=\Phi(B)^{-1}\)</span> entonces <span class="math notranslate nohighlight">\(\Phi(B)\Psi(B)=1\)</span>, esto es</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  (1-\phi_{1}B-\phi_{2}B^{2})(\psi_{0}+\psi_{1}B+\psi_{2}B^{2}+\cdots) &amp;= 1\Leftrightarrow\\
  \psi_{0}+(\psi_{1}-\phi_{1}\psi_{0})B+(\psi_{2}-\phi_{1}\psi_{1}-\phi_{2}\psi_{0})B^{2}+\cdots+(\psi_{j}-\phi_{1}\psi_{j-1}-\phi_{2}\psi_{j-2})B^{j} &amp;= 1\Leftrightarrow
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<div class="math notranslate nohighlight" id="equation-diff-eq-second-order">
<span class="eqno">(49)<a class="headerlink" href="#equation-diff-eq-second-order" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\psi_{0} &amp;= 1\\
\psi_{1}-\phi_{1}\psi_{0} &amp;= 0\\
&amp;\hspace{2mm}\vdots\\
\psi_{j}-\phi_{1}\psi_{j-1}-\phi_{2}\psi_{j-2} &amp;= 0,~j=2,3,\dots,
\end{align*}
\end{split}\]</div>
<div class="dropdown admonition">
<p class="admonition-title">Ecuación en diferencias lineal homogénea de orden <span class="math notranslate nohighlight">\(n\)</span></p>
<ul>
<li><p>Una <em><strong>ecuación en diferencias lineal homogénea de orden</strong></em> <span class="math notranslate nohighlight">\(n\)</span> está dada por</p>
<div class="math notranslate nohighlight" id="equation-homogeneous-difference-equation">
<span class="eqno">(50)<a class="headerlink" href="#equation-homogeneous-difference-equation" title="Link to this equation">#</a></span>\[
    y(t+n)+a_{1}y(t+n-1)+\cdots+a_{n-1}y(t+1)+a_{n}y(t)=0,~\text{con}~a_{i}\in\mathbb{R},
    \]</div>
<p><span class="math notranslate nohighlight">\(\forall i~\text{y}~a_{n}\neq0\)</span>.</p>
</li>
<li><p>A la siguiente ecuación</p>
<div class="math notranslate nohighlight" id="equation-characteristic-equation-ngrade">
<span class="eqno">(51)<a class="headerlink" href="#equation-characteristic-equation-ngrade" title="Link to this equation">#</a></span>\[
    P(r)=m^{n}+a_{1}m^{n-1}+a_{2}m^{n-2}+\cdots+a_{n-1}m+a_{n}=0,
    \]</div>
<p>la llamamos <em><strong>ecuación característica asociada a la ecuación en diferencias lineal homogénea de orden</strong></em> <span class="math notranslate nohighlight">\(n\)</span> <a class="reference internal" href="#equation-homogeneous-difference-equation">(50)</a>.</p>
</li>
</ul>
</div>
<ul>
<li><p>Para encontrar <em><strong>soluciones homogéneas no triviales</strong></em>, asumimos soluciones de la forma <span class="math notranslate nohighlight">\(\psi_{j}=Am^{j},~A,r\in\mathbb{R}\setminus\{0\}\)</span>. Entonces la <em><strong>ecuación característica</strong></em> asociada a la Ecuación <a class="reference internal" href="#equation-diff-eq-second-order">(49)</a> tomaría la forma</p>
<div class="math notranslate nohighlight">
\[
  \psi_{j}-\phi_{1}\psi_{j-1}-\phi_{2}\psi_{j-2}=Am^{j}-\phi_{1}Am^{j-1}-\phi_{2}Am^{j-2}=0\Leftrightarrow m^{2}-\phi_{1}m-\phi_{2}=0.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Las raíces son obtenidas por medio del uso de la fórmula general. Estudiaremos <em><strong>tres casos para sus posibles raíces</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-roots-diff-equations-ar2">
<span class="eqno">(52)<a class="headerlink" href="#equation-roots-diff-equations-ar2" title="Link to this equation">#</a></span>\[
m_{1,2}=\frac{\phi_{1}\pm\sqrt{\phi_{1}^{2}+4\phi_{2}}}{2}
\]</div>
<ul>
<li><p>Nótese que si <span class="math notranslate nohighlight">\(|m_{i}|&lt;1,~i=1,2\)</span> entonces <span class="math notranslate nohighlight">\(\sum_{i=0}^{\infty}|\Psi_{i}|&lt;\infty\)</span>. Por lo tanto, el modelo sería <em><strong>causal estacionario</strong></em>. Además, si las <em><strong>raices de la Ecuación</strong></em> <a class="reference internal" href="#equation-roots-diff-equations-ar2">(52)</a> <em><strong>son complejas</strong></em>, esto es, de la forma <span class="math notranslate nohighlight">\(a+bi,~i=\sqrt{-1}\)</span>, la <em><strong>estacionariedad se tendría si</strong></em></p>
<div class="math notranslate nohighlight">
\[
  |a+bi|=\sqrt{a^{2}+b^{2}}&lt;1
  \]</div>
</li>
</ul>
<ul>
<li><p>Además, bajo estas condiciones <span class="math notranslate nohighlight">\(\{y_{t}\}_{t}\)</span> tendría una representación como <span class="math notranslate nohighlight">\(MA\)</span> infinito. Dado que se tiene <em><strong>estacionariedad si</strong></em> <span class="math notranslate nohighlight">\(|m_{i}|&lt;1,~i=1,2\)</span>, entonces</p>
<div class="math notranslate nohighlight">
\[
  -1&lt;\frac{\phi_{1}\pm\sqrt{\phi_{1}^{2}+4\phi_{2}}}{2}&lt;1\Leftrightarrow-2&lt;\phi_{1}\pm\sqrt{\phi_{1}^{2}+4\phi_{2}}&lt;2.
  \]</div>
</li>
</ul>
<ul>
<li><p>Analicemos el valor más grande de <span class="math notranslate nohighlight">\(m_{i},~i=1,2\)</span>, el cual es acotado por <span class="math notranslate nohighlight">\(\phi_{1}+\sqrt{\phi_{1}^{2}+4\phi_{2}}&lt;2\)</span></p>
<div class="math notranslate nohighlight" id="equation-complex-root-inequality1">
<span class="eqno">(53)<a class="headerlink" href="#equation-complex-root-inequality1" title="Link to this equation">#</a></span>\[\begin{split}
  \begin{align*}
  \phi_{1}+\sqrt{\phi_{1}^{2}+4\phi_{2}}&lt;2 &amp;\Rightarrow \sqrt{\phi_{1}^{2}+4\phi_{2}}&lt;2-\phi_{1}\\
  &amp;\Rightarrow\phi_{1}^{2}+4\phi_{2}&lt;(2-\phi_{1})^{2}\\[1mm]
  &amp;\Rightarrow\phi_{1}^{2}+4\phi_{2}&lt;4-4\phi_{1}+\phi_{1}^{2}\\[2mm]
  &amp;\Rightarrow\textcolor{red}{\phi_{1}+\phi_{2}&lt;1}.
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul>
<li><p>Usando la otra desigualdad <span class="math notranslate nohighlight">\(-2&lt;\phi_{1}\pm\sqrt{\phi_{1}^{2}+4\phi_{2}}\)</span>, se tiene que (<code class="docutils literal notranslate"><span class="pre">verifíquelo</span></code>)</p>
<div class="math notranslate nohighlight" id="equation-complex-root-inequality2">
<span class="eqno">(54)<a class="headerlink" href="#equation-complex-root-inequality2" title="Link to this equation">#</a></span>\[
  \textcolor{red}{\phi_{2}-\phi_{1}&lt;1}.
  \]</div>
</li>
</ul>
<ul>
<li><p>Nótese que si <span class="math notranslate nohighlight">\(m_{i}\)</span> es una <em><strong>raíz compleja</strong></em>, entonces: <span class="math notranslate nohighlight">\(\phi_{1}^{2}+4\phi_{2}&lt;0\Leftrightarrow\phi_{1}^{2}&lt;-4\phi_{2}\)</span>, y además</p>
<div class="math notranslate nohighlight">
\[
  m_{1,2}=\frac{\phi_{1}}{2}\pm\frac{\sqrt{-\left(\phi_{1}^{2}+4\phi_{2}\right)}}{2}i.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Por lo tanto, el <em><strong>módulo complejo</strong></em> está dado por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
|m_{1,2}|=\left(\frac{\phi_{1}}{2}\right)^{2}+\left(\frac{\sqrt{-\left(\phi_{1}^{2}+4\phi_{2}\right)}}{2}\right)^{2}=\frac{1}{4}\phi_{1}^{2}-\frac{1}{4}(\phi_{1}^{2}+4\phi_{2})=-\phi_{2}.
\]</div>
<ul>
<li><p>Entonces, se tiene <em><strong>estabilidad si</strong></em> <span class="math notranslate nohighlight">\(|m_{i}|&lt;1\)</span>, esto es,  si <span class="math notranslate nohighlight">\(-\phi_{2}&lt;1\Rightarrow\phi_{2}&gt;-1\)</span>. Las Ecuaciones <a class="reference internal" href="#equation-complex-root-inequality1">(53)</a>-<a class="reference internal" href="#equation-complex-root-inequality2">(54)</a> entregan vía método de eliminación que <span class="math notranslate nohighlight">\(\phi_{2}&lt;1\)</span>, por lo tanto, <span class="math notranslate nohighlight">\(\textcolor{red}{|\phi_{2}|&lt;1}\)</span>. De esta forma, las <em><strong>condiciones de estacionariedad</strong></em> son las siguientes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \phi_{1}+\phi_{2} &amp;&lt; 1\\
  \phi_{2}-\phi_{1} &amp;&lt; 1\\
  |\phi_{2}| &amp;&lt; 1
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<figure class="align-center" id="complex-roots-ar2-model-fig">
<img alt="_images/complex_roots_ar2_model.png" src="_images/complex_roots_ar2_model.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Funciones típicas de <em><strong>autocorrelación y autocorrelación parcial</strong></em> <span class="math notranslate nohighlight">\(\rho_{k}\)</span> y <span class="math notranslate nohighlight">\(\phi_{kk}\)</span> para varios modelos <span class="math notranslate nohighlight">\(AR(2)\)</span> estacionarios. (Fuente: <span id="id5">[<a class="reference internal" href="biblio.html#id13" title="Casimir Michael Stralkowski. Lower order autoregressive-moving average stochastic models and their use for the characterization of abrasive cutting tools. PhD thesis, University of Wisconsin, 1968.">Stralkowski, 1968</a>]</span>).</span><a class="headerlink" href="#complex-roots-ar2-model-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Procedemos a calcular ahora, <em><strong>media y autocovarianza</strong></em>. Si se satisface la Ecuación <a class="reference internal" href="#equation-stationarity-conditions-ar2">(47)</a>, el proceso <span class="math notranslate nohighlight">\(AR(2)\)</span> <em><strong>es estacionario</strong></em>, y, por lo tanto,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{E}(y_{t}) &amp;= \text{E}(\delta+\phi_{1}y_{t-1}+\phi_{2}y_{t-2}+\varepsilon_{t})\\[2mm]
&amp;= \delta+\phi_{1}\text{E}(y_{t-1})+\phi_{2}\text{E}(y_{t-2})+0\\[2mm]
&amp;= \delta+(\phi_{1}+\phi_{2})\text{E}(y_{t})\Rightarrow\\
\text{E}(y_{t}) &amp;= \frac{\delta}{1-\phi_{1}-\phi_{2}}
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Nótese que si <span class="math notranslate nohighlight">\(1-\phi_{1}-\phi_{2}=0\)</span> entonces <span class="math notranslate nohighlight">\(m=1\)</span> es solución de <span class="math notranslate nohighlight">\(m^{2}-\phi_{1}m-\phi_{2}=0\)</span>, y, por lo tanto, la serie se considera no estacionaria. Calculemos ahora la <em><strong>autocovarianza</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\gamma(k) &amp;= \text{Cov}(y_{t}, y_{t+k})\\[2mm]
&amp;= \text{Cov}(\delta+\phi_{1}y_{t-1}+\phi_{2}y_{t-2}+\varepsilon_{t}, y_{t-k})\\[2mm]
&amp;= \phi_{1}\text{Cov}(y_{t-1}, y_{t-k})+\phi_{2}\text{Cov}(y_{t-2}, y_{t-k})+\text{Cov}(\varepsilon_{t}, y_{t-k})\\
&amp;= \phi_{1}\gamma(k-1)+\phi_{2}\gamma(k-2)+\begin{cases}\sigma^{2}, &amp; k=0\\0, &amp; k&gt;0\end{cases},\quad\textsf{Yule-Walker}.
\end{align*}
\end{split}\]</div>
<ul>
<li><p>Entonces, si <span class="math notranslate nohighlight">\(k=0\)</span>, se tiene que <span class="math notranslate nohighlight">\(\gamma(0)=\phi_{1}\gamma(1)+\phi_{2}\gamma(2)\)</span> (<code class="docutils literal notranslate"><span class="pre">¿por</span> <span class="pre">qué?</span></code>) y además</p>
<div class="math notranslate nohighlight" id="equation-yuli-walker-equation-ar2">
<span class="eqno">(55)<a class="headerlink" href="#equation-yuli-walker-equation-ar2" title="Link to this equation">#</a></span>\[
  \gamma(k)=\phi_{1}\gamma(k-1)+\phi_{2}\gamma(k-2).
  \]</div>
</li>
</ul>
<ul>
<li><p>Las Ecuaciones en <a class="reference internal" href="#equation-yuli-walker-equation-ar2">(55)</a> se llaman las <em><strong>ecuaciones de Yule-Walker</strong></em> para <span class="math notranslate nohighlight">\(\gamma(k)\)</span>. De manera similar, podemos obtener la <em><strong>función de autocorrelación</strong></em> al dividir la Ecuación <a class="reference internal" href="#equation-yuli-walker-equation-ar2">(55)</a> por <span class="math notranslate nohighlight">\(\gamma(0)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-yule-walker-autocorrelation-ar2">
<span class="eqno">(56)<a class="headerlink" href="#equation-yule-walker-autocorrelation-ar2" title="Link to this equation">#</a></span>\[\begin{split}
  \begin{align*}
  \rho(k) &amp;= \frac{\gamma(k)}{\gamma(0)}\\
  &amp;= \phi_{1}\frac{\gamma(k-1)}{\gamma(0)}+\phi_{2}\frac{\gamma(k-2)}{\gamma(0)}\\[2mm]
  &amp;= \phi_{1}\rho(k-1)+\phi_{2}\rho(k-2),~k=1,2,\dots
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>Las <em><strong>ecuaciones de Yule-Walker</strong></em> para <span class="math notranslate nohighlight">\(\rho(k)\)</span> en Ecuación <a class="reference internal" href="#equation-yule-walker-autocorrelation-ar2">(56)</a> pueden ser resueltas de manera iterativa</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-yule-walker-autocorrelation-ar2-rho">
<span class="eqno">(57)<a class="headerlink" href="#equation-yule-walker-autocorrelation-ar2-rho" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
k=1 &amp; \Rightarrow\rho(1)=\phi_{1}\rho(0)+\phi_{2}\rho(-1)=\phi_{1}\cdot1+\phi_{2}\rho(1)\Rightarrow\rho_{1}=\frac{\phi_{1}}{1-\phi_{2}}\\
k=2 &amp; \Rightarrow\rho(2)=\phi_{1}\rho(1)+\phi_{2}\rho(0)=\phi_{1}\left(\frac{\phi_{1}}{1-\phi_{2}}\right)+\phi_{2}=\frac{\phi_{1}^{2}+\phi_{2}(1-\phi_{2})}{1-\phi_{2}}\\
k=3 &amp; \Rightarrow\rho(3)=\phi_{1}\rho(2)+\phi_{2}\rho(1)\\
&amp;\hspace{2mm}\vdots\\
k=j &amp; \Rightarrow\rho(j)=\phi_{1}\rho(j-1)+\phi_{2}\rho(j-2)\\
&amp;\hspace{2mm}\vdots
\end{align*}
\end{split}\]</div>
<ul>
<li><p>Considerando <span class="math notranslate nohighlight">\(\rho(j)=Am^{j},~a, m\in\mathbb{R}\setminus\{0\}\)</span> entonces, la <em><strong>ecuación característica</strong></em> asociada a la Ecuación <a class="reference internal" href="#equation-yule-walker-autocorrelation-ar2-rho">(57)</a> puede ser escrita como</p>
<div class="math notranslate nohighlight">
\[
  Am^{j}=\phi_{1}Am^{j-1}+\phi_{2}Am^{j-2}\Leftrightarrow m^{2}-\phi_{1}m-\phi_{2}=0.
  \]</div>
</li>
</ul>
<div class="dropdown admonition">
<p class="admonition-title">Ecuación característica</p>
<ul>
<li><p>Si <span class="math notranslate nohighlight">\(m_{0}\)</span> es solución de la ecuación característica <a class="reference internal" href="#equation-characteristic-equation-ngrade">(51)</a>, entonces <span class="math notranslate nohighlight">\(y_{t}=Am_{0}^{t}\)</span> es solución de <a class="reference internal" href="#equation-homogeneous-difference-equation">(50)</a></p></li>
<li><p>Al resolver la <em><strong>ecuación característica</strong></em> pueden ocurrir los siguientes casos:</p>
<ol class="arabic simple">
<li><p>La ecuación característica <a class="reference internal" href="#equation-characteristic-equation-ngrade">(51)</a> tiene todas sus raíces reales y simples <span class="math notranslate nohighlight">\(m_{1}, m_{2},\dots, m_{n}\)</span>, entonces</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
    y_{h}(t)=c_{1}m_{1}^{t}+c_{2}m_{2}^{t}+\cdots+c_{n}m_{n}^{t}
    \]</div>
<ol class="arabic simple" start="2">
<li><p>La ecuación característica <a class="reference internal" href="#equation-characteristic-equation-ngrade">(51)</a> tiene todas sus raíces reales: <span class="math notranslate nohighlight">\(m_{1}\)</span> con multiplicidad, <span class="math notranslate nohighlight">\(k\)</span> y <span class="math notranslate nohighlight">\(m_{k+1}, \dots, m_{n}\)</span> simples, entonces</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
    y_{h}(t)=c_{1}m_{1}^{t}+c_{2}tm_{1}^{t}+\cdots+c_{k}t^{k-1}m_{1}^{t}+c_{k+1}t^{k}m_{k+1}^{t}+\cdots+c_{n}m_{n}^{t}.
    \]</div>
<ol class="arabic simple" start="3">
<li><p>La ecuación característica <a class="reference internal" href="#equation-characteristic-equation-ngrade">(51)</a> tiene raíces complejas simples. Si <span class="math notranslate nohighlight">\(m_{1,2}=\alpha\pm\beta i\)</span>, son raices complejas conjugadas, siendo <span class="math notranslate nohighlight">\(\rho=\sqrt{\alpha^{2}+\beta^{2}}\)</span> el módulo y <span class="math notranslate nohighlight">\(\theta=\textsf{arctan}(\beta/\alpha)\)</span> el argumento correspondiente, entonces la solución asociada a las raíces <span class="math notranslate nohighlight">\(m_{1}, m_{2}\)</span> es</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
    y_{h}(t)=\rho^{t}(A\cos(\theta t)+B\sin(\theta t)).
    \]</div>
</li>
</ul>
</div>
<ol class="arabic">
<li><p>Si <span class="math notranslate nohighlight">\(m_{1}, m_{2}\)</span> son <em><strong>raíces reales distintas</strong></em>, tenemos que</p>
<div class="math notranslate nohighlight">
\[
   \rho(k)=c_{1}m_{1}^{k}+c_{2}m_{2}^{k},~k=1,2,\dots
   \]</div>
<p>donde <span class="math notranslate nohighlight">\(c_{1}, c_{2}\)</span> son constantes y pueden ser obtenidas a partir de <span class="math notranslate nohighlight">\(\rho(0), \rho(1)\)</span>. Dado que <span class="math notranslate nohighlight">\(|m_{1,2}|&lt;1\)</span> por estacionariedad, la autocorrelación es una <em><strong>combinación de términos de decrecimiento exponencial</strong></em>.</p>
</li>
</ol>
<ol class="arabic" start="2">
<li><p>Si <span class="math notranslate nohighlight">\(m_{1}, m_{2}\)</span> son <em><strong>raíces complejas conjugadas</strong></em> de la forma <span class="math notranslate nohighlight">\(a\pm bi\)</span> entonces las raíces son de la forma</p>
<div class="math notranslate nohighlight">
\[
   \rho(k)=R^{k}(c_{1}\cos(mk)+c_{2}\sin(mk)),~k=0,1,2,\dots 
   \]</div>
<p>donde <span class="math notranslate nohighlight">\(R=|m_{i}|=\sqrt{a^{2}+b^{2}},~i=1,2\)</span>, y <span class="math notranslate nohighlight">\(\lambda\)</span> es determinado por <span class="math notranslate nohighlight">\(\cos(m)=a/R\)</span> y <span class="math notranslate nohighlight">\(\sin(m)=b/R\)</span>. Por lo tanto, <span class="math notranslate nohighlight">\(a+bi=R(\cos(m)\pm\sin(m)i)\)</span>. Donde <span class="math notranslate nohighlight">\(c_{1}, c_{2}\)</span> son constantes. La función <span class="math notranslate nohighlight">\(ACF\)</span> en este caso tiene la forma de <em><strong>frecuencia senosoidal</strong></em> con factor de frecuencia <span class="math notranslate nohighlight">\(R\)</span> y frecuencia <span class="math notranslate nohighlight">\(m\)</span>. Esto es, periodo <span class="math notranslate nohighlight">\(2\pi/\lambda\)</span>.</p>
</li>
</ol>
<ol class="arabic" start="3">
<li><p>Existe <em><strong>una sola raíz real</strong></em> (<em>raíz doble</em>) <span class="math notranslate nohighlight">\(m_{1}=m_{2}=m_{0}\)</span>, entonces</p>
<div class="math notranslate nohighlight">
\[
   \rho(k)=(c_{1}+c_{2}k)m_{0}^{k},~k=0,1,2,\dots
   \]</div>
<p>En este caso, la <span class="math notranslate nohighlight">\(ACF\)</span> exhibe un <em><strong>patrón de decrecimiento exponencial</strong></em>.</p>
</li>
</ol>
<ul class="simple">
<li><p>En el <em><strong>Caso 1</strong></em>, por ejemplo, <em><strong>un modelo AR(2)</strong></em> puede ser visto como un modelo <em><strong>AR(1) “ajustado”</strong></em> para el cual una única <em><strong>expresión de decaimiento exponencial como en el modelo</strong></em> <span class="math notranslate nohighlight">\(AR(1)\)</span> <em><strong>no es suficiente para describir el patrón en la ACF</strong></em>, y, por lo tanto, una <em><strong>expresión adicional de decaimiento exponencial se “agrega” al introducir el término de retardo de segundo orden</strong></em>, <span class="math notranslate nohighlight">\(y_{t−2}\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>La siguiente figura muestra la realización del proceso <span class="math notranslate nohighlight">\(AR(2)\)</span>: <span class="math notranslate nohighlight">\(y_{t}=4+0.4y_{t-1}+0.5y_{t-2}+\varepsilon_{t}\)</span>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/6d3d2824fac7a85484470de9f3899bdd32a25380d75c91372dd7bb7812c51bb6.png" src="_images/6d3d2824fac7a85484470de9f3899bdd32a25380d75c91372dd7bb7812c51bb6.png" />
</div>
</div>
<ul class="simple">
<li><p>Tenga en cuenta que las <em><strong>raíces</strong></em> del polinomio asociado a este modelo son <em><strong>reales</strong></em>. Por lo tanto, la <em><strong>ACF es una mezcla de dos términos de decaimiento exponencial</strong></em>. De manera similar, la siguiente figura muestra una realización del siguiente proceso <span class="math notranslate nohighlight">\(AR(2)\)</span>: <span class="math notranslate nohighlight">\(y_{t}=4+0.4y_{t-1}-0.5y_{t-2}+\varepsilon_{t}\)</span></p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/3b6e3e3648f0580cae061aa0415404b91644c8a4cf2ed77132b292c07b1f6f40.png" src="_images/3b6e3e3648f0580cae061aa0415404b91644c8a4cf2ed77132b292c07b1f6f40.png" />
</div>
</div>
<ul class="simple">
<li><p>Para este proceso, las <em><strong>raíces del polinomio asociado son complejas conjugadas</strong></em>. Por lo tanto, el gráfico de la función de autocorrelación <em><strong>(ACF) muestra un comportamiento de sinusoides amortiguadas</strong></em>.</p></li>
</ul>
</section>
<section id="proceso-autorregresivo-general-ar-p">
<h2>Proceso autorregresivo general, <span class="math notranslate nohighlight">\(AR(p)\)</span><a class="headerlink" href="#proceso-autorregresivo-general-ar-p" title="Link to this heading">#</a></h2>
<ul>
<li><p>En las dos secciones anteriores, se presenta un <em><strong>modelo</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> <em><strong>general de orden</strong></em> <span class="math notranslate nohighlight">\(p\)</span></p>
<div class="math notranslate nohighlight" id="equation-general-autorregresive-process-arp">
<span class="eqno">(58)<a class="headerlink" href="#equation-general-autorregresive-process-arp" title="Link to this equation">#</a></span>\[
  y_{t}=\delta+\phi_{1}y_{t-1}+\phi_{2}y_{t-2}+\cdots+\phi_{p}y_{t-p}+\varepsilon_{t}
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es <em><strong>ruido blanco</strong></em>.</p>
</li>
</ul>
<ul>
<li><p>Otra representación de la Ecuación <a class="reference internal" href="#equation-general-autorregresive-process-arp">(58)</a> se puede dar como</p>
<div class="math notranslate nohighlight">
\[
  \Phi(B)y_{t}=\delta+\varepsilon_{t}
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\Phi(B)=1-\phi_{1}B-\phi_{2}B^{2}-\cdots-\phi_{p}B^{p}\)</span>.</p>
</li>
</ul>
<ul>
<li><p>La serie temporal <span class="math notranslate nohighlight">\(AR(p)\)</span>, <span class="math notranslate nohighlight">\(\{y_{t}\}\)</span> en la Ecuación <a class="reference internal" href="#equation-general-autorregresive-process-arp">(58)</a> es <em><strong>causal y estacionaria si las raíces del polinomio asociado</strong></em></p>
<div class="math notranslate nohighlight" id="equation-characteristic-equation-arp">
<span class="eqno">(59)<a class="headerlink" href="#equation-characteristic-equation-arp" title="Link to this equation">#</a></span>\[
  m^{p}-\phi_{1}m^{p-1}-\phi_{2}m^{p-2}-\cdots-\phi_{p}=0
  \]</div>
<p><em><strong>son menores que uno, en valor absoluto</strong></em>.</p>
</li>
</ul>
<ul>
<li><p>Además, bajo esta condición, la serie temporal <span class="math notranslate nohighlight">\(\{y_{t}\},~ AR(p)\)</span> también se dice que tiene una <em><strong>representación</strong></em> <span class="math notranslate nohighlight">\(MA\)</span> <em><strong>infinita, absolutamente sumable</strong></em></p>
<div class="math notranslate nohighlight" id="equation-infinite-movingaverage-representation-arp">
<span class="eqno">(60)<a class="headerlink" href="#equation-infinite-movingaverage-representation-arp" title="Link to this equation">#</a></span>\[
  y_{t}=\mu+\Psi(B)\varepsilon_{t}=\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i},
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\Psi(B)=\Phi(B)^{-1}\)</span> con <span class="math notranslate nohighlight">\(\sum_{i=0}^{\infty}|\psi_{i}|&lt;\infty\)</span>.</p>
</li>
</ul>
<ul>
<li><p>Al igual que en <span class="math notranslate nohighlight">\(AR(2)\)</span>, los <em><strong>pesos de los choques aleatorios en la Ecuación</strong></em> <a class="reference internal" href="#equation-infinite-movingaverage-representation-arp">(60)</a> <em><strong>pueden obtenerse de</strong></em> <span class="math notranslate nohighlight">\(\Phi(B)\Psi(B)=1\)</span> como</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \psi_{j} &amp;= 0,~ j&lt;0\\
  \psi_{0} &amp;= 1\\
  \psi_{j}-\phi_{1}\psi_{j-1}-\phi_{2}\psi_{j-2}-\cdots-\phi_{p}\psi_{j-p} &amp;=0~\forall~j=1,2,\dots
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul>
<li><p>Podemos mostrar fácilmente que, para el proceso <span class="math notranslate nohighlight">\(AR(p)\)</span> estacionario</p>
<div class="math notranslate nohighlight">
\[
  \text{E}(y_{t})=\mu=\frac{\delta}{1-\phi_{1}-\phi_{2}-\cdots-\phi_{p}}
  \]</div>
<p>y</p>
<div class="math notranslate nohighlight" id="equation-covariance-autorregresive-arp">
<span class="eqno">(61)<a class="headerlink" href="#equation-covariance-autorregresive-arp" title="Link to this equation">#</a></span>\[\begin{split}
  \begin{align*}
  \gamma(k) &amp;= \text{Cov}(y_{t}, y_{t-k})\\[5mm]
  &amp;= \text{Cov}(\delta+\phi_{1}y_{t-1}+\phi_{2}y_{t-2}+\cdots+\phi_{p}y_{t-p}+\varepsilon_{t}, y_{t-k})\\[2mm]
  &amp;= \sum_{i=1}^{p}\phi_{i}\text{Cov}(y_{t-i}, y_{t-k})+\text{Cov}(\varepsilon_{t}, y_{t-k})\\
  &amp;= \sum_{i=1}^{p}\phi_{i}\gamma(k-i)+\begin{cases}\sigma^{2} &amp; \text{si}~k=0\\0 &amp; \text{si}~k&gt;0\end{cases}
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>Por lo tanto, tenemos</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\gamma(0) &amp;= \sum_{i=1}^{p}\phi_{i}\gamma(i)+\sigma^{2}\Rightarrow\\
\gamma(0)\left[1-\sum_{i=1}^{p}\phi_{i}\rho(i)\right] &amp;= \sigma^{2} 
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Al dividir la Ecuación <a class="reference internal" href="#equation-covariance-autorregresive-arp">(61)</a> por <span class="math notranslate nohighlight">\(\gamma(0)\)</span> para <span class="math notranslate nohighlight">\(k &gt; 0\)</span>, se puede observar que la <em><strong>función de autocorrelación (ACF) de un proceso</strong></em> <span class="math notranslate nohighlight">\(AR(p)\)</span> <em><strong>satisface las ecuaciones de Yule–Walker</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-yule-walker-equation-arp">
<span class="eqno">(62)<a class="headerlink" href="#equation-yule-walker-equation-arp" title="Link to this equation">#</a></span>\[
\rho(k)=\sum_{i=1}^{p}\phi_{i}\rho(k-i),~k=1,2,\dots
\]</div>
<ul>
<li><p>Las Ecuaciones <a class="reference internal" href="#equation-yule-walker-equation-arp">(62)</a> son ecuaciones lineales de orden <span class="math notranslate nohighlight">\(p\)</span>, lo que implica que la <em><strong>función de autocorrelación (ACF) para un modelo</strong></em> <span class="math notranslate nohighlight">\(AR(p)\)</span> se puede encontrar a través de las <span class="math notranslate nohighlight">\(p\)</span> ***raíces del polinomio asociado con la Ecuación <a class="reference internal" href="#equation-characteristic-equation-arp">(59)</a>. Por ejemplo, si todas las <em><strong>raíces son distintas y reales</strong></em>, tenemos</p>
<div class="math notranslate nohighlight">
\[
  \rho(k)=c_{1}m_{1}^{k}+c_{2}m_{2}^{k}+\cdots+c_{p}m_{p}^{k},~k=1,2,\dots
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(c_{1}, c_{2},\dots, c_{p}\)</span> son constantes particulares.</p>
</li>
</ul>
<ul class="simple">
<li><p>Sin embargo, en general, las raíces pueden no ser todas distintas o reales. Por lo tanto, la <em><strong>función de autocorrelación (ACF) de un proceso</strong></em> <span class="math notranslate nohighlight">\(AR(p)\)</span> puede ser una <em><strong>mezcla de expresiones de decaimiento exponencial y de seno amortiguado</strong></em> dependiendo de las raíces de la Ecuación <a class="reference internal" href="#equation-characteristic-equation-arp">(59)</a>.</p></li>
</ul>
</section>
<section id="funcion-de-autocorrelacion-parcial-pacf">
<h2>Función de Autocorrelación Parcial, <span class="math notranslate nohighlight">\(PACF\)</span><a class="headerlink" href="#funcion-de-autocorrelacion-parcial-pacf" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>En la sección anterior vimos que la <em><strong>función de autocorrelación (ACF)</strong></em> es una herramienta excelente para <em><strong>identificar el orden de un proceso</strong></em> <span class="math notranslate nohighlight">\(MA(q)\)</span>, ya que se espera que “corte” después del rezago <span class="math notranslate nohighlight">\(q\)</span>. Sin embargo, en la sección anterior, señalamos que la <span class="math notranslate nohighlight">\(ACF\)</span> <em><strong>no es tan útil en la identificación del orden de un proceso</strong></em> <span class="math notranslate nohighlight">\(AR(p)\)</span>, porque probablemente tendrá una <em><strong>mezcla de expresiones de decaimiento exponencial y de seno amortiguado</strong></em>.</p></li>
<li><p>Por lo tanto, dicho comportamiento, aunque indica que el proceso podría tener una estructura <span class="math notranslate nohighlight">\(AR\)</span>, no proporciona información adicional sobre el orden de dicha estructura. Para ello, definiremos y <em><strong>utilizaremos la función de autocorrelación parcial (PACF) de la serie temporal</strong></em>. Pero antes de eso, discutiremos el concepto de correlación parcial para facilitar la interpretación de la <span class="math notranslate nohighlight">\(PACF\)</span>.</p></li>
</ul>
</div>
<div class="admonition-correlacion-parcial admonition">
<p class="admonition-title">Correlación Parcial</p>
<ul>
<li><p>Consideremos <em><strong>tres variables aleatorias</strong></em> <span class="math notranslate nohighlight">\(X, Y\)</span> y <span class="math notranslate nohighlight">\(Z\)</span>. Luego, tomemos en cuenta la <em><strong>regresión lineal simple de</strong></em> <span class="math notranslate nohighlight">\(X\)</span> <em><strong>sobre</strong></em> <span class="math notranslate nohighlight">\(Z\)</span> y <span class="math notranslate nohighlight">\(Y\)</span> <em><strong>sobre</strong></em> <span class="math notranslate nohighlight">\(Z\)</span> como dos ecuaciones separadas</p>
<div class="math notranslate nohighlight">
\[
    \hat{X}=a_{1}+b_{1}Z~\text{donde}~b_{1}=\frac{\text{Cov}(Z, X)}{\text{Var}(Z)}
    \]</div>
<p>y</p>
<div class="math notranslate nohighlight">
\[
    \hat{Y}=a_{2}+b_{2}Z~\text{donde}~b_{2}=\frac{\text{Cov}(Z, Y)}{\text{Var}(Z)}
    \]</div>
</li>
<li><p>Entonces, los errores pueden obtenerse a partir de</p>
<div class="math notranslate nohighlight">
\[
    X^{\star}=X-\hat{X}=X-(a_{1}+b_{1}Z)
    \]</div>
<p>y</p>
<div class="math notranslate nohighlight">
\[
    Y^{\star}=Y-\hat{Y}=Y-(a_{2}+b_{2}Z)
    \]</div>
</li>
<li><p>Entonces, la <em><strong>correlación parcial entre</strong></em> <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> <em><strong>después de ajustar por</strong></em> <span class="math notranslate nohighlight">\(Z\)</span> <em><strong>se define como la correlación entre</strong></em> <span class="math notranslate nohighlight">\(X^{\star}\)</span> <em><strong>e</strong></em> <span class="math notranslate nohighlight">\(Y^{\star}\)</span>; <span class="math notranslate nohighlight">\(\text{Corr}(X^{\star}, Y^{\star})=\text{Corr}(X-\hat{X}, Y-\hat{Y})\)</span>.</p></li>
<li><p>Es decir, la <em><strong>correlación parcial</strong></em> se puede entender como la <em><strong>correlación entre dos variables después de ser ajustadas por un factor común</strong></em> que puede estar afectándolas. Por supuesto, es posible generalizar esto permitiendo el ajuste por más de un factor.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>La <em><strong>Función de Autocorrelación Parcial (PACF)</strong></em>, siguiendo la definición anterior, entre <span class="math notranslate nohighlight">\(y_{t}\)</span> y <span class="math notranslate nohighlight">\(y_{t−k}\)</span> es la <em><strong>autocorrelación entre</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>y</strong></em> <span class="math notranslate nohighlight">\(y_{t−k}\)</span> <em><strong>después de ajustar por</strong></em> <span class="math notranslate nohighlight">\(y_{t−1}, y_{t−2},\dots, y_{t−k+1}\)</span>. Por lo tanto, para un modelo <span class="math notranslate nohighlight">\(AR(p)\)</span> la <span class="math notranslate nohighlight">\(PACF\)</span> entre <span class="math notranslate nohighlight">\(y_{t}\)</span> y <span class="math notranslate nohighlight">\(y_{t−k}\)</span> para <span class="math notranslate nohighlight">\(k &gt; p\)</span> debería ser igual a cero. Una definición más formal se puede encontrar a continuación.</p></li>
</ul>
<ul class="simple">
<li><p><em><strong><code class="docutils literal notranslate"><span class="pre">Función</span> <span class="pre">de</span> <span class="pre">Autocorrelación</span> <span class="pre">Parcial</span></code></strong></em>: Considera un <em><strong>modelo de series temporales estacionario</strong></em> <span class="math notranslate nohighlight">\(\{yt\}\)</span> que <em><strong>no necesariamente es un proceso AR</strong></em>. Además, considera, para cualquier valor fijo de <span class="math notranslate nohighlight">\(k\)</span>, las <em><strong>ecuaciones de Yule-Walker para la ACF de un proceso</strong></em> <span class="math notranslate nohighlight">\(AR(p)\)</span> dadas en la Ecuación <a class="reference internal" href="#equation-yule-walker-equation-arp">(62)</a> como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\rho(j)=\sum_{i=1}^{k}\phi_{ik}\rho(j-i),~j=1,2,\dots,k
\]</div>
<ul class="simple">
<li><p>Equivalentemente</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-yule-walker-system-arp">
<span class="eqno">(63)<a class="headerlink" href="#equation-yule-walker-system-arp" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\rho(1) &amp;= \phi_{1k}+\phi_{2k}\rho(1)+\cdots+\phi_{kk}\rho(k-1)\\
\rho(2) &amp;= \phi_{1k}\rho(1)+\phi_{2}+\cdots+\phi_{kk}\rho(k-2)\\
&amp;\hspace{2mm}\vdots\\
\rho(k) &amp;= \phi_{1k}\rho(k-1)+\phi_{2k}\rho(k-2)+\cdots+\phi_{kk}
\end{align*}
\end{split}\]</div>
<ul>
<li><p>Estas son las conocidas ecuaciones de Yule-Walker (Yule, 1927; Walker, 1931). Obtenemos <em><strong>estimaciones de los parámetros de Yule-Walker reemplazando las autocorrelaciones teóricas</strong></em> <span class="math notranslate nohighlight">\(ρ_{k}\)</span> por las <em><strong>autocorrelaciones estimadas</strong></em> <span class="math notranslate nohighlight">\(r_{k}\)</span>. Nótese que, si escribimos</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \boldsymbol{\phi}=
    \begin{pmatrix}
    \phi_{1k}\\
    \phi_{2k}\\
    \vdots\\
    \phi_{kk}
    \end{pmatrix},~
    \boldsymbol{\rho}_{k}=
    \begin{pmatrix}
    \rho(1)\\
    \rho(2)\\
    \vdots\\
    \rho(k)
    \end{pmatrix},~
    \boldsymbol{P}_{k}=
    \begin{pmatrix}
    1 &amp; \rho(1) &amp; \rho(2) &amp; \cdots &amp; \rho(k-1)\\
    \rho(1) &amp; 1 &amp; \rho(1) &amp; \cdots &amp; \rho(k-2)\\
    \vdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots\\
    \rho(k-1) &amp; \rho(k-2) &amp; \rho(k-3) &amp; \cdots &amp; 1\\
    \end{pmatrix}
    \end{split}\]</div>
<p>la solución de <a class="reference internal" href="#equation-yule-walker-system-arp">(63)</a> para los parámetros <span class="math notranslate nohighlight">\(\boldsymbol{\phi}\)</span> en términos de las autocorrelaciones pueden ser escritos como</p>
<div class="math notranslate nohighlight">
\[
    \boldsymbol{\phi}=\boldsymbol{P}_{k}^{-1}\boldsymbol{\rho}_{k}.
    \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Para cualquier valor dado de <span class="math notranslate nohighlight">\(k,~k = 1, 2,\dots,\)</span> el último coeficiente <span class="math notranslate nohighlight">\(\phi_{kk}\)</span> se llama la <em><strong>autocorrelación parcial del proceso en el rezago</strong></em> <span class="math notranslate nohighlight">\(k\)</span>. Se observa que para un proceso <span class="math notranslate nohighlight">\(AR(p),~\phi_{kk} = 0\)</span> para <span class="math notranslate nohighlight">\(k&gt;p\)</span>.</p></li>
<li><p>Por lo tanto, decimos que <em><strong>la PACF se corta después del rezago</strong></em> <span class="math notranslate nohighlight">\(p\)</span> para un <span class="math notranslate nohighlight">\(AR(p)\)</span>. Esto sugiere que la <span class="math notranslate nohighlight">\(PACF\)</span> <em><strong>se puede utilizar para identificar el orden de un proceso</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> de manera similar a cómo se puede utilizar la <span class="math notranslate nohighlight">\(ACF\)</span> para un proceso <span class="math notranslate nohighlight">\(MA\)</span>.</p></li>
</ul>
<div class="admonition-autocorrelacion-parcial-muestral-hat-phi-kk admonition">
<p class="admonition-title">Autocorrelación Parcial Muestral <span class="math notranslate nohighlight">\(\hat{\phi}_{kk}\)</span></p>
<ul class="simple">
<li><p>Para cálculos de muestrales, <span class="math notranslate nohighlight">\(\hat{\phi}_{kk}\)</span>, la estimación muestral de <span class="math notranslate nohighlight">\(\phi_{kk}\)</span>, <em><strong>se obtiene utilizando la</strong></em> <span class="math notranslate nohighlight">\(ACF\)</span> <em><strong>muestral</strong></em>, <span class="math notranslate nohighlight">\(r(k)\)</span>. Además, en una muestra de <span class="math notranslate nohighlight">\(N\)</span> observaciones de un proceso <span class="math notranslate nohighlight">\(AR(p), \hat{\phi}_{kk}\)</span> para <span class="math notranslate nohighlight">\(k&gt;p\)</span> está aproximadamente distribuido normalmente con</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}(\hat{\phi}_{kk})\approx 0~\text{y}~\text{Var}(\hat{\phi}_{kk})\approx\frac{1}{N}
\]</div>
<ul class="simple">
<li><p>Por lo tanto, los <em><strong>límites del 95% para juzgar si algún</strong></em> <span class="math notranslate nohighlight">\(\hat{\phi}_{kk}\)</span> es estadísticamente <em><strong>significativamente diferente de cero se dan por</strong></em> <span class="math notranslate nohighlight">\(\pm 2/\sqrt{N}\)</span> <span id="id6">[<a class="reference internal" href="biblio.html#id14" title="Maurice H Quenouille. Approximate tests of correlation in time-series 3. In Mathematical Proceedings of the Cambridge Philosophical Society, volume 45, 483–484. Cambridge University Press, 1949.">Quenouille, 1949</a>, <a class="reference internal" href="biblio.html#id15" title="GM Jenkins and others. Tests of hypotheses in the linear autoregressive model. 1956.">Jenkins and others, 1956</a>, <a class="reference internal" href="biblio.html#id16" title="HE Daniels. The approximate distribution of serial correlation coefficients. Biometrika, 43(1/2):169–185, 1956.">Daniels, 1956</a>]</span>.</p></li>
</ul>
</div>
<ul>
<li><p>Nótese que en la siguiente figura, la cual representa el proceso</p>
<div class="math notranslate nohighlight">
\[
  AR(2):~y_{t}=4+0.8y_{t-1}-0.5y_{t-2}+\varepsilon_{t},
  \]</div>
<p>tenemos la <span class="math notranslate nohighlight">\(PACF\)</span> <em><strong>muestrales de las realizaciones del modelo</strong></em> <span class="math notranslate nohighlight">\(AR(2)\)</span>. Observe que la <span class="math notranslate nohighlight">\(PACF\)</span> <em><strong>muestral se corta después del rezago 2</strong></em>.</p>
</li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/4bbe8ec9b8694d6cea1133e0293736b043fadf9289ae52413f63e7a892bfe0ff.png" src="_images/4bbe8ec9b8694d6cea1133e0293736b043fadf9289ae52413f63e7a892bfe0ff.png" />
</div>
</div>
</section>
<section id="procesos-mixtos-autorregresivos-media-movil">
<h2>Procesos Mixtos Autorregresivos-Media Movil<a class="headerlink" href="#procesos-mixtos-autorregresivos-media-movil" title="Link to this heading">#</a></h2>
<div class="admonition-introduccion admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>Los modelos <em><strong>ARMA (Autoregressive Moving Average)</strong></em> combinan dos componentes principales: el modelo <em><strong>autorregresivo (AR)</strong></em>, que captura la <em><strong>relación lineal entre una observación y un número lineal de observaciones pasadas</strong></em>, y el modelo de <em><strong>media móvil (MA)</strong></em>, que modela la <em><strong>relación lineal entre una observación y los errores de predicción pasados</strong></em>.</p></li>
<li><p>Los modelos <span class="math notranslate nohighlight">\(ARMA\)</span> son ampliamente utilizados en la modelización y <em><strong>predicción de datos temporales</strong></em> en una variedad de campos, incluyendo <em><strong>la economía, las finanzas, la meteorología y la ingeniería</strong></em>, debido a su <em><strong>capacidad para capturar tanto la dependencia temporal como la variabilidad aleatoria</strong></em>.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></p>
<ul>
<li><p>En general, un <em><strong>modelo</strong></em> <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> se define como:</p>
<div class="math notranslate nohighlight" id="equation-arma-process-orderpq">
<span class="eqno">(64)<a class="headerlink" href="#equation-arma-process-orderpq" title="Link to this equation">#</a></span>\[\begin{split}
    \begin{align*}
    y_{t} &amp;= \delta+\phi_{1}y_{t-1}+\phi_{2}y_{t-2}+\cdots+\phi_{p}y_{t-p}+\varepsilon_{t}-\theta_{1}\varepsilon_{t-1}-\theta_{2}\varepsilon_{t-2}-\cdots-\theta_{q}\varepsilon_{t-q}\\
    &amp;= \delta + \sum_{i=1}^{p}\phi_{i}y_{t-i}+\varepsilon_{t}-\sum_{i=1}^{q}\theta_{i}\varepsilon_{t-i}
    \end{align*}
    \end{split}\]</div>
<p>o</p>
<div class="math notranslate nohighlight" id="equation-arma-process-orderpq-phitheta">
<span class="eqno">(65)<a class="headerlink" href="#equation-arma-process-orderpq-phitheta" title="Link to this equation">#</a></span>\[
    \Phi(B)y_{t}=\delta+\Theta(B)\varepsilon_{t}
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es un <em><strong>proceso ruido blanco</strong></em>.</p>
</li>
</ul>
</div>
</section>
<section id="estacionariedad-del-proceso-arma-p-q">
<h2>Estacionariedad del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span><a class="headerlink" href="#estacionariedad-del-proceso-arma-p-q" title="Link to this heading">#</a></h2>
<ul>
<li><p>La <em><strong>estacionariedad de un proceso</strong></em> <span class="math notranslate nohighlight">\(ARMA\)</span> está <em><strong>relacionada con el componente</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> en el modelo y <em><strong>puede verificarse a través de las raíces del polinomio asociado</strong></em></p>
<div class="math notranslate nohighlight" id="equation-characteristic-eq-armapq-process">
<span class="eqno">(66)<a class="headerlink" href="#equation-characteristic-eq-armapq-process" title="Link to this equation">#</a></span>\[
  m^{p}-\phi_{1}m^{p-1}-\phi_{2}m^{p-2}-\cdots-\phi_{p}=0
  \]</div>
</li>
</ul>
<ul>
<li><p>Si todas las <em><strong>raíces de la Ecuación</strong></em> <a class="reference internal" href="#equation-characteristic-eq-armapq-process">(66)</a> <em><strong>son menores que uno en valor absoluto, entonces el</strong></em> <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> <em><strong>es estacionario</strong></em>. Esto también implica que, bajo esta condición, el <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> tiene una <em><strong>representación MA infinita</strong></em> como</p>
<div class="math notranslate nohighlight" id="equation-armapq-ma-infinite-representation">
<span class="eqno">(67)<a class="headerlink" href="#equation-armapq-ma-infinite-representation" title="Link to this equation">#</a></span>\[
  y_{t}=\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{t-i}=\mu+\Psi(B)\varepsilon_{t},
  \]</div>
<p>con <span class="math notranslate nohighlight">\(\Psi(B)=\Phi(B)^{-1}\Phi(B)\)</span>. Los <em><strong>coeficientes en</strong></em> <span class="math notranslate nohighlight">\(\Psi(B)\)</span> pueden ser calculados usando</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \psi_{i}-\phi_{1}\psi_{i-1}-\phi_{2}\psi_{i-2}-\cdots-\phi_{p}\psi_{i-p}=
  \begin{cases}
  -\theta_{i}, &amp; i=1,2,\dots,q\\
  0, &amp; i&gt;q
  \end{cases}
  \end{split}\]</div>
<p>y <span class="math notranslate nohighlight">\(\psi_{0}=1\)</span>.</p>
</li>
</ul>
</section>
<section id="invertibilidad-del-proceso-arma-p-q">
<h2>Invertibilidad del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span><a class="headerlink" href="#invertibilidad-del-proceso-arma-p-q" title="Link to this heading">#</a></h2>
<ul>
<li><p>La <em><strong>invertibilidad de un proceso</strong></em> <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> está relacionada con el <em><strong>componente</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> del modelo y <em><strong>puede verificarse a través de las raíces del polinomio asociado</strong></em></p>
<div class="math notranslate nohighlight">
\[
  m^{q}-\theta_{1}m^{q-1}-\theta_{2}m^{q-2}-\cdots-\theta_{q}=0
  \]</div>
</li>
</ul>
<ul>
<li><p>Si todas las <em><strong>raíces de la Ecuación</strong></em> <a class="reference internal" href="#equation-armapq-ma-infinite-representation">(67)</a> son <em><strong>menores que uno en valor absoluto</strong></em>, entonces se dice que el <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> <em><strong>es invertible y tiene una representación</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> <em><strong>infinita</strong></em></p>
<div class="math notranslate nohighlight">
\[
  \Pi(B)y_{t}= \alpha +\varepsilon_{t}
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\alpha=\Theta(B)^{-1}\delta\)</span> y <span class="math notranslate nohighlight">\(\Pi(B)=\Theta(B)^{-1}\Phi(B)\)</span>. Los coeficientes en <span class="math notranslate nohighlight">\(\Pi(B)\)</span> pueden ser calculados a partir de</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \pi_{i}-\theta_{1}\pi_{i-1}-\theta_{2}\pi_{i-2}-\cdots-\theta_{q}\pi_{i-q}=
  \begin{cases}
  \phi_{i}, &amp; i=1,2,\dots,p\\
  0, &amp; i&gt;p
  \end{cases}
  \end{split}\]</div>
<p>y <span class="math notranslate nohighlight">\(\pi_{0}=-1\)</span>.</p>
</li>
</ul>
<ul>
<li><p>La siguiente figura muestra la <em><strong>ejercitación del proceso</strong></em> <span class="math notranslate nohighlight">\(ARMA(1, 1)\)</span></p>
<div class="math notranslate nohighlight">
\[
  y_{t}=16+0.6y_{t-1}+\varepsilon_{t}+0.8\varepsilon_{t-1}
  \]</div>
</li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/182bc51f035911686f78cfc4cba4972b318da113bb993c4c8fa575888585f73f.png" src="_images/182bc51f035911686f78cfc4cba4972b318da113bb993c4c8fa575888585f73f.png" />
</div>
</div>
<ul class="simple">
<li><p>Nótese que las <em><strong>funciones de autocorrelación y autocorrelación parcial</strong></em> de la muestra exhiben un <em><strong>comportamiento de decaimiento exponencial (a veces en valor absoluto</strong></em> dependiendo de los signos de los coeficientes <span class="math notranslate nohighlight">\(AR\)</span> y <span class="math notranslate nohighlight">\(MA\)</span>), como se muestra en el proceso <span class="math notranslate nohighlight">\(ARMA(1, 1)\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_{t}=16-0.7y_{t-1}+\varepsilon_{t}-0.6\varepsilon_{t-1}
\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">600</span>
<span class="n">arparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.7</span><span class="p">])</span>   <span class="c1"># phi1, phi2,...</span>
<span class="n">maparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.6</span><span class="p">])</span> <span class="c1"># theta1, theta2,...</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">arparams</span><span class="p">]</span> <span class="c1"># add zero-lag and negative</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">maparams</span><span class="p">]</span>  <span class="c1"># add zero-lag</span>

<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/660e24485de64947e4b043b3defcdab2c69e2a7212212f2c646460f1cd300067.png" src="_images/660e24485de64947e4b043b3defcdab2c69e2a7212212f2c646460f1cd300067.png" />
</div>
</div>
</section>
<section id="funciones-de-autocorrelacion-acf-y-autocorrelacion-parcial-pacf-del-proceso-arma-p-q">
<h2>Funciones de autocorrelación (<span class="math notranslate nohighlight">\(ACF\)</span>) y autocorrelación parcial (<span class="math notranslate nohighlight">\(PACF\)</span>) del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span><a class="headerlink" href="#funciones-de-autocorrelacion-acf-y-autocorrelacion-parcial-pacf-del-proceso-arma-p-q" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las <em><strong>funciones de autocorrelación (ACF) y autocorrelación parcial (PACF) de un proceso ARMA son determinadas por las componentes AR y MA</strong></em>, respectivamente. Por lo tanto, tanto la ACF como la PACF de un <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> <em><strong>exhiben patrones de decaimiento exponencial y/o sinusoidales amortiguados</strong></em>, lo que <em>dificulta relativamente la identificación del orden del modelo</em> <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span>.</p></li>
<li><p>Para ello, se pueden utilizar funciones de muestra adicionales como la <em><strong>ACF de muestra extendida (ESACF), la PACF de muestra generalizada (GPACF), la ACF inversa (IACF) y correlaciones canónicas</strong></em> <span id="id7">[<a class="reference internal" href="biblio.html#id17" title="George EP Box, Gwilym M Jenkins, Gregory C Reinsel, and Greta M Ljung. Time series analysis: forecasting and control. John Wiley &amp; Sons, 2015.">Box <em>et al.</em>, 2015</a>, <a class="reference internal" href="biblio.html#id18" title="Wei William and S Wei. Time series analysis: univariate and multivariate methods. USA, Pearson Addison Wesley, Segunda edicion. Cap, 10:212–235, 2006.">William and Wei, 2006</a>, <a class="reference internal" href="biblio.html#id19" title="George C Tiao and George EP Box. Modeling multiple time series with applications. journal of the American Statistical Association, 76(376):802–816, 1981.">Tiao and Box, 1981</a>, <a class="reference internal" href="biblio.html#id20" title="Ruey S Tsay and George C Tiao. Consistent estimates of autoregressive parameters and extended sample autocorrelation function for stationary and nonstationary arma models. Journal of the American Statistical Association, 79(385):84–96, 1984.">Tsay and Tiao, 1984</a>, <a class="reference internal" href="biblio.html#id21" title="Johannes Ledolter and Bovas Abraham. Some comments on the initialization of exponential smoothing. Journal of Forecasting, 3(1):79–84, 1984.">Ledolter and Abraham, 1984</a>]</span>.</p></li>
<li><p>Sin embargo, la <em><strong>disponibilidad de librerías en Python</strong></em> permite al profesional considerar varios modelos con diferentes órdenes y compararlos según los <em><strong>criterios de selección de modelos como AIC, AICC y BIC</strong></em>. Los valores teóricos de la <em><strong>ACF y la PACF para series de tiempo estacionarias se resumen en la siguiente tabla</strong></em>.</p></li>
</ul>
<table class="table" id="table-acf-pacf-arima-process">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Comportamiento de las ACF, PACF teóricas para procesos estacionarios</span><a class="headerlink" href="#table-acf-pacf-arima-process" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head text-center"><p>ACF</p></th>
<th class="head text-center"><p>PACF</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(MA(q)\)</span></p></td>
<td class="text-center"><p>La <span class="math notranslate nohighlight">\(ACF\)</span> se corta después del rezago <span class="math notranslate nohighlight">\(q\)</span></p></td>
<td class="text-center"><p>Decaimiento exponencial y/o sinusoides amortiguadas</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(AR(p)\)</span></p></td>
<td class="text-center"><p>Decaimiento exponencial y/o sinusoides amortiguadas</p></td>
<td class="text-center"><p>La <span class="math notranslate nohighlight">\(PACF\)</span> se corta después del rezago <span class="math notranslate nohighlight">\(p\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></p></td>
<td class="text-center"><p>Decaimiento exponencial y/o sinusoides amortiguadas</p></td>
<td class="text-center"><p>Decaimiento exponencial y/o sinusoides amortiguadas</p></td>
</tr>
</tbody>
</table>
</section>
<section id="procesos-no-estacionarios">
<h2>Procesos No Estacionarios<a class="headerlink" href="#procesos-no-estacionarios" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>A menudo sucede que, aunque los procesos pueden no tener un nivel constante, exhiben un comportamiento homogéneo a lo largo del tiempo. Llamaremos a una serie de tiempo, <span class="math notranslate nohighlight">\(y_{t}\)</span>, <em><strong>no estacionaria homogénea si no es estacionaria, pero su primera diferencia</strong></em>, es decir, <span class="math notranslate nohighlight">\(w_{t} = y_{t} - y_{t-1} = (1 - B)y_{t}\)</span>, o <em><strong>diferencias de orden superior</strong></em>, <span class="math notranslate nohighlight">\(w_{t} = (1 - B)^{d}y_{t}\)</span>, <em><strong>produce una serie de tiempo estacionaria</strong></em>.</p></li>
<li><p>Además, llamaremos a <span class="math notranslate nohighlight">\(y_{t}\)</span> un <em><strong>proceso autoregresivo integrado de media móvil (ARIMA) de órdenes</strong></em> <span class="math notranslate nohighlight">\(p, d\)</span> y <span class="math notranslate nohighlight">\(q\)</span>, es decir, <span class="math notranslate nohighlight">\(ARIMA(p, d, q)\)</span>, si su <span class="math notranslate nohighlight">\(d\)</span><em><strong>-ésima diferencia, denotada por</strong></em> <span class="math notranslate nohighlight">\(w_{t}= (1 - B)^{d}y_{t}\)</span>, <em><strong>produce un proceso</strong></em> <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> <em><strong>estacionario</strong></em>.</p></li>
<li><p>El <em><strong>término “integrado” se utiliza ya que, para</strong></em> <span class="math notranslate nohighlight">\(d = 1\)</span>, por ejemplo, <em><strong>podemos escribir</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>como la suma (o “integral”) del proceso</strong></em> <span class="math notranslate nohighlight">\(w_{t}\)</span> como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
y_{t} &amp;= w_{t}+y_{t-1}\\
&amp;= w_{t}+w_{t-1}+y_{t-2}\\
&amp;= w_{t}+w_{t-1}+\cdots+w_{1}+y_{0}
\end{align*}
\end{split}\]</div>
</div>
<ul>
<li><p>Por lo tanto, un proceso <span class="math notranslate nohighlight">\(ARIMA(p, d, q)\)</span> puede ser escrito como</p>
<div class="math notranslate nohighlight" id="equation-arimapdq-model-phitheta-representation">
<span class="eqno">(68)<a class="headerlink" href="#equation-arimapdq-model-phitheta-representation" title="Link to this equation">#</a></span>\[
  \Phi(B)(1-B)^{d}y_{t}=\delta+\Phi(B)\varepsilon_{t}
  \]</div>
</li>
</ul>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Por lo tanto, <em><strong>una vez que se realiza la diferenciación y se obtiene una serie temporal estacionaria</strong></em> <span class="math notranslate nohighlight">\(w_{t}=(1−B)^{d}y_{t}\)</span>, se pueden <em><strong>usar los métodos proporcionados en las secciones anteriores para obtener el modelo completo</strong></em>.</p></li>
<li><p>En la mayoría de las aplicaciones, <em><strong>la primera diferenciación</strong></em> (<span class="math notranslate nohighlight">\(d = 1\)</span>) y <em><strong>ocasionalmente la segunda diferenciación</strong></em> (<span class="math notranslate nohighlight">\(d = 2\)</span>) <em><strong>serían suficientes para lograr la estacionariedad</strong></em>. Sin embargo, a veces las <em>transformaciones que no sean la diferenciación son útiles para reducir una serie temporal no estacionaria a una estacionaria</em>.</p></li>
<li><p>Por ejemplo, en muchas <em><strong>series temporales económicas</strong></em>, la <em><strong>variabilidad de las observaciones aumenta a medida que aumenta el nivel promedio del proceso</strong></em>; sin embargo, el porcentaje de cambios en las observaciones es relativamente independiente del nivel. Por lo tanto, tomar el <em><strong>logaritmo de la serie original será útil para lograr la estacionariedad</strong></em>.</p></li>
</ul>
</div>
</section>
<section id="construccion-de-modelos-de-series-temporales">
<h2>Construcción de Modelos de Series Temporales<a class="headerlink" href="#construccion-de-modelos-de-series-temporales" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>Se utiliza un <em><strong>procedimiento iterativo de tres pasos para construir un modelo ARIMA</strong></em>. Primero, se <em><strong>identifica un modelo tentativo de la clase ARIMA</strong></em> mediante el análisis de datos históricos. Segundo, <em><strong>se estiman los parámetros desconocidos del modelo</strong></em>. Tercero, <em><strong>a través del análisis de residuos, se realizan controles diagnósticos para determinar la adecuación del modelo o indicar posibles mejoras</strong></em>. Discutiremos cada uno de estos pasos con más detalle.</p></li>
</ul>
</div>
</section>
<section id="identificacion-de-modelos">
<h2>Identificación de modelos<a class="headerlink" href="#identificacion-de-modelos" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><em><strong>Antes de comenzar con esfuerzos rigurosos de construcción de modelos estadísticos</strong></em>, se recomienda el uso de <em><strong>gráficos descriptivos, como los gráficos de series temporales simples y los gráficos de dispersión de los datos de series temporales</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> vs <span class="math notranslate nohighlight">\(y_{t−1}, y_{t−2},\dots,\)</span>.</p></li>
<li><p>Si se <em><strong>sospecha de no estacionariedad</strong></em>, también se debe considerar el <em><strong>gráfico de la primera (o <em><strong><span class="math notranslate nohighlight">\(d\)</span></strong></em>-ésima) diferencia</strong></em>. La prueba de <em><strong>raíz unitaria</strong></em> <span id="id8">[<a class="reference internal" href="biblio.html#id22" title="David A Dickey and Wayne A Fuller. Distribution of the estimators for autoregressive time series with a unit root. Journal of the American statistical association, 74(366a):427–431, 1979.">Dickey and Fuller, 1979</a>]</span> también se puede realizar para asegurarse de que se necesite realmente la diferenciación.</p></li>
<li><p><em><strong>Una vez que se puede asumir la estacionariedad</strong></em> de la serie temporal, se deben <em><strong>obtener la ACF y PACF muestral de la serie temporal original</strong></em> (o su <span class="math notranslate nohighlight">\(d\)</span>-ésima diferencia si es necesario). Dependiendo de la naturaleza de la autocorrelación, <em><strong>las primeras 20–25 autocorrelaciones y autocorrelaciones parciales muestrales deberían ser suficientes</strong></em>.</p></li>
<li><p>La Tabla <a class="reference internal" href="#table-acf-pacf-arima-process"><span class="std std-ref">Comportamiento de las ACF, PACF teóricas para procesos estacionarios</span></a> junto con <em><strong>los límtes</strong></em> <span class="math notranslate nohighlight">\(\pm2/\sqrt{N}\)</span> pueden ser usados como una guía para <em><strong>identificar modelos</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> y <span class="math notranslate nohighlight">\(MA\)</span>. La identificación va a requerir mayor cuidado dado que, <span class="math notranslate nohighlight">\(ACF\)</span> y <span class="math notranslate nohighlight">\(PACF\)</span> van a presentar <em><strong>decaimiento exponencial y comportamiento sinusoidal amortiguado</strong></em>.</p></li>
</ul>
</section>
<section id="estimacion-de-parametros">
<h2>Estimación de parámetros<a class="headerlink" href="#estimacion-de-parametros" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Existen varios métodos, como el <em><strong>método de momentos, método de máxima verosimilitud y mínimos cuadrados</strong></em> que pueden ser utilizados para <em><strong>estimar los parámetros en el posible modelo identificado</strong></em>. Sin embargo, a diferencia de los problemas de regresión, <em><strong>muchos modelos ARIMA son no lineales</strong></em> y van a requerir del uso de <em><strong>procedimientos no lineales para el ajuste de modelos</strong></em>. Debe escoger el modelo mas adecuado ofrecido por la librería utilizada.</p></li>
</ul>
</section>
<section id="diagnostico-checking">
<h2>Diagnostico Checking<a class="headerlink" href="#diagnostico-checking" title="Link to this heading">#</a></h2>
<ul>
<li><p>Despues que un posible modelo ha sido ajustado a los datos, debemos <em><strong>examinar si es adecuado, y si es necesario, sugerir mejoras potenciales</strong></em>. Esto puede ser realizado a traves del <em><strong>análisis de residuales</strong></em>.</p></li>
<li><p>Los residuales para un <em><strong>proceso</strong></em> <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> puden ser <em><strong>obtenidos a partir de</strong></em></p>
<div class="math notranslate nohighlight" id="equation-residual-whitenoise-armapq">
<span class="eqno">(69)<a class="headerlink" href="#equation-residual-whitenoise-armapq" title="Link to this equation">#</a></span>\[
  \hat{\varepsilon}_{t}=y_{t}-\left(\hat{\delta}+\sum_{i=1}^{p}\hat{\phi}_{i}y_{t-i}-\sum_{i=1}^{q}\hat{\theta_{i}}\hat{\varepsilon}_{t-i}\right)
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Si el <em><strong>modelo especificado es adecuado</strong></em>, y por lo tanto los ordenes aproximados <span class="math notranslate nohighlight">\(p\)</span> y <span class="math notranslate nohighlight">\(q\)</span> son identificados, este <em><strong>debería transformar las observaciones a un proceso ruido blanco</strong></em>. Esto es, el comportamiento de los residuales en la Ecuación <a class="reference internal" href="#equation-residual-whitenoise-armapq">(69)</a> debería ser ruido blanco.</p></li>
</ul>
<ul class="simple">
<li><p>Denotemos la <em><strong>función de autocorrelación muestral</strong></em> de los residuales por <span class="math notranslate nohighlight">\(\{r_{e}(k)\}\)</span>. Si el modelo es apropiado, las función de autocorrelación muestral de los residuos no debería tener una estructura a identificar. Esto es, <em><strong>la autocorrelación no debería diferir significativamente de cero para todos los lags mayores que uno</strong></em>. Si conocemos los verdaderos valores de los parámetros y la forma del modelo es correcta, los <em><strong>errores estándar de los residuos de autocorrelación</strong></em> sería <span class="math notranslate nohighlight">\(N^{-1/2}\)</span>.</p></li>
</ul>
<div class="admonition-indicador-chi-cuadrado admonition">
<p class="admonition-title">Indicador chi-cuadrado</p>
<ul>
<li><p>Además de considerar los <em><strong>términos individuales</strong></em> <span class="math notranslate nohighlight">\(r_{e}(k)\)</span>, podemos obtener vía <em><strong>test chi-cuadrado un indicador de si los primeros</strong></em> <span class="math notranslate nohighlight">\(K\)</span> <em><strong>autocorrelaciones residuales</strong></em> unidas, <em><strong>indican que el modelo es adecuado</strong></em>. El tes estadístico es</p>
<div class="math notranslate nohighlight">
\[
    Q=(N-d)\sum_{k=1}^{K}r_{e}^{2}(k)
    \]</div>
<p>la cual es <em><strong>distribuida aproximadamente como chi-cuadrado</strong></em> con <span class="math notranslate nohighlight">\(K-p-q\)</span> grados de libertad <em><strong>si el modelo es apropiado</strong></em>. Si el modelo es inadecuado, <span class="math notranslate nohighlight">\(Q\)</span> excede un punto, en la pequeña cola superior aproximada, de la distribución chi-cuadrado con <span class="math notranslate nohighlight">\(K-p-q\)</span> grados de libertad.</p>
</li>
</ul>
</div>
</section>
<section id="pronostico-con-proceso-arima">
<h2>Pronóstico con proceso ARIMA<a class="headerlink" href="#pronostico-con-proceso-arima" title="Link to this heading">#</a></h2>
<div class="admonition-introduccion admonition">
<p class="admonition-title">Introducción</p>
<ul>
<li><p>Una vez una <em><strong>serie de tiempo apropiada ha sido ajustada</strong></em>, esta púede ser usada para generar <em><strong>pronósticos de futuras observaciones</strong></em>. Si denotamos el tiempo actual por <span class="math notranslate nohighlight">\(T\)</span>, <em><strong>la predicción</strong></em> <span class="math notranslate nohighlight">\(y_{T+\tau}\)</span> es llamada, <em><strong>pronóstico</strong></em> <span class="math notranslate nohighlight">\(\tau\)</span><em><strong>-period-ahead</strong></em> y lo denotamos por <span class="math notranslate nohighlight">\(\hat{y}_{T+\tau}(T)\)</span>.</p></li>
<li><p>El criterio estándar a utilizar para obtener la mejor predicción es el <em><strong>error cuadrático medio</strong></em>, para el que el <em><strong>valor esperado de los errores predichos al cuadrado</strong></em></p>
<div class="math notranslate nohighlight">
\[
    \text{E}[(y_{T+\tau}-\hat{y}_{T+\tau}(T))^{2}]=\text{E}[e_{T}(\tau)^{2}]
    \]</div>
<p><em><strong>es minimizado</strong></em>.</p>
</li>
<li><p>Puede demostrarse que <em><strong>el mejor ponóstico en el sentido cuadrático medio es la esperanza condicional de</strong></em> <span class="math notranslate nohighlight">\(y_{T+\tau}\)</span> dada la actual y previas observaciones, esto es, <span class="math notranslate nohighlight">\(y_{T}, y_{T-1}, y_{T-2},\dots\)</span></p>
<div class="math notranslate nohighlight">
\[
  \hat{y}_{T+\tau}(T)=\text{E}[y_{T+\tau} | y_{T}, y_{T-1},\dots]
  \]</div>
</li>
</ul>
</div>
<ul>
<li><p>Considere por ejemplo un <em><strong>proceso</strong></em> <span class="math notranslate nohighlight">\(ARIMA(p, d, q)\)</span> en el tiempo <span class="math notranslate nohighlight">\(T+\tau\)</span> (i.e <em><strong>periodo</strong></em> <span class="math notranslate nohighlight">\(\tau\)</span> <em><strong>en el futuro</strong></em>)</p>
<div class="math notranslate nohighlight">
\[
  y_{T+\tau}=\delta+\sum_{i=1}^{p+d}\phi_{i}y_{T+\tau-i}+\varepsilon_{T+\tau}-\sum_{i=1}^{q}\theta_{i}\varepsilon_{T+\tau-i}.
  \]</div>
</li>
</ul>
<ul>
<li><p>Además, considere su <em><strong>representación infinita</strong></em> <span class="math notranslate nohighlight">\(MA\)</span></p>
<div class="math notranslate nohighlight" id="equation-ma-infinite-representation-arimapdq">
<span class="eqno">(70)<a class="headerlink" href="#equation-ma-infinite-representation-arimapdq" title="Link to this equation">#</a></span>\[
  y_{T+\tau}=\mu+\sum_{i=0}^{\infty}\psi_{i}\varepsilon_{T+\tau-i}
  \]</div>
</li>
</ul>
<ul>
<li><p>Podemos <em><strong>particionar la Ecuación</strong></em> <a class="reference internal" href="#equation-ma-infinite-representation-arimapdq">(70)</a> como</p>
<div class="math notranslate nohighlight">
\[
  y_{T+\tau}=\mu+\sum_{i=0}^{\tau-1}\psi_{i}\varepsilon_{T+\tau-i}+\sum_{i=\tau}^{\infty}\psi_{i}\varepsilon_{T+\tau-i}
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>En esta partición se puede ver claramente que la componente <span class="math notranslate nohighlight">\(\sum_{i=0}^{\tau-1}\psi_{i}\varepsilon_{T+\tau-i}\)</span> <em><strong>involucra los errores futuros</strong></em>, mientras que la componente <span class="math notranslate nohighlight">\(\sum_{i=\tau}^{\infty}\psi_{i}\varepsilon_{T+\tau-i}\)</span> <em><strong>involucra el error presente y los pasados</strong></em>.</p></li>
</ul>
<ul>
<li><p>Dada la relación entre la actual y pasadas observaciones, y el supuesto de que los random shocks tienen media cero y son independientes, el mejor pronostico en el sentido cuadratico medio es</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \hat{y}_{T+\tau}(T) &amp;= \text{E}[y_{T+\tau} | y_{T}, y_{T-1},\dots]\\[3mm]
  &amp;= \text{E}\left[\mu+\sum_{i=0}^{\tau-1}\psi_{i}\varepsilon_{T+\tau-i}+\sum_{i=\tau}^{\infty}\psi_{i}\varepsilon_{T+\tau-i}\right]\\
  &amp;= \mu+\sum_{i=0}^{\tau-1}\psi_{i}\text{E}[\varepsilon_{T+\tau-i} | y_{T}, y_{T-1},\dots]+\sum_{i=\tau}^{\infty}\psi_{i}\text{E}[\varepsilon_{T+\tau-i} | y_{T}, y_{T-1},\dots]\\[1mm]
  &amp;= \mu+\sum_{i=\tau}^{\infty}\psi_{i}\varepsilon_{T+\tau-i},~\text{E}[\varepsilon_{T+\tau-i} | y_{T}, y_{T-1},\dots]=
  \begin{cases}
  0 &amp; \text{si}~i&lt;\tau\\
  \varepsilon_{T+\tau-i} &amp; \text{si}~i\geq\tau.
  \end{cases}
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul>
<li><p>Seguidamente, el <em><strong>error del pronóstico</strong></em> es calculado a partir de</p>
<div class="math notranslate nohighlight" id="equation-forecasting-error-attau-arimapdq">
<span class="eqno">(71)<a class="headerlink" href="#equation-forecasting-error-attau-arimapdq" title="Link to this equation">#</a></span>\[
  e_{T}(\tau)=y_{T+\tau}-\hat{y}_{T+\tau}(T)=\sum_{i=0}^{\tau-1}\psi_{i}\varepsilon_{T+\tau-i}
  \]</div>
</li>
</ul>
<ul>
<li><p>Dado que el <em><strong>error de pronóstico</strong></em> en la Ecuación <a class="reference internal" href="#equation-forecasting-error-attau-arimapdq">(71)</a> es una <em><strong>combinación lineal de random shocks</strong></em>, tenemos que</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \text{E}[e_{T}(\tau)] &amp;= 0\\
  \text{Var}[e_{T}(\tau)] &amp;= \text{Var}\left[\sum_{i=0}^{\tau-1}\psi_{i}\varepsilon_{T+\tau-i}\right]\\
  &amp;= \sum_{i=0}^{\tau-1}\psi_{i}^{2}\text{Var}(\varepsilon_{T+\tau-i})\\
  &amp;= \sigma^{2}\sum_{i=0}^{\tau-1}\psi_{i}^{2}\\[2mm]
  &amp;= \sigma^{2}(\tau),~\tau=1,2,\dots
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
</section>
<section id="implementacion">
<h2>Implementación<a class="headerlink" href="#implementacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Estudiemos implicaciones de los modelos de componentes <span class="math notranslate nohighlight">\(AR\)</span>. El conjunto de datos <code class="docutils literal notranslate"><span class="pre">AR(1)</span></code> puede ser generado utilizando la función <code class="docutils literal notranslate"><span class="pre">arma_generate_sample</span></code> del módulo <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span> 
<span class="kn">import</span> <span class="nn">statsmodels.tsa.api</span> <span class="k">as</span> <span class="nn">smtsa</span>
<span class="kn">import</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="k">as</span> <span class="nn">arima_model</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">600</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/812d6d11002c366a527569eb49770e2800c86fb4b9906128a1a820549276e0aa.png" src="_images/812d6d11002c366a527569eb49770e2800c86fb4b9906128a1a820549276e0aa.png" />
</div>
</div>
<ul class="simple">
<li><p>El script anterior genera un conjunto de datos para el escenario <span class="math notranslate nohighlight">\(AR(1)\)</span> con <em><strong>correlación serial definida para el retardo anterior como 0.6</strong></em>. <em><strong>El componente</strong></em> <span class="math notranslate nohighlight">\(MA\)</span> <em><strong>se fija en cero para eliminar cualquier efecto de media móvil de la señal de la serie temporal</strong></em>. También entrega la <em><strong>autocorrelación</strong></em> y la <em><strong>autocorrelación parcial</strong></em> de la señal generada.</p></li>
</ul>
<ul class="simple">
<li><p>Considere el siguiente modelo <span class="math notranslate nohighlight">\(y_{t}=\phi_{1}y_{t-1}+\varepsilon_{t}\)</span>. <em><strong>Los datos son simulados usando componentes autoregresivas menores que 1</strong></em>, por lo tanto, <em><strong>la autocorrelación decrecerá sobre el tiempo siguiendo la relación entre</strong></em> <span class="math notranslate nohighlight">\(\phi\)</span> y <span class="math notranslate nohighlight">\(t\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_{t}=\phi y_{t-1}+\varepsilon_{t}=\phi (\phi y_{t-2} + \varepsilon_{t-1})+\varepsilon_{t}=\phi^{2}y_{t-2}+\phi\varepsilon_{t-1}+\varepsilon_{t}=\cdots
\]</div>
<ul class="simple">
<li><p>Por lo tanto, el <em><strong>gráfico ACF decrece exponencialmente y la PACF remueve el efecto de rezago mientras calcula correlación, solo términos significativos son capturados</strong></em>. El valor de <span class="math notranslate nohighlight">\(\boldsymbol{\Phi}\)</span> <em><strong>afecta la estacionariedad de la señal</strong></em>. Por ejemplo, si aumentamos el valor de <span class="math notranslate nohighlight">\(\phi\)</span> de 0.6 a 0.95 en <span class="math notranslate nohighlight">\(AR(1)\)</span>, el modelo tiende a la no estacionariedad, como se muestra en el siguiente ejemplo:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c8b14465cbbfadd2ef74ebb09aae65fb958ad86c43eea052239c45fa05ee3c14.png" src="_images/c8b14465cbbfadd2ef74ebb09aae65fb958ad86c43eea052239c45fa05ee3c14.png" />
</div>
</div>
<ul class="simple">
<li><p>En el escenario en que <span class="math notranslate nohighlight">\(\phi&gt;1\)</span>, <em><strong>el modelo se convierte en no estacionario</strong></em>. Un ejemplo de proceso no estacionario con <span class="math notranslate nohighlight">\(\phi&gt;1\)</span> lo podemos ver a continuación, considerando <span class="math notranslate nohighlight">\(\phi=1.01\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.01</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/53b10abe16a97f2dc0ab7f33bd345ea84e3f3e3b6528efa26b9f06dac72caf06.png" src="_images/53b10abe16a97f2dc0ab7f33bd345ea84e3f3e3b6528efa26b9f06dac72caf06.png" />
</div>
</div>
<ul class="simple">
<li><p>Similarmente, <em><strong>modelos autorregresivos de alto orden</strong></em>, pueden ser generados para validar efecto sobre los componentes de la <em><strong>PACF</strong></em> con el orden. Los conjuntos de datos con componentes <span class="math notranslate nohighlight">\(AR(2)\)</span> y <span class="math notranslate nohighlight">\(AR(3)\)</span> son generados utilizando el siguiente script</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ar2_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar2_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bc119a136487be134fe6c558a0fdff6c5cfc7ed6b263621de1d7cdb21312dc04.png" src="_images/bc119a136487be134fe6c558a0fdff6c5cfc7ed6b263621de1d7cdb21312dc04.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ar3_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar3_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ae87b41972a5cc82bf18de350268f5d2e490373266e71263daf097ea994f6fdf.png" src="_images/ae87b41972a5cc82bf18de350268f5d2e490373266e71263daf097ea994f6fdf.png" />
</div>
</div>
<ul class="simple">
<li><p>Como se puede ver, a partir de diferentes fuentes de datos, la <em><strong>PACF está capturando la componente autorregresiva</strong></em> y <span class="math notranslate nohighlight">\(q\)</span> es el valor donde esta es significante.</p></li>
<li><p>El modelo para <span class="math notranslate nohighlight">\(AR(3)\)</span> puede ser evaluado usando la clase <code class="docutils literal notranslate"><span class="pre">ARIMA.fit</span></code> del modulo de <em><strong>Python</strong></em>, <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.api</span></code> (ver <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.arima.model.ARIMA.html">statsmodels.tsa.arima.model.ARIMA</a>). El modelo <span class="math notranslate nohighlight">\(AR(3)\)</span> sobre los datos generados con <span class="math notranslate nohighlight">\(AR\)</span>, con el actual rezago generado, <em><strong>correlaciones de 0.6, 0.7 y 0.5</strong></em> aproximadamente, los cuales se pueden visualizar en el siguiente <em><strong>resumen</strong></em>, y son parecidos a la relación real obtenida en el ejemplo anterior usando <code class="docutils literal notranslate"><span class="pre">smtsa.arma_generate_sample</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar3</span> <span class="o">=</span> <span class="n">arima_model</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">ar3_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">ar3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>600</td>  
</tr>
<tr>
  <th>Model:</th>            <td>ARIMA(3, 0, 0)</td>  <th>  Log Likelihood     </th> <td>-847.763</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 10 May 2024</td> <th>  AIC                </th> <td>1705.527</td>
</tr>
<tr>
  <th>Time:</th>                <td>21:18:32</td>     <th>  BIC                </th> <td>1727.512</td>
</tr>
<tr>
  <th>Sample:</th>                  <td>0</td>        <th>  HQIC               </th> <td>1714.085</td>
</tr>
<tr>
  <th></th>                      <td> - 600</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>  <td>    0.0028</td> <td>    0.014</td> <td>    0.198</td> <td> 0.843</td> <td>   -0.025</td> <td>    0.030</td>
</tr>
<tr>
  <th>ar.L1</th>  <td>   -0.6479</td> <td>    0.034</td> <td>  -18.891</td> <td> 0.000</td> <td>   -0.715</td> <td>   -0.581</td>
</tr>
<tr>
  <th>ar.L2</th>  <td>   -0.7168</td> <td>    0.030</td> <td>  -23.592</td> <td> 0.000</td> <td>   -0.776</td> <td>   -0.657</td>
</tr>
<tr>
  <th>ar.L3</th>  <td>   -0.5454</td> <td>    0.034</td> <td>  -16.194</td> <td> 0.000</td> <td>   -0.611</td> <td>   -0.479</td>
</tr>
<tr>
  <th>sigma2</th> <td>    0.9852</td> <td>    0.057</td> <td>   17.270</td> <td> 0.000</td> <td>    0.873</td> <td>    1.097</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>0.71</td> <th>  Jarque-Bera (JB):  </th> <td>1.04</td> 
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.40</td> <th>  Prob(JB):          </th> <td>0.59</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.94</td> <th>  Skew:              </th> <td>-0.10</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.68</td> <th>  Kurtosis:          </th> <td>3.00</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">Summary</span> <span class="pre">output</span></code></strong></p>
<ul class="simple">
<li><p>En el presente resumen, <code class="docutils literal notranslate"><span class="pre">Covariance</span> <span class="pre">Type:	opg</span></code> corresponde a la estimación por producto exterior de gradientes <em><strong>Outer-Product-of-Gradients (OPG)</strong></em> para la matriz de covarianza asociada a las estimaciones de coeficientes del modelo.</p></li>
<li><p>El <code class="docutils literal notranslate"><span class="pre">AIC,</span> <span class="pre">BIC,</span> <span class="pre">HQIC</span></code> utilizan la estimación de máxima verosimilitud (<em><strong>Log Likelihood</strong></em>) de un modelo como medida de ajuste. Los valores de <code class="docutils literal notranslate"><span class="pre">AIC,</span> <span class="pre">BIC,</span> <span class="pre">HQIC</span></code> son bajos para los modelos con <em><strong>Log Likelihood</strong></em> altos. Esto significa que el modelo se ajusta mejor a los datos, que es lo que queremos. Por ejemplo <code class="docutils literal notranslate"><span class="pre">AIC</span></code> se define de la siguiente forma: <span class="math notranslate nohighlight">\(AIC=2k-2\ln(L)\)</span>, donde <span class="math notranslate nohighlight">\(k\)</span> es el <em><strong>número de parámetros</strong></em> en el modelo estadístico , y <span class="math notranslate nohighlight">\(L\)</span> es el <em><strong>máximo valor de la función de verosimilitud</strong></em> para el modelo estimado.</p></li>
<li><p>Al ajustar modelos, es posible <em><strong>aumentar la verosimilitud añadiendo parámetros</strong></em>, pero <em><strong>hacerlo puede dar lugar a un sobreajuste</strong></em>. Tanto el <em><strong>BIC como el AIC</strong></em> intentan resolver este problema <em><strong>introduciendo un término de penalización por el número de parámetros del modelo</strong></em>; el término de penalización es mayor en el <code class="docutils literal notranslate"><span class="pre">BIC</span></code> que en el <code class="docutils literal notranslate"><span class="pre">AIC</span></code> para tamaños de muestra superiores a 7. <code class="docutils literal notranslate"><span class="pre">BIC</span></code> esta definido como <span class="math notranslate nohighlight">\(BIC=k\ln(n)-2\ln(L)\)</span>, donde aquí <span class="math notranslate nohighlight">\(n\)</span> representa el tamaño de la muestra. El criterio de información de <em><strong>Hannan–Quinn (HQIC)</strong></em> está dado por <span class="math notranslate nohighlight">\(HQIC=2k\ln(\ln(n))-2\ln(L)\)</span>. Este criterio reduce la penalización de <code class="docutils literal notranslate"><span class="pre">BIC</span></code>, de tal forma que en términos de penalización se ubica entre <code class="docutils literal notranslate"><span class="pre">AIC</span></code> y <code class="docutils literal notranslate"><span class="pre">BIC</span></code>. La selección del criterio va a depender del objetivo principal del investigador.</p></li>
</ul>
<ul class="simple">
<li><p>Los <em><strong>coeficientes del modelo autorregresivo</strong></em> son <code class="docutils literal notranslate"><span class="pre">ar.L1,</span> <span class="pre">ar.L2,</span> <span class="pre">ar.L3</span></code>. El valor de <code class="docutils literal notranslate"><span class="pre">const</span></code> es equivalente al intercepto en modelos de regresión lineal y <code class="docutils literal notranslate"><span class="pre">sigma2</span></code> es la <em><strong>varianza estimada del residuo en el modelo</strong></em>. La columna <code class="docutils literal notranslate"><span class="pre">P&gt;|z|</span></code> corresponde al <span class="math notranslate nohighlight">\(p\)</span>-value. <code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">err</span></code> es el error estándar asociado a cada coeficiente, para los cuales el <em><strong>intervalo de confianza</strong></em> aparece en la última columna <code class="docutils literal notranslate"><span class="pre">[0.025,</span> <span class="pre">0.075]</span></code>.</p></li>
<li><p>Para determinar si la asociación entre la respuesta y cada término del modelo es <em><strong>estadísticamente significativa</strong></em>, comparamos el <span class="math notranslate nohighlight">\(p\)</span>-value del término con su <em><strong>nivel de significancia</strong></em> para evaluar la <em><strong>hipótesis nula</strong></em>. <em><strong>La hipótesis nula es que el término no es significativamente diferente de 0</strong></em>, lo que indica que <em><strong>no existe asociación entre el término y la respuesta</strong></em>. <em><strong>Nótese que los coeficientes: <code class="docutils literal notranslate"><span class="pre">ar.L1,</span> <span class="pre">ar.L2,</span> <span class="pre">ar.L3</span></code>, son estadísticamente significativos.</strong></em> Cuando un coeficiente no es estadísticamente significativo, es posible que desee volver a ajustar el modelo sin el término asociado.</p></li>
</ul>
<ul class="simple">
<li><p>El siguiente paso es <em><strong>determinar si el modelo cumple el supuesto del análisis</strong></em>. Utilizamos el <em><strong>estadístico chi-cuadrado de Ljung-Box (Ljung-Box (L1) (Q))</strong></em>, el <span class="math notranslate nohighlight">\(p\)</span>-value asociado <code class="docutils literal notranslate"><span class="pre">Prob(Q)</span></code> y la <em><strong>función de autocorrelación de los residuos</strong></em> para determinar si el modelo cumple el supuesto de que <em><strong>los residuos son independientes</strong></em>. Si no se cumple el supuesto, <em><strong>es posible que el modelo no se ajuste correctamente a los datos</strong></em> y debe tener cuidado al interpretar los resultados. En este caso la <em><strong>hipótesis nula es que los residuos son independientes o que no hay correlación en los residuales</strong></em>. Nótese que el <span class="math notranslate nohighlight">\(p\)</span>-value es mayor o igual que 0.05, y está representado por <code class="docutils literal notranslate"><span class="pre">Prob(Q)</span></code>.</p></li>
<li><p>Por otro lado <em><strong>Jarque-Bera (JB)</strong></em> es un <em><strong>test de normalidad</strong></em>, en este caso para los residuales. La hipótesis nula a contrastar es que <em><strong>los residuales están normalmente distribuidos</strong></em>. Nótese también que en este caso el <span class="math notranslate nohighlight">\(p\)</span>-value (<code class="docutils literal notranslate"><span class="pre">Prob(JB)</span></code>) es mayor al nivel de significancia. El sesgo y la curtosis <code class="docutils literal notranslate"><span class="pre">Skew,</span> <span class="pre">Kurtosis</span></code> muestran un sesgo negativo en los residuales y una distribución <code class="docutils literal notranslate"><span class="pre">leptocúrtica</span></code> con mayor concentración de los datos en torno a la media.</p></li>
<li><p>El valor <code class="docutils literal notranslate"><span class="pre">Heteroskedasticity</span> <span class="pre">(H)</span></code> es el estadístico asociado con el test de heterocedasticidad de los residuos estandarizados con <span class="math notranslate nohighlight">\(p\)</span>-value <code class="docutils literal notranslate"><span class="pre">Prob(H)</span> <span class="pre">(two-sided)</span></code>. La <em><strong>hipótesis nula es, los residuos no presentan heteroscedasticidad</strong></em>. Nótese que el <span class="math notranslate nohighlight">\(p\)</span>-value es mayor o igual que 0.05, y está representado por <code class="docutils literal notranslate"><span class="pre">Prob(H)</span> <span class="pre">(two-sided)</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar3</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b382af6d8fd6e0be0dd864390c854106a4397a4288e546da6cf6a1d15bc2b601.png" src="_images/b382af6d8fd6e0be0dd864390c854106a4397a4288e546da6cf6a1d15bc2b601.png" />
</div>
</div>
<ul class="simple">
<li><p>Nótese que en la <em><strong>ACF no hay correlaciones significativas</strong></em>, puede concluir que <em><strong>los residuos son independientes</strong></em>. Esto es, ninguna de las correlaciones de la función de autocorrelación de los residuos es significativa. <em><strong>Se puede concluir que el modelo cumple el supuesto de que los residuos son independientes</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>Tanto <span class="math notranslate nohighlight">\(AR\)</span> como <span class="math notranslate nohighlight">\(MA\)</span> pueden utilizarse para corregir la dependencia serial, pero normalmente la <em><strong>autocorrelación positiva se corrige utilizando modelos</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> y la <em><strong>dependencia negativa se corrige utilizando</strong></em> modelos <span class="math notranslate nohighlight">\(MA\)</span>.</p></li>
</ul>
</section>
<section id="modelos-de-media-movil">
<h2>Modelos de media móvil<a class="headerlink" href="#modelos-de-media-movil" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Observación (Cross Validated)</p>
<ul class="simple">
<li><p><em><strong>¿Por qué molestarse en tomar alguna parte de un ruido blanco anterior</strong></em> <span class="math notranslate nohighlight">\(\theta_{1}\varepsilon_{t-1}\)</span> <em><strong>para la estimación del siguiente paso temporal, sabiendo que los términos de ruido blanco no están relacionados a lo largo del tiempo?</strong></em></p></li>
</ul>
<p><em><strong>Ejemplo</strong></em>: <em>Si un huracán azota Houston, va a haber un impacto en las ventas de, digamos, Target. Desde un alto nivel, esto es un gran valor negativo de <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> para esa semana. La semana siguiente, habrá otra innovación semanal, <span class="math notranslate nohighlight">\(\varepsilon_{t+1}\)</span> pero es posible que el efecto del huracán no haya desaparecido del todo en el límite de la semana, por lo que habrá algún efecto de arrastre sobre las ventas, dado por la innovación de la semana anterior</em>.</p>
<ul class="simple">
<li><p><em><strong>¿Por qué la varianza de los términos de innovación se mantiene constante dado que se esperaría que en realidad varíara con el tiempo?</strong></em></p></li>
</ul>
<p><em><strong>Ejemplo</strong></em>: <em>Incluso si varía, mientras no varíe por mucho, probablemente sea mejor simplemente modelarlo como una constante en lugar de tratar de estimarlo como un término variable. Por ejemplo, la demanda minorista de plátanos es bastante estable a lo largo del año, excepto en Navidad, cuando es más baja, pero fluctúa de forma errática semana a semana, a nivel de tienda. No podemos predecir exactamente cuál será la demanda la próxima semana, así que modelamos esa imprecisión como ruido blanco.</em></p>
</div>
<ul class="simple">
<li><p>Para ilustrar un <em><strong>modelo de serie temporal de media móvil</strong></em>, generemos una señal utilizando el siguiente código</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.tsa.api</span> <span class="k">as</span> <span class="nn">smtsa</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Número de muestras</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">600</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Generamos un conjunto de datos para <span class="math notranslate nohighlight">\(MA(1)\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">ma1_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">plotds</span><span class="p">(</span><span class="n">ma1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4cb853e0dc205dfac0b2cd87d85b30eb021cd61467ef7ad05e407455d6f4b026.png" src="_images/4cb853e0dc205dfac0b2cd87d85b30eb021cd61467ef7ad05e407455d6f4b026.png" />
</div>
</div>
<ul class="simple">
<li><p>En el script anterior, <span class="math notranslate nohighlight">\(n\)</span> representa el número de muestras que se generarán con <span class="math notranslate nohighlight">\(AR\)</span> que define el componente autorregresivo y <span class="math notranslate nohighlight">\(MA\)</span> <em><strong>que explica el componente de media móvil de la señal de la serie temporal</strong></em>. Por ahora, mantendremos el impacto de <span class="math notranslate nohighlight">\(AR\)</span> en la señal de la serie temporal como cero. Este script generará un conjunto de datos de series temporales con <em><strong>una dependencia</strong></em> <span class="math notranslate nohighlight">\(MA(1)\)</span> y <em><strong>0.7 de correlación serial con el error</strong></em> y puede ser representado como como sigue:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_{t}=0.7\varepsilon_{t-1}+\varepsilon_{t}
\]</div>
<ul class="simple">
<li><p>Para evaluar si la señal de la serie temporal consta de un componente <span class="math notranslate nohighlight">\(MA\)</span> o <span class="math notranslate nohighlight">\(AR\)</span>, se utiliza la <em><strong>autocorrelación (ACF)</strong></em> y la <em><strong>autocorrelación parcial (PACF)</strong></em> respectivamente.</p></li>
</ul>
<ul class="simple">
<li><p>El <code class="docutils literal notranslate"><span class="pre">ACF</span></code> del conjunto de datos anterior muestra una <em><strong>dependencia de 1 rezago</strong></em>. Como la relación <span class="math notranslate nohighlight">\(MA\)</span> es capturada usando <span class="math notranslate nohighlight">\(y_{t} = \theta\varepsilon_{t-1} + \varepsilon_{t}\)</span>, que es <em><strong>independiente de los términos de rezago</strong></em>, el <em><strong>ACF tiende a capturar el orden</strong></em> <span class="math notranslate nohighlight">\(q\)</span> apropiado de la serie <span class="math notranslate nohighlight">\(MA\)</span>.</p></li>
<li><p>Como puede observarse en la siguiente siguiente figura, la <em><strong>ACF no llega a cero después del orden definido, sino que se reduce a un valor pequeño</strong></em>. El intervalo de confianza se comprueba utilizando la relación <span class="math notranslate nohighlight">\(\pm 2/\sqrt{N}\)</span>, donde <span class="math notranslate nohighlight">\(1/\sqrt{N}\)</span> <em><strong>representan una aproximación de la desviación estándar</strong></em>, que se cumple bajo la condición de independencia.</p></li>
</ul>
<ul class="simple">
<li><p>Veamos el impacto del componente <span class="math notranslate nohighlight">\(MA\)</span> de <code class="docutils literal notranslate"><span class="pre">ACF</span></code> y <code class="docutils literal notranslate"><span class="pre">PACF</span></code> con un orden mayor de <span class="math notranslate nohighlight">\(q\)</span> utilizando el siguiente script, el cual generará <em><strong>series de tiempo de medias moviles de ordenes</strong></em> <span class="math notranslate nohighlight">\(MA(2)\)</span> y <span class="math notranslate nohighlight">\(MA(3)\)</span> sin impacto del componente autorregresivo. Además se generan, las funciones <code class="docutils literal notranslate"><span class="pre">ACF</span></code> y <code class="docutils literal notranslate"><span class="pre">PACF</span></code>, como en los anteriores ejemplos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">ma2_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">plotds</span><span class="p">(</span><span class="n">ma2_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9a9beabe2bdd7d6c7ba31f0209cee35daa8ab1e1db62e7d7167eba05be51184c.png" src="_images/9a9beabe2bdd7d6c7ba31f0209cee35daa8ab1e1db62e7d7167eba05be51184c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">ma3_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">plotds</span><span class="p">(</span><span class="n">ma3_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7f0ec063947bec4a3c4dcce89fcb705c1702372ded82aa0d812677a9bb6b18d8.png" src="_images/7f0ec063947bec4a3c4dcce89fcb705c1702372ded82aa0d812677a9bb6b18d8.png" />
</div>
</div>
<ul class="simple">
<li><p><em><strong>Normalmente, la ACF define bien la correlación serial del error y, por tanto, se utiliza para detectar</strong></em> <span class="math notranslate nohighlight">\(MA(q)\)</span>; sin embargo, a medida que aumenta el orden y entran en escena otros componentes de la serie temporal, como la estacionalidad, tendencia o estacionariedad, la interpretación se complica. El <span class="math notranslate nohighlight">\(MA(q)\)</span> <em><strong>supone que el proceso es estacionario y que el error es un ruido blanco para garantizar una estimación insesgada</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>Se puede construir un modelo <span class="math notranslate nohighlight">\(MA(q)\)</span> utilizando la función <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> del módulo <code class="docutils literal notranslate"><span class="pre">statsmodel.tsa</span></code>. Nótese que <em><strong>usamos siempre cero en la segunda componente de la función ARIMA</strong></em>, en la siguiente sección explicaremos el por qué de esto, al introducir el concepto de <em><strong>diferenciación</strong></em>. Un script de ejemplo para ajustar un modelo <span class="math notranslate nohighlight">\(MA(1)\)</span> es el siguiente</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma1</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">ma1_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Como el orden de <span class="math notranslate nohighlight">\(AR\)</span> se mantiene en cero, <code class="docutils literal notranslate"><span class="pre">smtsa.ARIMA</span></code> construye un <span class="math notranslate nohighlight">\(MA(1)\)</span>. El resumen del modelo devuelto por <code class="docutils literal notranslate"><span class="pre">smtsa.ARMA</span></code> se muestra aquí</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>600</td>  
</tr>
<tr>
  <th>Model:</th>            <td>ARIMA(0, 0, 1)</td>  <th>  Log Likelihood     </th> <td>-842.209</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 10 May 2024</td> <th>  AIC                </th> <td>1690.418</td>
</tr>
<tr>
  <th>Time:</th>                <td>21:18:34</td>     <th>  BIC                </th> <td>1703.609</td>
</tr>
<tr>
  <th>Sample:</th>                  <td>0</td>        <th>  HQIC               </th> <td>1695.553</td>
</tr>
<tr>
  <th></th>                      <td> - 600</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>  <td>    0.0114</td> <td>    0.067</td> <td>    0.170</td> <td> 0.865</td> <td>   -0.121</td> <td>    0.143</td>
</tr>
<tr>
  <th>ma.L1</th>  <td>    0.6789</td> <td>    0.031</td> <td>   22.252</td> <td> 0.000</td> <td>    0.619</td> <td>    0.739</td>
</tr>
<tr>
  <th>sigma2</th> <td>    0.9689</td> <td>    0.055</td> <td>   17.504</td> <td> 0.000</td> <td>    0.860</td> <td>    1.077</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>0.18</td> <th>  Jarque-Bera (JB):  </th> <td>0.40</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.67</td> <th>  Prob(JB):          </th> <td>0.82</td>
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.92</td> <th>  Skew:              </th> <td>0.06</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.54</td> <th>  Kurtosis:          </th> <td>3.05</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<ul class="simple">
<li><p><em><strong>Queda como ejercicio para el estudiante interpretar cada summary() basado en el análisis realizado para los modelos AR</strong></em>. Como puede verse, el modelo ha captado una <em><strong>correlación entre los residuos, que es bastante cercano al valor simulado de 0.7</strong></em>. Del mismo modo, ejecutamos el modelo para el conjunto de datos <span class="math notranslate nohighlight">\(MA(3)\)</span> y el resultado se muestra a continuación</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma3</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">ma3_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>600</td>  
</tr>
<tr>
  <th>Model:</th>            <td>ARIMA(0, 0, 3)</td>  <th>  Log Likelihood     </th> <td>-852.803</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 10 May 2024</td> <th>  AIC                </th> <td>1715.606</td>
</tr>
<tr>
  <th>Time:</th>                <td>21:18:34</td>     <th>  BIC                </th> <td>1737.591</td>
</tr>
<tr>
  <th>Sample:</th>                  <td>0</td>        <th>  HQIC               </th> <td>1724.165</td>
</tr>
<tr>
  <th></th>                      <td> - 600</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>  <td>    0.0530</td> <td>    0.119</td> <td>    0.445</td> <td> 0.656</td> <td>   -0.180</td> <td>    0.286</td>
</tr>
<tr>
  <th>ma.L1</th>  <td>    0.6478</td> <td>    0.038</td> <td>   16.834</td> <td> 0.000</td> <td>    0.572</td> <td>    0.723</td>
</tr>
<tr>
  <th>ma.L2</th>  <td>    0.6936</td> <td>    0.034</td> <td>   20.646</td> <td> 0.000</td> <td>    0.628</td> <td>    0.759</td>
</tr>
<tr>
  <th>ma.L3</th>  <td>    0.5455</td> <td>    0.038</td> <td>   14.367</td> <td> 0.000</td> <td>    0.471</td> <td>    0.620</td>
</tr>
<tr>
  <th>sigma2</th> <td>    1.0020</td> <td>    0.058</td> <td>   17.254</td> <td> 0.000</td> <td>    0.888</td> <td>    1.116</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>0.01</td> <th>  Jarque-Bera (JB):  </th> <td>0.52</td> 
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.93</td> <th>  Prob(JB):          </th> <td>0.77</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.93</td> <th>  Skew:              </th> <td>-0.07</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.63</td> <th>  Kurtosis:          </th> <td>3.01</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<ul class="simple">
<li><p>Nótese también que <em><strong>el modelo ha captado correlaciones entre los residuos, que están bastante cercanas a los valores simulados 0.6, 0.7 y 0.5</strong></em>.</p></li>
</ul>
</section>
<section id="creacion-de-conjuntos-de-datos-con-arima">
<h2>Creación de conjuntos de datos con ARIMA<a class="headerlink" href="#creacion-de-conjuntos-de-datos-con-arima" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las dos secciones anteriores describen el modelo autorregresivo <span class="math notranslate nohighlight">\(AR(p)\)</span>, que realiza una <em><strong>regresión sobre sus propios términos rezagados</strong></em> y el modelo de media móvil <span class="math notranslate nohighlight">\(MA(q)\)</span> construye una <em><strong>función en términos de errores pasados</strong></em>. Los modelos <span class="math notranslate nohighlight">\(AR(p)\)</span> tienden a <em><strong>captar el efecto de reversión a la media (mean reversion)</strong></em>, mientras que los modelos <span class="math notranslate nohighlight">\(MA(q)\)</span> <em><strong>tienden a captar el efecto de choque en el error</strong></em>, que no son normales o imprevistos. <em>La reversión a la media es un término financiero para la suposición de que el precio de un activo tenderá a converger al precio promedio a lo largo del tiempo</em>. Así pues, <em><strong>el modelo</strong></em> <span class="math notranslate nohighlight">\(ARMA\)</span> <em><strong>combina la potencia de los componentes</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> <em><strong>y</strong></em> <span class="math notranslate nohighlight">\(MA\)</span>. Un modelo de previsión de series temporales <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span> incorpora el modelo <span class="math notranslate nohighlight">\(AR\)</span> de orden <span class="math notranslate nohighlight">\(p\)</span> y el modelo <span class="math notranslate nohighlight">\(MA\)</span> de orden <span class="math notranslate nohighlight">\(q\)</span>, respectivamente.</p></li>
</ul>
<ul class="simple">
<li><p>Vamos a generar un conjunto de datos <span class="math notranslate nohighlight">\(ARMA(1,1)\)</span> actualizando el script utilizado anteriormente con componentes <code class="docutils literal notranslate"><span class="pre">AR</span></code> y <code class="docutils literal notranslate"><span class="pre">MA</span></code> actualizados. También restringiremos el número de muestras a 600 para simplificar:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="n">ar1ma1_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1ma1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b295a9f8552f2d995034b25438a2f3e952c810d48301d12ff2b2f76cb35820fb.png" src="_images/b295a9f8552f2d995034b25438a2f3e952c810d48301d12ff2b2f76cb35820fb.png" />
</div>
</div>
<ul class="simple">
<li><p>Podemos utilizar el test de <em><strong>Dickey Fuller</strong></em>, considerando como hipótesis nula <span class="math notranslate nohighlight">\(H_{0}\)</span>: <em><strong>la serie de tiempo no es estacionaria</strong></em>. Como es usual, este tipo de tests entrega un <span class="math notranslate nohighlight">\(p\)</span>-value en el cual basamos la decisión de aceptar o rechazar la hipótesis inicial, con una significancia <span class="math notranslate nohighlight">\(\alpha\)</span> de 0.05. Esto puede ser llevado a cabo usando la función <code class="docutils literal notranslate"><span class="pre">adfuller()</span></code> de <code class="docutils literal notranslate"><span class="pre">stattools</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">stattools</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">ar1ma1_data</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value of the ADF test in air miles flown:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-value of the ADF test in air miles flown: 4.8966479611062833e-29
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La palabra clave argumento <code class="docutils literal notranslate"><span class="pre">autolag='AIC'</span></code> indica a la función que <em><strong>el número de rezagos se elija para minimizar el criterio de información correspondiente</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>Los <em><strong>procesos de ventas</strong></em> en general siguen un modelo <span class="math notranslate nohighlight">\(ARMA(1,1)\)</span>, ya que las ventas en el tiempo <span class="math notranslate nohighlight">\(t\)</span> son función de las ventas anteriores que se produjeron en el tiempo <span class="math notranslate nohighlight">\(t-1\)</span>, que interviene en el componente <span class="math notranslate nohighlight">\(AR\)</span>. El componente <span class="math notranslate nohighlight">\(MA\)</span> de <span class="math notranslate nohighlight">\(ARMA(1,1)\)</span> se debe a las <em><strong>campañas temporales lanzadas por la empresa</strong></em>, como la distribución de cupones. La distribución de cupones, por ejemplo, <em><strong>provocará un efecto de media móvil en el proceso</strong></em>. Las ventas aumentan temporalmente y el cambio en el efecto de las ventas es captado por el componente de media móvil. En la figura anterior, tanto <code class="docutils literal notranslate"><span class="pre">ACF</span></code> como <code class="docutils literal notranslate"><span class="pre">PACF</span></code> muestran una curva senoidal con una fuerte correlación en los rezagos iniciales; por lo tanto, los parámetros <span class="math notranslate nohighlight">\(p\)</span> como <span class="math notranslate nohighlight">\(q\)</span> están presentes. <em><strong>Existen múltiples escenarios para seleccionar</strong></em> <span class="math notranslate nohighlight">\(p\)</span> <em><strong>y</strong></em> <span class="math notranslate nohighlight">\(q\)</span>; algunas de las reglas generales que pueden utilizarse para determinar el orden de los componentes <span class="math notranslate nohighlight">\(ARMA\)</span> son las siguientes:</p>
<ul>
<li><p>La autocorrelación es exponencialmente decreciente y <code class="docutils literal notranslate"><span class="pre">PACF</span></code> tiene una correlación significativa en el retardo 1, utilice el parámetro <span class="math notranslate nohighlight">\(p\)</span></p></li>
<li><p>La autocorrelación forma una onda senoidal y <code class="docutils literal notranslate"><span class="pre">PACF</span></code> tiene una correlación significativa en los retardos 1 y 2, entonces utilice el valor de segundo orden para <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
<li><p>La autocorrelación  muestra una correlación en serie significativa y la <code class="docutils literal notranslate"><span class="pre">PACF</span></code> tiene decaimiento exponencial, entonces hay media móvil y es necesario establecer el parámetro <span class="math notranslate nohighlight">\(q\)</span></p></li>
<li><p>La autocorrelación muestra una correlación en serie significativa y la <code class="docutils literal notranslate"><span class="pre">PACF</span></code> muestra un patrón de onda senoidal, se debe establecer un parámetro <span class="math notranslate nohighlight">\(q\)</span> de media móvil.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>En los datos de series temporales <span class="math notranslate nohighlight">\(ARMA(1,1)\)</span>, tanto <code class="docutils literal notranslate"><span class="pre">ACF</span></code> como <code class="docutils literal notranslate"><span class="pre">PACF</span></code> han mostrado un <em><strong>patrón de onda senoidal</strong></em>, <span class="math notranslate nohighlight">\(p\)</span> y <span class="math notranslate nohighlight">\(q\)</span> afectan a la señal de la serie temporal. El impacto de los retardos puede puede calcularse mediante la curva impulso-respuesta (ver <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.arima_process.arma_impulse_response.html">statsmodels.tsa.arima_process.arma_impulse_response</a>), como se muestra en la siguiente figura, para la señal de serie temporal <span class="math notranslate nohighlight">\(ARMA(1,1)\)</span>. <em><strong>La figura muestra que, tras cinco retardos, el efecto sobre la respuesta es mínimo</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">arima_process</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_impulse_response</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">leads</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Impact&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e7dc0c1db40fa91814a24c547babfa2b2916c1dc3d448a8a48f458a1b5fafe95.png" src="_images/e7dc0c1db40fa91814a24c547babfa2b2916c1dc3d448a8a48f458a1b5fafe95.png" />
</div>
</div>
<ul class="simple">
<li><p>Para evaluar los valores <code class="docutils literal notranslate"><span class="pre">AR</span></code> y <code class="docutils literal notranslate"><span class="pre">MA</span></code> de los datos, se utiliza la función <code class="docutils literal notranslate"><span class="pre">ARIMA.fit()</span></code> del módulo <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.api</span></code>, como se muestra en el siguiente script:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar1ma1</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">ar1ma1_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">ar1ma1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>600</td>  
</tr>
<tr>
  <th>Model:</th>            <td>ARIMA(1, 0, 1)</td>  <th>  Log Likelihood     </th> <td>-826.795</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 10 May 2024</td> <th>  AIC                </th> <td>1661.590</td>
</tr>
<tr>
  <th>Time:</th>                <td>21:18:34</td>     <th>  BIC                </th> <td>1679.178</td>
</tr>
<tr>
  <th>Sample:</th>                  <td>0</td>        <th>  HQIC               </th> <td>1668.436</td>
</tr>
<tr>
  <th></th>                      <td> - 600</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>  <td>   -0.0224</td> <td>    0.032</td> <td>   -0.700</td> <td> 0.484</td> <td>   -0.085</td> <td>    0.040</td>
</tr>
<tr>
  <th>ar.L1</th>  <td>   -0.6278</td> <td>    0.084</td> <td>   -7.518</td> <td> 0.000</td> <td>   -0.791</td> <td>   -0.464</td>
</tr>
<tr>
  <th>ma.L1</th>  <td>    0.3226</td> <td>    0.102</td> <td>    3.164</td> <td> 0.002</td> <td>    0.123</td> <td>    0.522</td>
</tr>
<tr>
  <th>sigma2</th> <td>    0.9211</td> <td>    0.054</td> <td>   17.164</td> <td> 0.000</td> <td>    0.816</td> <td>    1.026</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>0.03</td> <th>  Jarque-Bera (JB):  </th> <td>0.05</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.87</td> <th>  Prob(JB):          </th> <td>0.98</td>
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>1.02</td> <th>  Skew:              </th> <td>0.02</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.88</td> <th>  Kurtosis:          </th> <td>2.97</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<ul class="simple">
<li><p>El resultado del modelo muestra <em><strong>valores del coeficientes</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> y <span class="math notranslate nohighlight">\(MA\)</span> <em><strong>cercanos de los valores 0.6 y 0.3</strong></em> utilizados por el componente <span class="math notranslate nohighlight">\(AR\)</span> y <span class="math notranslate nohighlight">\(MA\)</span>, respectivamente, para generar la señal de la serie temporal. Asimismo, el <em><strong>Criterio de información de Akaike (AIC)</strong></em> lo usamos como criterio para <em><strong>establecer una evaluación para las órdenes</strong></em> <span class="math notranslate nohighlight">\(p\)</span> y <span class="math notranslate nohighlight">\(q\)</span>. Una ilustración de la minimización del <span class="math notranslate nohighlight">\(AIC\)</span> en el conjunto de datos <span class="math notranslate nohighlight">\(ARMA(1,1)\)</span> se muestra a continuación:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aicVal</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">ari</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">maj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">arma_obj</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">ar1ma1_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">ari</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maj</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">aicVal</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ari</span><span class="p">,</span> <span class="n">maj</span><span class="p">,</span> <span class="n">arma_obj</span><span class="o">.</span><span class="n">aic</span><span class="p">])</span>

<span class="n">dfAIC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">aicVal</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AR(p)&#39;</span><span class="p">,</span> <span class="s1">&#39;MA(q)&#39;</span><span class="p">,</span> <span class="s1">&#39;AIC&#39;</span><span class="p">])</span>
<span class="n">dfAIC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AR(p)</th>
      <th>MA(q)</th>
      <th>AIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1661.589913</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1663.118934</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>1663.291217</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>2</td>
      <td>1663.488211</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>La tabla anterior muestra que <span class="math notranslate nohighlight">\(ARMA(2, 1)\)</span> es el modelo más óptimo con un valor <span class="math notranslate nohighlight">\(AIC\)</span> mínimo; por lo tanto, se preferirá <span class="math notranslate nohighlight">\(ARMA(2, 1)\)</span> a otros modelos. Ilustremos un modelo <span class="math notranslate nohighlight">\(ARMA\)</span> utilizando datos de series en tiempo real. El conjunto de datos seleccionado para la siguiente ilustración, corresponde a los <em><strong>precios de las acciones de IBM de 1962 a 1965</strong></em>. El primer paso consiste en cargar los módulos y el conjunto de datos en el entorno <code class="docutils literal notranslate"><span class="pre">Python</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ibm_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/ibm-common-stock-closing-prices.csv&#39;</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;IBM common stock closing prices&#39;</span><span class="p">:</span> <span class="s1">&#39;Close_Price&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="o">=</span><span class="n">ibm_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">ibm_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Close_Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1962-01-02</td>
      <td>572.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1962-01-03</td>
      <td>577.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962-01-04</td>
      <td>571.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1962-01-05</td>
      <td>560.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1962-01-08</td>
      <td>549.50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>El script anterior utiliza <code class="docutils literal notranslate"><span class="pre">pandas</span></code> para cargar el conjunto de datos. Los nombres de las columnas se renombran utilizando la función <code class="docutils literal notranslate"><span class="pre">rename</span></code> soportada por <code class="docutils literal notranslate"><span class="pre">pandas</span> <span class="pre">DataFrame</span></code>. El conjunto de datos tiene el siguiente aspecto:</p></li>
</ul>
<ul class="simple">
<li><p>El gráfico <em><strong>IBM muestra una tendencia significativa de los datos a lo largo del tiempo</strong></em>. El siguiente paso en el proceso es observar los gráficos de <code class="docutils literal notranslate"><span class="pre">ACF</span></code> y <code class="docutils literal notranslate"><span class="pre">PACF</span></code> los cuales pueden obtenerse utilizando la función <code class="docutils literal notranslate"><span class="pre">plotds</span></code> definida anteriormente</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotds</span><span class="p">(</span><span class="n">ibm_df</span><span class="o">.</span><span class="n">Close_Price</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1692e6d39ed8939e4cc3d5b1f0328c15d29f3677863e259851b7f26aff62ff22.png" src="_images/1692e6d39ed8939e4cc3d5b1f0328c15d29f3677863e259851b7f26aff62ff22.png" />
</div>
</div>
<ul class="simple">
<li><p>La <em><strong>ACF decae linealmente, mostrando una fuerte correlación en serie</strong></em>; sin embargo, la <em><strong>autocorrelación parcial sólo muestra una autocorrelación positiva significativa</strong></em>, la corrección debe hacerse utilizando el componente <span class="math notranslate nohighlight">\(AR\)</span> con correlación de primer orden. El gráfico <code class="docutils literal notranslate"><span class="pre">QQ</span></code> de la señal ayuda a evaluar el supuesto de normalidad. El <code class="docutils literal notranslate"><span class="pre">QQ-plot</span></code> para el conjunto de datos de acciones de IBM se muestra en la siguiente figura</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6374abf92766a0750b638db558dadd59ea0fa79b3fecb4624413f436a2a9e700.png" src="_images/6374abf92766a0750b638db558dadd59ea0fa79b3fecb4624413f436a2a9e700.png" />
</div>
</div>
<ul class="simple">
<li><p>La figura anterior muestra que el conjunto de datos se aproxima a las curvas de campana, con <em><strong>casos extremos que no siguen una distribución normal</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>Para <em><strong>obtener los órdenes</strong></em> <span class="math notranslate nohighlight">\(p\)</span> <em><strong>y</strong></em> <span class="math notranslate nohighlight">\(q\)</span> <em><strong>óptimos para</strong></em> <span class="math notranslate nohighlight">\(ARMA\)</span>, se realiza una <em><strong>búsqueda en red (GridSearch)</strong></em> con la minimización del <span class="math notranslate nohighlight">\(AIC\)</span> como criterio de búsqueda utilizando el siguiente script</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aicVal</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">ari</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">maj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">arma_obj</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">ibm_df</span><span class="o">.</span><span class="n">Close_Price</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">ari</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maj</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">aicVal</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ari</span><span class="p">,</span> <span class="n">maj</span><span class="p">,</span> <span class="n">arma_obj</span><span class="o">.</span><span class="n">aic</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfAIC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">aicVal</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AR(p)&#39;</span><span class="p">,</span> <span class="s1">&#39;MA(q)&#39;</span><span class="p">,</span> <span class="s1">&#39;AIC&#39;</span><span class="p">])</span>
<span class="n">dfAIC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AR(p)</th>
      <th>MA(q)</th>
      <th>AIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>6697.784241</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>6699.670009</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2</td>
      <td>6701.984008</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0</td>
      <td>6699.671126</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>1</td>
      <td>6700.721974</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>2</td>
      <td>6702.721949</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Para obtener la fila con el <em><strong>menor valor de AIC usamos</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfAIC</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;AIC&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AR(p)</th>
      <th>MA(q)</th>
      <th>AIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>6697.784241</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>La función <code class="docutils literal notranslate"><span class="pre">ARIMA.fit</span></code> se utiliza para ajustar el modelo de previsión <span class="math notranslate nohighlight">\(ARMA\)</span> con <span class="math notranslate nohighlight">\(p\)</span> y <span class="math notranslate nohighlight">\(q\)</span> definidos <em><strong>utilizando el criterio de máxima verosimilitud</strong></em>. El <span class="math notranslate nohighlight">\(AIC\)</span> recomienda el modelo <span class="math notranslate nohighlight">\(ARMA(1, 0)\)</span> como <em><strong>modelo óptimo con el mínimo valor de</strong></em> <span class="math notranslate nohighlight">\(AIC\)</span>, aunque también puede utilizarse el modelo <span class="math notranslate nohighlight">\(ARMA(1, 1)\)</span> dado que el <span class="math notranslate nohighlight">\(AIC\)</span> es bastante similar. El modelo <span class="math notranslate nohighlight">\(ARMA(1, 0)\)</span> se reajusta como modelo óptimo utilizando el siguiente script</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arma_obj_fin</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">ibm_df</span><span class="o">.</span><span class="n">Close_Price</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;ARMA&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">arma_obj_fin</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;ARMA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">)</span>
<span class="n">axarr</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ARMA(1,0)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Closing price&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c0b660af9dfb6eaad7fa8d3cfce4f8f7c9a35a2dd964b4fa3457f7cb74042bee.png" src="_images/c0b660af9dfb6eaad7fa8d3cfce4f8f7c9a35a2dd964b4fa3457f7cb74042bee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;ARMA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">)</span>
<span class="n">axarr</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ARMA(1,1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Closing price&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/43840ca001972c59a0f18d3e30ee77d84e8cff86b58f215237555899e8a69522.png" src="_images/43840ca001972c59a0f18d3e30ee77d84e8cff86b58f215237555899e8a69522.png" />
</div>
</div>
<ul class="simple">
<li><p>Una de las principales limitaciones de estos modelos es que <em><strong>ignoran el factor de volatilidad, lo que hace que la señal no sea estacionaria</strong></em>. El modelo <span class="math notranslate nohighlight">\(AR\)</span> considera un proceso estacionario, es decir, el término de error es <code class="docutils literal notranslate"><span class="pre">iid</span></code> y sigue una distribución normal <span class="math notranslate nohighlight">\(\varepsilon_{t} \sim N(0, \sigma_{\epsilon}^{2})\)</span> y <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span>. <em><strong>La condición</strong></em> <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span> <em><strong>hace que la serie temporal sea una serie temporal finita ya que el efecto de las observaciones más recientes en la serie temporal sería mayor en comparación con las observaciones anteriores</strong></em>. Las series que no satisfacen estos supuestos caen en series no estacionarias.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">]</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ar1_data</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> 
<span class="n">plotds</span><span class="p">(</span><span class="n">ar1_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b211ba44af9553dd090b00d3ca4d5593aa98410aa483bcb387f21d6e771866ab.png" src="_images/b211ba44af9553dd090b00d3ca4d5593aa98410aa483bcb387f21d6e771866ab.png" />
</div>
</div>
<ul class="simple">
<li><p>Del gráfico anterior se desprende que <em><strong>la varianza del proceso sigue aumentando al final del conjunto de datos y se observa una fuerte tendencia en la ACF</strong></em>. El modelo <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> que se analiza en la sección siguiente tiene en cuenta escenarios no estacionarios para la predicción.</p></li>
</ul>
</section>
<section id="arima">
<h2>ARIMA<a class="headerlink" href="#arima" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(ARIMA\)</span>, también conocido como <em><strong>modelo Box-Jenkins</strong></em>, es una generalización del modelo <span class="math notranslate nohighlight">\(ARMA\)</span> <em><strong>incluyendo componentes integrados</strong></em>. Los componentes integrados son útiles cuando los datos son <em><strong>no estacionarios</strong></em>, y la parte integrada del <span class="math notranslate nohighlight">\(ARIMA\)</span> ayuda a <em><strong>reducir la no estacionariedad</strong></em>. <span class="math notranslate nohighlight">\(ARIMA\)</span> <em><strong>aplica la diferenciación a las series temporales una o más veces para eliminar el efecto de no estacionariedad</strong></em>. Los ordenes <span class="math notranslate nohighlight">\(p, d, q\)</span> del modelo <span class="math notranslate nohighlight">\(ARIMA(p, d, q)\)</span> representan el orden de los componentes <span class="math notranslate nohighlight">\(AR\)</span>, de <em><strong>diferenciación</strong></em> y <span class="math notranslate nohighlight">\(MA\)</span>.</p></li>
<li><p>La principal diferencia entre los modelos <span class="math notranslate nohighlight">\(ARMA\)</span> y <span class="math notranslate nohighlight">\(ARIMA\)</span> es el componente <span class="math notranslate nohighlight">\(d\)</span>, que actualiza la serie sobre la que se construye el modelo de predicción. El componente <span class="math notranslate nohighlight">\(d\)</span> <em><strong>tiene por objeto hacer la serie estacionaria</strong></em> y de esta forma el modelo <span class="math notranslate nohighlight">\(ARMA\)</span> puede aplicarse al conjunto de datos sin tendencia.</p></li>
</ul>
<ul class="simple">
<li><p>Ilustremos un modelo <span class="math notranslate nohighlight">\(ARIMA\)</span> utilizando el conjunto de datos de series temporales del índice <code class="docutils literal notranslate"><span class="pre">Dow</span> <span class="pre">Jones</span> <span class="pre">(DJIA)</span></code> de 2016. El conjunto de datos <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> con sus gráficos <code class="docutils literal notranslate"><span class="pre">ACF</span></code> y <code class="docutils literal notranslate"><span class="pre">PACF</span></code> básicos se muestra en la siguiente figura</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span> 
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima_model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.tsa.api</span> <span class="k">as</span> <span class="nn">smtsa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;datasets/DJIA_Jan2016_Dec2016.xlsx&#39;</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-01-04</td>
      <td>17405.480469</td>
      <td>17405.480469</td>
      <td>16957.630859</td>
      <td>17148.939453</td>
      <td>17148.939453</td>
      <td>148060000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-01-05</td>
      <td>17147.500000</td>
      <td>17195.839844</td>
      <td>17038.609375</td>
      <td>17158.660156</td>
      <td>17158.660156</td>
      <td>105750000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-01-06</td>
      <td>17154.830078</td>
      <td>17154.830078</td>
      <td>16817.619141</td>
      <td>16906.509766</td>
      <td>16906.509766</td>
      <td>120250000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-01-07</td>
      <td>16888.359375</td>
      <td>16888.359375</td>
      <td>16463.630859</td>
      <td>16514.099609</td>
      <td>16514.099609</td>
      <td>176240000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-01-08</td>
      <td>16519.169922</td>
      <td>16651.890625</td>
      <td>16314.570313</td>
      <td>16346.450195</td>
      <td>16346.450195</td>
      <td>141850000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Analicemos la columna <em>Date</em> y utilicémosla como índice de fila para el <em>DataFrame</em> y utilicemosla como columna</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-04</th>
      <td>17405.480469</td>
      <td>17405.480469</td>
      <td>16957.630859</td>
      <td>17148.939453</td>
      <td>17148.939453</td>
      <td>148060000</td>
    </tr>
    <tr>
      <th>2016-01-05</th>
      <td>17147.500000</td>
      <td>17195.839844</td>
      <td>17038.609375</td>
      <td>17158.660156</td>
      <td>17158.660156</td>
      <td>105750000</td>
    </tr>
    <tr>
      <th>2016-01-06</th>
      <td>17154.830078</td>
      <td>17154.830078</td>
      <td>16817.619141</td>
      <td>16906.509766</td>
      <td>16906.509766</td>
      <td>120250000</td>
    </tr>
    <tr>
      <th>2016-01-07</th>
      <td>16888.359375</td>
      <td>16888.359375</td>
      <td>16463.630859</td>
      <td>16514.099609</td>
      <td>16514.099609</td>
      <td>176240000</td>
    </tr>
    <tr>
      <th>2016-01-08</th>
      <td>16519.169922</td>
      <td>16651.890625</td>
      <td>16314.570313</td>
      <td>16346.450195</td>
      <td>16346.450195</td>
      <td>141850000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span><span class="o">=</span><span class="n">djia_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">plotds</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">nlag</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7b3ccbf88291db7d5b9dafbe380dfc280096ec6fdaf4b30f37e9b856ec161dd7.png" src="_images/7b3ccbf88291db7d5b9dafbe380dfc280096ec6fdaf4b30f37e9b856ec161dd7.png" />
</div>
</div>
<ul class="simple">
<li><p>El conjunto de datos muestra claramente una señal no estacionaria con una tendencia creciente. El <code class="docutils literal notranslate"><span class="pre">ACF</span></code> también muestra un decaimiento exponencial, mientras que la <code class="docutils literal notranslate"><span class="pre">PACF</span></code> tiene una fuerte correlación en el retardo 2. <em><strong>La no estacionariedad también puede comprobarse evaluando la media y la varianza en distintos periodos de tiempo. La diferencia en la media y la varianza valida la hipótesis de no estacionariedad</strong></em>. Por ejemplo, dividimos el conjunto de datos del <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> en dos semestres, de enero a junio de 2016 y de julio a diciembre de 2016, y evaluamos la media y la varianza para cada semestre del siguiente modo:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean1</span><span class="p">,</span> <span class="n">mean2</span> <span class="o">=</span><span class="n">djia_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">125</span><span class="p">]</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">djia_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">125</span><span class="p">:]</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">var1</span><span class="p">,</span> <span class="n">var2</span> <span class="o">=</span> <span class="n">djia_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">125</span><span class="p">]</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">var</span><span class="p">(),</span> <span class="n">djia_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">125</span><span class="p">:]</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean1=</span><span class="si">%f</span><span class="s1">, mean2=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">mean2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;variance1=</span><span class="si">%f</span><span class="s1">, variance2=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean1=17226.579164, mean2=18616.603593
variance1=487045.734003, variance2=325183.639530
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><em><strong>La media y la varianza evaluadas para ambos semestres muestran una diferencia significativa en los valores de la media y la varianza, lo que sugiere que los datos no son estacionarios</strong></em>. Otra forma de evaluar la no estacionariedad es utilizar pruebas estadísticas como la prueba de <code class="docutils literal notranslate"><span class="pre">Dickey-Fuller</span> <span class="pre">(ADF)</span></code>. El <span class="math notranslate nohighlight">\(ADF\)</span> es una prueba de raíz unitaria que <em><strong>evalúa la fuerza de la tendencia en una componente de la serie temporal</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>En otras palabras, <em><strong>la hipótesis nula es la presencia de la raíz unitaria o no estacionariedad mientras que la hipótesis alternativa sugiere la estacionariedad de los datos</strong></em>. Realicemos la prueba <code class="docutils literal notranslate"><span class="pre">ADF</span></code> para el conjunto de datos <code class="docutils literal notranslate"><span class="pre">DJIA</span></code>:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span><span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">djia_df</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -0.462320
p-value: 0.899162
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Idealmente, <em><strong>un valor más negativo del estadístico ADF representará una señal estacionaria</strong></em>. Para el conjunto de datos, como el valor <span class="math notranslate nohighlight">\(p\)</span> <em><strong>es bastante alto, no podemos rechazar la hipótesis nula</strong></em>, lo que la convierte en una señal no estacionaria. La mayoría de los paquetes garantizan la estacionariedad antes de ejecutar los modelos. En la figura siguiente se muestra el gráfico <code class="docutils literal notranslate"><span class="pre">qqplot</span></code> para visualizar la normalidad del conjunto de datos <em>DJIA</em>. La normalidad también puede evaluarse mediante la prueba de <code class="docutils literal notranslate"><span class="pre">Shapiro-wilk</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2e6eddcfd605f934a3b9af9cb35419151e4e3f797dd66fe3c16538b359de5189.png" src="_images/2e6eddcfd605f934a3b9af9cb35419151e4e3f797dd66fe3c16538b359de5189.png" />
</div>
</div>
<ul class="simple">
<li><p>La figura anterior muestra <em><strong>no normalidad significativa en el conjunto de datos</strong></em> del <code class="docutils literal notranslate"><span class="pre">DJIA</span></code>. La mayoría de los paquetes escritos en <code class="docutils literal notranslate"><span class="pre">Python</span></code> comprueban la estacionariedad de un conjunto de datos. <em><strong>La diferenciación ayudará a que la señal sea estacionaria</strong></em>. Tracemos las series temporales originales y las de primera diferencia</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_order_diff</span> <span class="o">=</span> <span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Close values of DJIA during Jan 2016-Dec 2016&#39;</span><span class="p">)</span>
<span class="n">first_order_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;First-order differences of DJIA during Jan 2016-Dec 2016&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c257a4701d7a5b91b012c1d966ba24d070ec225153d3b73eb39e8ab8fcc8a571.png" src="_images/c257a4701d7a5b91b012c1d966ba24d070ec225153d3b73eb39e8ab8fcc8a571.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotds</span><span class="p">(</span><span class="n">first_order_diff</span><span class="p">,</span> <span class="n">nlag</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">adf_result</span><span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">first_order_diff</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -17.135094
p-value: 0.000000
</pre></div>
</div>
<img alt="_images/463753c2e26f6bf5ddbc5f9be6f92aff4197870506f1c7384b5126d6741b5730.png" src="_images/463753c2e26f6bf5ddbc5f9be6f92aff4197870506f1c7384b5126d6741b5730.png" />
</div>
</div>
<ul class="simple">
<li><p>El estadístico ADF de los residuos tiene un valor de -17.135094 con un valor <span class="math notranslate nohighlight">\(p=0.000000\)</span>, lo que indica que <em><strong>la serie de tiempo es estacionaria</strong></em>; sin embargo, tanto la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> como el <code class="docutils literal notranslate"><span class="pre">PACF</span></code> <em><strong>no muestran mucha tendencia del componente de media móvil, mostrando un comportamiento de paseo aleatorio</strong></em>. Además, otra forma de ejecutar es <em><strong>optimizar utilizando AIC como criterio</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aicVal</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ari</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">maj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">arima_obj</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">ari</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">maj</span><span class="p">))</span>
                <span class="n">arima_obj_fit</span><span class="o">=</span><span class="n">arima_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
                <span class="n">aicVal</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ari</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">maj</span><span class="p">,</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">aic</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfAIC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">aicVal</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AR(p)&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;MA(q)&#39;</span><span class="p">,</span> <span class="s1">&#39;AIC&#39;</span><span class="p">])</span>
<span class="n">dfAIC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AR(p)</th>
      <th>d</th>
      <th>MA(q)</th>
      <th>AIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3182.101860</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3182.670296</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3184.581580</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3182.624230</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3184.571180</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3186.467647</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>3184.573347</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3186.447498</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3188.433188</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3362.452244</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>3181.460160</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>3182.546756</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>3280.491626</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3182.515221</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3184.482360</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>3252.415990</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>3184.488464</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>3186.338421</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best ARIMA parameters based on AIC:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">dfAIC</span><span class="p">[</span><span class="n">dfAIC</span><span class="o">.</span><span class="n">AIC</span> <span class="o">==</span> <span class="n">dfAIC</span><span class="o">.</span><span class="n">AIC</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best ARIMA parameters based on AIC:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AR(p)</th>
      <th>d</th>
      <th>MA(q)</th>
      <th>AIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>3181.46016</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Elejimos <span class="math notranslate nohighlight">\(ARIMA(0, 2, 1)\)</span> para el ajuste y la evaluación del modelo, por contar con el menor <span class="math notranslate nohighlight">\(AIC\)</span>. <span class="math notranslate nohighlight">\(ARIMA(0, 2, 1)\)</span> aplica una <em><strong>diferenciación de segundo orden y un componente de media móvil de primer orden</strong></em> para determinar la relación entre las observaciones. El parámetro del modelo se configura como se muestra en el siguiente script</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arima_obj</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">arima_obj_fit</span> <span class="o">=</span> <span class="n">arima_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>252</td>   
</tr>
<tr>
  <th>Model:</th>            <td>ARIMA(0, 2, 1)</td>  <th>  Log Likelihood     </th> <td>-1588.730</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 10 May 2024</td> <th>  AIC                </th> <td>3181.460</td> 
</tr>
<tr>
  <th>Time:</th>                <td>21:18:39</td>     <th>  BIC                </th> <td>3188.503</td> 
</tr>
<tr>
  <th>Sample:</th>                  <td>0</td>        <th>  HQIC               </th> <td>3184.295</td> 
</tr>
<tr>
  <th></th>                      <td> - 252</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>ma.L1</th>  <td>   -0.9983</td> <td>    0.153</td> <td>   -6.535</td> <td> 0.000</td> <td>   -1.298</td> <td>   -0.699</td>
</tr>
<tr>
  <th>sigma2</th> <td> 1.828e+04</td> <td> 2884.024</td> <td>    6.340</td> <td> 0.000</td> <td> 1.26e+04</td> <td> 2.39e+04</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>1.60</td> <th>  Jarque-Bera (JB):  </th> <td>47.47</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.21</td> <th>  Prob(JB):          </th> <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.46</td> <th>  Skew:              </th> <td>-0.22</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.00</td> <th>  Kurtosis:          </th> <td>5.09</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_first</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">djia_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;ARIMA&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pred</span><span class="p">[</span><span class="n">n_first</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diffval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;diffval&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">diffval</span><span class="p">[</span><span class="n">n_first</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La comparación con los valores reales y previstos se obtiene y visualiza utilizando el siguiente script</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">)</span>
<span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;ARIMA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">)</span>
<span class="n">axarr</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ARIMA(0,2,1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Closing price&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7520fdc387b2473e309e22f09deda67aad53ed5cde56473273dded2989b45f77.png" src="_images/7520fdc387b2473e309e22f09deda67aad53ed5cde56473273dded2989b45f77.png" />
</div>
</div>
<ul>
<li><p>La ampliación del modelo <span class="math notranslate nohighlight">\(ARIMA\)</span> incluye el <em><strong>componente de estacionalidad para</strong></em> <span class="math notranslate nohighlight">\(AR\)</span>, <span class="math notranslate nohighlight">\(I\)</span>, y <span class="math notranslate nohighlight">\(MA\)</span> <em><strong>representado en mayúsculas</strong></em>. El <span class="math notranslate nohighlight">\(ARIMA\)</span> estacional se representa como</p>
<div class="math notranslate nohighlight">
\[
    ARIMA(p, d, q) (P, D, Q)_{m},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(P, D\)</span> y <span class="math notranslate nohighlight">\(Q\)</span> <em><strong>representan la parte estacional de la media autorregresiva, integrada y media móvil, respectivamente</strong></em>.</p>
</li>
<li><p>La <span class="math notranslate nohighlight">\(m\)</span> en el modelo <span class="math notranslate nohighlight">\(ARIMA\)</span> estacional representa el <em><strong>número de periodos por estación</strong></em>. En los casos en los que existe estacionalidad, <em><strong>pueden ser necesarios los pasos adicionales de diferencia estacional y ajuste estacional para garantizar que la señal sea estacionaria</strong></em>. Por ejemplo, si se observan los gráficos de diferencia <code class="docutils literal notranslate"><span class="pre">ACF</span> <span class="pre">y</span> <span class="pre">PACF</span> <span class="pre">del</span> <span class="pre">DJIA</span></code>, la autocorrelación se vuelve ligeramente significativa en el índice 42, <em><strong>lo que significa que puede haber estacionalidad</strong></em>. <em><strong>Un gráfico de la función de autocorrelación retardada debería mostrar una autocorrelación positiva relativamente grande en el retardo 42, con picos más pequeños en los retardos 84 y 126 (si se examina un mayor número de retardo).</strong></em>. La estacionalidad está presente en la primera diferencia y puede verse utilizando las siguientes líneas de código</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1bd0e9629c104a478b08460914fb2a053a6bb11faf629002d39b06f669025901.png" src="_images/1bd0e9629c104a478b08460914fb2a053a6bb11faf629002d39b06f669025901.png" />
</div>
</div>
<ul class="simple">
<li><p>La estacionalidad precedente puede corregirse utilizando <span class="math notranslate nohighlight">\(ARIMA\)</span> estacional soportado en el modelo <code class="docutils literal notranslate"><span class="pre">statmodels.SARIMAX</span></code>. El script para configurar un modelo <span class="math notranslate nohighlight">\(ARIMA\)</span> estacional para el conjunto de datos <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> es el siguiente:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">statespace</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">))</span>
<span class="n">sarimax</span><span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">sarimax</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>                <td>Close</td>             <th>  No. Observations:  </th>    <td>252</td>   
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(0, 2, 1)x(1, 1, 1, 42)</td> <th>  Log Likelihood     </th> <td>-1366.570</td>
</tr>
<tr>
  <th>Date:</th>                   <td>Fri, 10 May 2024</td>        <th>  AIC                </th> <td>2741.141</td> 
</tr>
<tr>
  <th>Time:</th>                       <td>21:18:42</td>            <th>  BIC                </th> <td>2754.491</td> 
</tr>
<tr>
  <th>Sample:</th>                         <td>0</td>               <th>  HQIC               </th> <td>2746.539</td> 
</tr>
<tr>
  <th></th>                             <td> - 252</td>             <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>               <td>opg</td>              <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>        <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>ma.L1</th>    <td>   -1.0000</td> <td>   16.162</td> <td>   -0.062</td> <td> 0.951</td> <td>  -32.678</td> <td>   30.678</td>
</tr>
<tr>
  <th>ar.S.L42</th> <td>   -0.2542</td> <td>    0.093</td> <td>   -2.727</td> <td> 0.006</td> <td>   -0.437</td> <td>   -0.072</td>
</tr>
<tr>
  <th>ma.S.L42</th> <td>   -0.4671</td> <td>    0.130</td> <td>   -3.597</td> <td> 0.000</td> <td>   -0.722</td> <td>   -0.213</td>
</tr>
<tr>
  <th>sigma2</th>   <td> 2.355e+04</td> <td>  3.8e+05</td> <td>    0.062</td> <td> 0.951</td> <td>-7.22e+05</td> <td> 7.69e+05</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>0.07</td> <th>  Jarque-Bera (JB):  </th> <td>21.28</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.79</td> <th>  Prob(JB):          </th> <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.41</td> <th>  Skew:              </th> <td>-0.24</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.00</td> <th>  Kurtosis:          </th> <td>4.49</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<ul class="simple">
<li><p>El modelo muestra una <em><strong>mejora significativa en términos de AIC</strong></em> y puede optimizarse aún más para diferentes componentes del modelo <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code></p></li>
</ul>
</section>
<section id="intervalo-de-confianza">
<h2>Intervalo de confianza<a class="headerlink" href="#intervalo-de-confianza" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Una de las preguntas más frecuentes en previsión es: <em><strong>¿Cuál es el intervalo de confianza de las estimaciones?</strong></em> El nivel de confianza de un modelo de previsión viene definido por el parámetro <span class="math notranslate nohighlight">\(\alpha\)</span> de la función de previsión. El valor <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span> representa una estimación con un 95% de confianza, lo que puede interpretarse como que las estimaciones devueltas por el modelo tienen una probabilidad del 5% de no caer en el intervalo de distribución definido. <em><strong>El intervalo de confianza se evalúa del siguiente modo</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\hat{x}_{t}\pm Z_{\alpha}\frac{\sigma}{\sqrt{N}}
\]</div>
<ul class="simple">
<li><p>Aquí, <span class="math notranslate nohighlight">\(Z_{\alpha}\)</span> es el valor crítico definido en función de <span class="math notranslate nohighlight">\(\alpha\)</span>. Para el valor <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>, el valor crítico es <span class="math notranslate nohighlight">\(1.96\)</span>. El intervalo de confianza con un valor <span class="math notranslate nohighlight">\(\alpha\)</span> de <span class="math notranslate nohighlight">\(0.05\)</span> para el conjunto de datos <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> modelado utilizando el modelo <span class="math notranslate nohighlight">\(ARIMA(0,2,1)\)</span> puede obtenerse utilizando la función de previsión del objeto <code class="docutils literal notranslate"><span class="pre">arima_obj_fit</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecast</span> <span class="o">=</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="n">yhat</span> <span class="o">=</span> <span class="n">forecast</span><span class="o">.</span><span class="n">predicted_mean</span>
<span class="n">yhat_conf_int</span> <span class="o">=</span> <span class="n">forecast</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yhat_conf_int</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Forecasting Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Forecasted value&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3e6451f9015b088f5b42c71afd5cbd39dfedab7cacdc22e044c278e2e764833f.png" src="_images/3e6451f9015b088f5b42c71afd5cbd39dfedab7cacdc22e044c278e2e764833f.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Resumen</p>
<ul class="simple">
<li><p>En este capítulo, cubrimos los modelos autorregresivos como un modelo <span class="math notranslate nohighlight">\(MA\)</span> para capturar la correlación serial utilizando la relación de error. En líneas similares, se cubrieron los modelos <span class="math notranslate nohighlight">\(AR\)</span>, que establecen la previsión utilizando los rezagos como observaciones dependientes. Los modelos <span class="math notranslate nohighlight">\(AR\)</span> son buenos para captar información sobre tendencias. También se ilustró el enfoque basado en <span class="math notranslate nohighlight">\(ARMA\)</span>, que integra los modelos <span class="math notranslate nohighlight">\(AR\)</span> y <span class="math notranslate nohighlight">\(MA\)</span> para captar las tendencias temporales y los acontecimientos inesperados que provocan muchos errores que tardan en corregirse, como una crisis económica.</p></li>
<li><p>Todos estos modelos suponen estacionariedad; en los casos en los que no se da estacionariedad, se utiliza un modelo basado en la diferenciación, como el <span class="math notranslate nohighlight">\(ARIMA\)</span>, que diferencia los conjuntos de datos de series temporales para eliminar cualquier tendencia. Los métodos de previsión se ilustraron con ejemplos utilizando el módulo <code class="docutils literal notranslate"><span class="pre">tsa</span></code> de <code class="docutils literal notranslate"><span class="pre">Python</span></code>. El presente capítulo se centra en el uso de <code class="docutils literal notranslate"><span class="pre">métodos</span> <span class="pre">estadísticos</span></code> para la previsión. En el capítulo siguiente se ampliará el enfoque estadístico a los métodos de <code class="docutils literal notranslate"><span class="pre">aprendizaje</span> <span class="pre">automático</span></code> para la previsión, concretamente <code class="docutils literal notranslate"><span class="pre">modelos</span> <span class="pre">de</span> <span class="pre">aprendizaje</span> <span class="pre">profundo</span></code>.</p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "ml_tf"
        },
        kernelOptions: {
            name: "ml_tf",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ml_tf'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="exponential_smoothing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Métodos de Suavización Exponencial</p>
      </div>
    </a>
    <a class="right-next"
       href="biblio.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bibliografía</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis">Análisis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-lineales-para-series-de-tiempo-estacionarias">Modelos lineales para series de tiempo estacionarias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionariedad">Estacionariedad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-de-media-movil-finito-ma-q">Proceso de media movil finito <span class="math notranslate nohighlight">\(MA(q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-proceso-de-media-movil-de-primer-orden-ma-1">El Proceso de Media Móvil de Primer Orden, <span class="math notranslate nohighlight">\(MA(1)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-proceso-de-media-movil-de-segundo-orden-ma-2">El Proceso de Media Móvil de Segundo Orden, <span class="math notranslate nohighlight">\(MA(2)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-autorregresivos-de-orden-finito">Procesos autorregresivos de orden finito</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-autorregresivo-de-primer-orden-ar-1">Proceso autorregresivo de primer orden, <span class="math notranslate nohighlight">\(AR(1)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-autorregresivo-de-segundo-orden-ar-2">Proceso autorregresivo de segundo orden, <span class="math notranslate nohighlight">\(AR(2)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-autorregresivo-general-ar-p">Proceso autorregresivo general, <span class="math notranslate nohighlight">\(AR(p)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-de-autocorrelacion-parcial-pacf">Función de Autocorrelación Parcial, <span class="math notranslate nohighlight">\(PACF\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-mixtos-autorregresivos-media-movil">Procesos Mixtos Autorregresivos-Media Movil</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionariedad-del-proceso-arma-p-q">Estacionariedad del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invertibilidad-del-proceso-arma-p-q">Invertibilidad del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-de-autocorrelacion-acf-y-autocorrelacion-parcial-pacf-del-proceso-arma-p-q">Funciones de autocorrelación (<span class="math notranslate nohighlight">\(ACF\)</span>) y autocorrelación parcial (<span class="math notranslate nohighlight">\(PACF\)</span>) del proceso <span class="math notranslate nohighlight">\(ARMA(p, q)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-no-estacionarios">Procesos No Estacionarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-de-modelos-de-series-temporales">Construcción de Modelos de Series Temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identificacion-de-modelos">Identificación de modelos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-de-parametros">Estimación de parámetros</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostico-checking">Diagnostico Checking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-con-proceso-arima">Pronóstico con proceso ARIMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion">Implementación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-media-movil">Modelos de media móvil</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creacion-de-conjuntos-de-datos-con-arima">Creación de conjuntos de datos con ARIMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arima">ARIMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intervalo-de-confianza">Intervalo de confianza</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lihki Rubio PhD in Mathematical Engineering
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Lihki Rubio PhD.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>